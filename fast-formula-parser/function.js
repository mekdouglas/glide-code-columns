var n0=Object.create;var Xr=Object.defineProperty,i0=Object.defineProperties,o0=Object.getOwnPropertyDescriptor,a0=Object.getOwnPropertyDescriptors,s0=Object.getOwnPropertyNames,_o=Object.getOwnPropertySymbols,u0=Object.getPrototypeOf,Io=Object.prototype.hasOwnProperty,c0=Object.prototype.propertyIsEnumerable;var Mo=(t,e,r)=>e in t?Xr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,oi=(t,e)=>{for(var r in e||(e={}))Io.call(e,r)&&Mo(t,r,e[r]);if(_o)for(var r of _o(e))c0.call(e,r)&&Mo(t,r,e[r]);return t},Co=(t,e)=>i0(t,a0(e)),l0=t=>Xr(t,"__esModule",{value:!0});var w=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var f0=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of s0(e))!Io.call(t,n)&&n!=="default"&&Xr(t,n,{get:()=>e[n],enumerable:!(r=o0(e,n))||r.enumerable});return t},wo=t=>f0(l0(Xr(t!=null?n0(u0(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var Uo=w((mm,Po)=>{function h0(t,e,r,n){var i=-1,s=t==null?0:t.length;for(n&&s&&(r=t[++i]);++i<s;)r=e(r,t[i],i,t);return r}Po.exports=h0});var xo=w((Rm,Lo)=>{function p0(t){return function(e){return t==null?void 0:t[e]}}Lo.exports=p0});var So=w((Tm,ko)=>{var d0=xo(),v0={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},g0=d0(v0);ko.exports=g0});var Fo=w((Am,bo)=>{var E0=typeof global=="object"&&global&&global.Object===Object&&global;bo.exports=E0});var Do=w((Nm,Bo)=>{var m0=Fo(),R0=typeof self=="object"&&self&&self.Object===Object&&self,T0=m0||R0||Function("return this")();Bo.exports=T0});var Qr=w((ym,qo)=>{var A0=Do(),N0=A0.Symbol;qo.exports=N0});var Vo=w((Om,Go)=>{function y0(t,e){for(var r=-1,n=t==null?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}Go.exports=y0});var Ho=w((_m,Wo)=>{var O0=Array.isArray;Wo.exports=O0});var $o=w((Im,Ko)=>{var Yo=Qr(),zo=Object.prototype,_0=zo.hasOwnProperty,I0=zo.toString,_r=Yo?Yo.toStringTag:void 0;function M0(t){var e=_0.call(t,_r),r=t[_r];try{t[_r]=void 0;var n=!0}catch(s){}var i=I0.call(t);return n&&(e?t[_r]=r:delete t[_r]),i}Ko.exports=M0});var Qo=w((Mm,Xo)=>{var C0=Object.prototype,w0=C0.toString;function P0(t){return w0.call(t)}Xo.exports=P0});var ea=w((Cm,jo)=>{var Zo=Qr(),U0=$o(),L0=Qo(),x0="[object Null]",k0="[object Undefined]",Jo=Zo?Zo.toStringTag:void 0;function S0(t){return t==null?t===void 0?k0:x0:Jo&&Jo in Object(t)?U0(t):L0(t)}jo.exports=S0});var ra=w((wm,ta)=>{function b0(t){return t!=null&&typeof t=="object"}ta.exports=b0});var ia=w((Pm,na)=>{var F0=ea(),B0=ra(),D0="[object Symbol]";function q0(t){return typeof t=="symbol"||B0(t)&&F0(t)==D0}na.exports=q0});var la=w((Um,ca)=>{var oa=Qr(),G0=Vo(),V0=Ho(),W0=ia(),H0=1/0,aa=oa?oa.prototype:void 0,sa=aa?aa.toString:void 0;function ua(t){if(typeof t=="string")return t;if(V0(t))return G0(t,ua)+"";if(W0(t))return sa?sa.call(t):"";var e=t+"";return e=="0"&&1/t==-H0?"-0":e}ca.exports=ua});var Zr=w((Lm,fa)=>{var Y0=la();function z0(t){return t==null?"":Y0(t)}fa.exports=z0});var pa=w((xm,ha)=>{var K0=So(),$0=Zr(),X0=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Q0="\\u0300-\\u036f",Z0="\\ufe20-\\ufe2f",J0="\\u20d0-\\u20ff",j0=Q0+Z0+J0,eh="["+j0+"]",th=RegExp(eh,"g");function rh(t){return t=$0(t),t&&t.replace(X0,K0).replace(th,"")}ha.exports=rh});var va=w((km,da)=>{var nh=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function ih(t){return t.match(nh)||[]}da.exports=ih});var Ea=w((Sm,ga)=>{var oh=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function ah(t){return oh.test(t)}ga.exports=ah});var ba=w((bm,Sa)=>{var ma="\\ud800-\\udfff",sh="\\u0300-\\u036f",uh="\\ufe20-\\ufe2f",ch="\\u20d0-\\u20ff",lh=sh+uh+ch,Ra="\\u2700-\\u27bf",Ta="a-z\\xdf-\\xf6\\xf8-\\xff",fh="\\xac\\xb1\\xd7\\xf7",hh="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ph="\\u2000-\\u206f",dh=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Aa="A-Z\\xc0-\\xd6\\xd8-\\xde",vh="\\ufe0e\\ufe0f",Na=fh+hh+ph+dh,ya="['\u2019]",Oa="["+Na+"]",gh="["+lh+"]",_a="\\d+",Eh="["+Ra+"]",Ia="["+Ta+"]",Ma="[^"+ma+Na+_a+Ra+Ta+Aa+"]",mh="\\ud83c[\\udffb-\\udfff]",Rh="(?:"+gh+"|"+mh+")",Th="[^"+ma+"]",Ca="(?:\\ud83c[\\udde6-\\uddff]){2}",wa="[\\ud800-\\udbff][\\udc00-\\udfff]",ir="["+Aa+"]",Ah="\\u200d",Pa="(?:"+Ia+"|"+Ma+")",Nh="(?:"+ir+"|"+Ma+")",Ua="(?:"+ya+"(?:d|ll|m|re|s|t|ve))?",La="(?:"+ya+"(?:D|LL|M|RE|S|T|VE))?",xa=Rh+"?",ka="["+vh+"]?",yh="(?:"+Ah+"(?:"+[Th,Ca,wa].join("|")+")"+ka+xa+")*",Oh="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",_h="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ih=ka+xa+yh,Mh="(?:"+[Eh,Ca,wa].join("|")+")"+Ih,Ch=RegExp([ir+"?"+Ia+"+"+Ua+"(?="+[Oa,ir,"$"].join("|")+")",Nh+"+"+La+"(?="+[Oa,ir+Pa,"$"].join("|")+")",ir+"?"+Pa+"+"+Ua,ir+"+"+La,_h,Oh,_a,Mh].join("|"),"g");function wh(t){return t.match(Ch)||[]}Sa.exports=wh});var Ba=w((Fm,Fa)=>{var Ph=va(),Uh=Ea(),Lh=Zr(),xh=ba();function kh(t,e,r){return t=Lh(t),e=r?void 0:e,e===void 0?Uh(t)?xh(t):Ph(t):t.match(e)||[]}Fa.exports=kh});var qa=w((Bm,Da)=>{var Sh=Uo(),bh=pa(),Fh=Ba(),Bh="['\u2019]",Dh=RegExp(Bh,"g");function qh(t){return function(e){return Sh(Fh(bh(e).replace(Dh,"")),t,"")}}Da.exports=qh});var Va=w((Dm,Ga)=>{function Gh(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=Array(i);++n<i;)s[n]=t[n+e];return s}Ga.exports=Gh});var Ha=w((qm,Wa)=>{var Vh=Va();function Wh(t,e,r){var n=t.length;return r=r===void 0?n:r,!e&&r>=n?t:Vh(t,e,r)}Wa.exports=Wh});var ai=w((Gm,Ya)=>{var Hh="\\ud800-\\udfff",Yh="\\u0300-\\u036f",zh="\\ufe20-\\ufe2f",Kh="\\u20d0-\\u20ff",$h=Yh+zh+Kh,Xh="\\ufe0e\\ufe0f",Qh="\\u200d",Zh=RegExp("["+Qh+Hh+$h+Xh+"]");function Jh(t){return Zh.test(t)}Ya.exports=Jh});var Ka=w((Vm,za)=>{function jh(t){return t.split("")}za.exports=jh});var ts=w((Wm,es)=>{var $a="\\ud800-\\udfff",ep="\\u0300-\\u036f",tp="\\ufe20-\\ufe2f",rp="\\u20d0-\\u20ff",np=ep+tp+rp,ip="\\ufe0e\\ufe0f",op="["+$a+"]",si="["+np+"]",ui="\\ud83c[\\udffb-\\udfff]",ap="(?:"+si+"|"+ui+")",Xa="[^"+$a+"]",Qa="(?:\\ud83c[\\udde6-\\uddff]){2}",Za="[\\ud800-\\udbff][\\udc00-\\udfff]",sp="\\u200d",Ja=ap+"?",ja="["+ip+"]?",up="(?:"+sp+"(?:"+[Xa,Qa,Za].join("|")+")"+ja+Ja+")*",cp=ja+Ja+up,lp="(?:"+[Xa+si+"?",si,Qa,Za,op].join("|")+")",fp=RegExp(ui+"(?="+ui+")|"+lp+cp,"g");function hp(t){return t.match(fp)||[]}es.exports=hp});var ns=w((Hm,rs)=>{var pp=Ka(),dp=ai(),vp=ts();function gp(t){return dp(t)?vp(t):pp(t)}rs.exports=gp});var os=w((Ym,is)=>{var Ep=Ha(),mp=ai(),Rp=ns(),Tp=Zr();function Ap(t){return function(e){e=Tp(e);var r=mp(e)?Rp(e):void 0,n=r?r[0]:e.charAt(0),i=r?Ep(r,1).join(""):e.slice(1);return n[t]()+i}}is.exports=Ap});var ss=w((zm,as)=>{var Np=os(),yp=Np("toUpperCase");as.exports=yp});var cs=w((Km,us)=>{var Op=qa(),_p=ss(),Ip=Op(function(t,e,r){return t+(r?" ":"")+_p(e)});us.exports=Ip});var Ir=w((Jm,ds)=>{var ps=class{constructor(e,r){if(e==null&&r==null)this._data=[],this._refs=[];else{if(e.length!==r.length)throw Error("Collection: data length should match references length.");this._data=e,this._refs=r}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(e,r){this._data.push(e),this._refs.push(r)}};ds.exports=ps});var Ce=w((jm,ms)=>{var Ue=Oe(),ci=Ir(),me={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},Gp=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,121645100408832e3,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8841761993739702e15,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,10333147966386145e24,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,13868311854568984e64,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8247650592082472e75,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,11978571669969892e84,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5797126020747368e105,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,24227095383672734e114,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1352001527678403e125,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],vs={};Object.keys(me).forEach(t=>{vs[me[t]]=t});var gs=class{constructor(){this.Types=me,this.type2Number={number:me.NUMBER,boolean:me.BOOLEAN,string:me.STRING,object:-1}}checkFunctionResult(e){if(typeof e==="number"){if(isNaN(e))return Ue.VALUE;if(!isFinite(e))return Ue.NUM}return e??Ue.NULL}flattenDeep(e){return e.reduce((r,n)=>Array.isArray(n)?r.concat(this.flattenDeep(n)):r.concat(n),[])}acceptNumber(e,r=!0,n=!0){if(e instanceof Ue)return e;let i;if(typeof e=="number")i=e;else if(typeof e=="boolean")if(n)i=Number(e);else throw Ue.VALUE;else if(typeof e=="string"){if(e.length===0||(i=Number(e),i!==i))throw Ue.VALUE}else if(Array.isArray(e))if(r)i=this.acceptNumber(e[0][0]);else if(e[0].length===1)i=this.acceptNumber(e[0][0]);else throw Ue.VALUE;else throw Error("Unknown type in FormulaHelpers.acceptNumber");return i}flattenParams(e,r,n,i,s=null,l=1){if(e.length<l)throw Ue.ARG_MISSING([r]);s==null&&(s=r===me.NUMBER?0:r==null?null:""),e.forEach(u=>{let{isCellRef:o,isRangeRef:a,isArray:c}=u,f=u.value instanceof ci,p=!o&&!a&&!c&&!f,d={isLiteral:p,isCellRef:o,isRangeRef:a,isArray:c,isUnion:f};if(p)u.omitted?u=s:u=this.accept(u,r,s),i(u,d);else if(o)i(u.value,d);else if(f){if(!n)throw Ue.VALUE;u=u.value.data,u=this.flattenDeep(u),u.forEach(h=>{i(h,d)})}else(a||c)&&(u=this.flattenDeep(u.value),u.forEach(h=>{i(h,d)}))})}accept(e,r=null,n,i=!0,s=!1){if(Array.isArray(r)&&(r=r[0]),e==null&&n===void 0)throw Ue.ARG_MISSING([r]);if(e==null)return n;if(typeof e!="object"||Array.isArray(e))return e;let l=e.isArray;if(e.value!=null&&(e=e.value),r==null)return e;if(e instanceof Ue)throw e;if(r===me.ARRAY){if(Array.isArray(e))return i?this.flattenDeep(e):e;if(e instanceof ci)throw Ue.VALUE;if(s)return i?[e]:[[e]];throw Ue.VALUE}else if(r===me.COLLECTIONS)return e;l&&(e=e[0][0]);let u=this.type(e);if(r===me.STRING)u===me.BOOLEAN?e=e?"TRUE":"FALSE":e=`${e}`;else if(r===me.BOOLEAN){if(u===me.STRING)throw Ue.VALUE;u===me.NUMBER&&(e=Boolean(e))}else if(r===me.NUMBER)e=this.acceptNumber(e,!1);else if(r===me.NUMBER_NO_BOOLEAN)e=this.acceptNumber(e,!1,!1);else throw Ue.VALUE;return e}type(e){let r=this.type2Number[typeof e];return r===-1&&(Array.isArray(e)?r=me.ARRAY:e.ref?e.ref.from?r=me.RANGE_REF:r=me.CELL_REF:e instanceof ci&&(r=me.COLLECTIONS)),r}isRangeRef(e){return e.ref&&e.ref.from}isCellRef(e){return e.ref&&!e.ref.from}retrieveRanges(e,r,n){return n=Es.extend(r,n),r=this.retrieveArg(e,r),r=or.accept(r,me.ARRAY,void 0,!1,!0),n!==r?(n=this.retrieveArg(e,n),n=or.accept(n,me.ARRAY,void 0,!1,!0)):n=r,[r,n]}retrieveArg(e,r){if(r===null)return{value:0,isArray:!1,omitted:!0};let n=e.utils.extractRefValue(r);return{value:n.val,isArray:n.isArray,ref:r.ref}}},or=new gs,Mr={isWildCard:t=>typeof t=="string"?/[*?]/.test(t):!1,toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},Vp={parse:t=>{let e=typeof t;if(e==="string"){let r=t.toUpperCase();if(r==="TRUE"||r==="FALSE")return{op:"=",value:r==="TRUE"};let n=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(n){let i=n[1],s;if(isNaN(n[2])){let l=n[2].toUpperCase();if(l==="TRUE"||l==="FALSE")s=l==="TRUE";else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(n[2]))s=new Ue(n[2]);else if(s=n[2],Mr.isWildCard(s))return{op:"wc",value:Mr.toRegex(s),match:i==="="}}else s=Number(n[2]);return{op:i,value:s}}else return Mr.isWildCard(t)?{op:"wc",value:Mr.toRegex(t),match:!0}:{op:"=",value:t}}else{if(e==="boolean"||e==="number"||Array.isArray(t)||t instanceof Ue)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}}},Es={columnNumberToName:t=>{let e=t,r="",n=0;for(;e>0;)n=(e-1)%26,r=String.fromCharCode("A".charCodeAt(0)+n)+r,e=Math.floor((e-n)/26);return r},columnNameToNumber:t=>{t=t.toUpperCase();let e=t.length,r=0;for(let n=0;n<e;n++){let i=t.charCodeAt(n);isNaN(i)||(r+=(i-64)*26**(e-n-1))}return r},extend:(t,e)=>{if(e==null)return t;let r,n;if(or.isCellRef(t))r=0,n=0;else if(or.isRangeRef(t))r=t.ref.to.row-t.ref.from.row,n=t.ref.to.col-t.ref.from.col;else throw Error("Address.extend should not reach here.");return or.isCellRef(e)?(r>0||n>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+r,col:e.ref.col+n}}}):(e.ref.to.row=e.ref.from.row+r,e.ref.to.col=e.ref.from.col+n),e}};ms.exports={FormulaHelpers:or,Types:me,ReversedTypes:vs,Factorials:Gp,WildCard:Mr,Criteria:Vp,Address:Es}});var Oe=w((eR,Rs)=>{var ee=class extends Error{constructor(e,r,n){super(r);if(r==null&&n==null&&ee.errorMap.has(e))return ee.errorMap.get(e);r==null&&n==null?(this._error=e,ee.errorMap.set(e,this)):this._error=e,this.details=n}get error(){return this._error}get name(){return this._error}equals(e){return e instanceof ee&&e._error===this._error}toString(){return this._error}};ee.errorMap=new Map;ee.DIV0=new ee("#DIV/0!");ee.NA=new ee("#N/A");ee.NAME=new ee("#NAME?");ee.NULL=new ee("#NULL!");ee.NUM=new ee("#NUM!");ee.REF=new ee("#REF!");ee.VALUE=new ee("#VALUE!");ee.NOT_IMPLEMENTED=t=>new ee("#NAME?",`Function ${t} is not implemented.`);ee.TOO_MANY_ARGS=t=>new ee("#N/A",`Function ${t} has too many arguments.`);ee.ARG_MISSING=t=>{let{Types:e}=Ce();return new ee("#N/A",`Argument type ${t.map(r=>e[r]).join(", ")} is missing.`)};ee.ERROR=(t,e)=>new ee("#ERROR!",t,e);Rs.exports=ee});var hi=w((tR,bs)=>{var De=class{};De.version="0.10.3";function ar(t){let e="",r=t.length-1;for(;r>=0;)e+=t.charAt(r--);return e}function Ze(t,e){let r="";for(;r.length<e;)r+=t;return r}function ht(t,e){let r=""+t;return r.length>=e?r:Ze("0",e-r.length)+r}function li(t,e){let r=""+t;return r.length>=e?r:Ze(" ",e-r.length)+r}function Jr(t,e){let r=""+t;return r.length>=e?r:r+Ze(" ",e-r.length)}function Wp(t,e){let r=""+Math.round(t);return r.length>=e?r:Ze("0",e-r.length)+r}function Hp(t,e){let r=""+t;return r.length>=e?r:Ze("0",e-r.length)+r}var Ts=Math.pow(2,32);function sr(t,e){if(t>Ts||t<-Ts)return Wp(t,e);let r=Math.round(t);return Hp(r,e)}function jr(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)==103&&(t.charCodeAt(e+1)|32)==101&&(t.charCodeAt(e+2)|32)==110&&(t.charCodeAt(e+3)|32)==101&&(t.charCodeAt(e+4)|32)==114&&(t.charCodeAt(e+5)|32)==97&&(t.charCodeAt(e+6)|32)==108}var As=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],fi=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ns(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t[65535]="General"}var Xt={};Ns(Xt);function en(t,e,r){let n=t<0?-1:1,i=t*n,s=0,l=1,u=0,o=1,a=0,c=0,f=Math.floor(i);for(;a<e&&(f=Math.floor(i),u=f*l+s,c=f*a+o,!(i-f<5e-8));)i=1/(i-f),s=l,l=u,o=a,a=c;if(c>e&&(a>e?(c=o,u=s):(c=a,u=l)),!r)return[0,n*u,c];let p=Math.floor(n*u/c);return[p,n*u-p*c,c]}function Cr(t,e,r){if(t>2958465||t<0)return null;let n=t|0,i=Math.floor(86400*(t-n)),s=0,l=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;let o=new Date(1900,0,1);o.setDate(o.getDate()+n-1),l=[o.getFullYear(),o.getMonth()+1,o.getDate()],s=o.getDay(),n<60&&(s=(s+6)%7),r&&(s=Kp(o,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=s,u}De.parse_date_code=Cr;var ys=new Date(1899,11,31,0,0,0),Yp=ys.getTime(),zp=new Date(1900,2,1,0,0,0);function Os(t,e){let r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=zp&&(r+=24*60*60*1e3),(r-(Yp+(t.getTimezoneOffset()-ys.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function _s(t){return t.toString(10)}De._general_int=_s;var Is=function(){let e=/\.(\d*[1-9])0+$/,r=/\.0*$/,n=/\.(\d*[1-9])0+/,i=/\.0*[Ee]/,s=/(E[+-])(\d)$/;function l(c){let f=c<0?12:11,p=a(c.toFixed(12));return p.length<=f||(p=c.toPrecision(10),p.length<=f)?p:c.toExponential(5)}function u(c){let f=c.toFixed(11).replace(e,".$1");return f.length>(c<0?12:11)&&(f=c.toPrecision(6)),f}function o(c){for(let f=0;f!==c.length;++f)if((c.charCodeAt(f)|32)==101)return c.replace(n,".$1").replace(i,"E").replace("e","E").replace(s,"$10$2");return c}function a(c){return c.indexOf(".")>-1?c.replace(r,"").replace(e,".$1"):c}return function(f){let p=Math.floor(Math.log(Math.abs(f))*Math.LOG10E),d;return p>=-4&&p<=-1?d=f.toPrecision(10+p):Math.abs(p)<=9?d=l(f):p===10?d=f.toFixed(10).substr(0,12):d=u(f),a(o(d))}}();De._general_num=Is;function tn(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?_s(t):Is(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ks(14,Os(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}De._general=tn;function Kp(){return 0}function $p(t,e,r,n){let i="",s=0,l=0,u=r.y,o,a=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:o=u%100,a=2;break;default:o=u%1e4,a=4;break}break;case 109:switch(e.length){case 1:case 2:o=r.m,a=e.length;break;case 3:return fi[r.m-1][1];case 5:return fi[r.m-1][0];default:return fi[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:o=r.d,a=e.length;break;case 3:return As[r.q][0];default:return As[r.q][1]}break;case 104:switch(e.length){case 1:case 2:o=1+(r.H+11)%12,a=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:o=r.H,a=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:o=r.M,a=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!=="s"&&e!=="ss"&&e!==".0"&&e!==".00"&&e!==".000")throw"bad second format: "+e;return r.u===0&&(e==="s"||e==="ss")?ht(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),e==="s"?s===0?"0":""+s/l:(i=ht(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}a=e.length===3?1:2;break;case 101:o=u,a=1}return a>0?ht(o,a):""}function qt(t){let e=3;if(t.length<=e)return t;let r=t.length%e,n=t.substr(0,r);for(;r!==t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var wt=function(){let e=/%/g;function r(N,R,y){let O=R.replace(e,""),_=R.length-O.length;return wt(N,O,y*Math.pow(10,2*_))+Ze("%",_)}function n(N,R,y){let O=R.length-1;for(;R.charCodeAt(O-1)===44;)--O;return wt(N,R.substr(0,O),y/Math.pow(10,3*(R.length-O)))}function i(N,R){let y,O=N.indexOf("E")-N.indexOf(".")-1;if(N.match(/^#+0.0E\+0$/)){if(R===0)return"0.0E+0";if(R<0)return"-"+i(N,-R);let _=N.indexOf(".");_===-1&&(_=N.indexOf("E"));let U=Math.floor(Math.log(R)*Math.LOG10E)%_;if(U<0&&(U+=_),y=(R/Math.pow(10,U)).toPrecision(O+1+(_+U)%_),y.indexOf("e")===-1){let S=Math.floor(Math.log(R)*Math.LOG10E);for(y.indexOf(".")===-1?y=y.charAt(0)+"."+y.substr(1)+"E+"+(S-y.length+U):y+="E+"+(S-U);y.substr(0,2)==="0.";)y=y.charAt(0)+y.substr(2,_)+"."+y.substr(2+_),y=y.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");y=y.replace(/\+-/,"-")}y=y.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(S,B,K,W){return B+K+W.substr(0,(_+U)%_)+"."+W.substr(U)+"E"})}else y=R.toExponential(O);return N.match(/E\+00$/)&&y.match(/e[+-]\d$/)&&(y=y.substr(0,y.length-1)+"0"+y.charAt(y.length-1)),N.match(/E\-/)&&y.match(/e\+/)&&(y=y.replace(/e\+/,"e")),y.replace("e","E")}let s=/# (\?+)( ?)\/( ?)(\d+)/;function l(N,R,y){let O=parseInt(N[4],10),_=Math.round(R*O),U=Math.floor(_/O),S=_-U*O,B=O;return y+(U===0?"":""+U)+" "+(S===0?Ze(" ",N[1].length+1+N[4].length):li(S,N[1].length)+N[2]+"/"+N[3]+ht(B,N[4].length))}function u(N,R,y){return y+(R===0?"":""+R)+Ze(" ",N[1].length+2+N[4].length)}let o=/^#*0*\.([0#]+)/,a=/\).*[0#]/,c=/\(###\) ###\\?-####/;function f(N){let R="",y;for(let O=0;O!==N.length;++O)switch(y=N.charCodeAt(O)){case 35:break;case 63:R+=" ";break;case 48:R+="0";break;default:R+=String.fromCharCode(y)}return R}function p(N,R){let y=Math.pow(10,R);return""+Math.round(N*y)/y}function d(N,R){return R<(""+Math.round((N-Math.floor(N))*Math.pow(10,R))).length?0:Math.round((N-Math.floor(N))*Math.pow(10,R))}function h(N,R){return R<(""+Math.round((N-Math.floor(N))*Math.pow(10,R))).length?1:0}function v(N){return N<2147483647&&N>-2147483648?""+(N>=0?N|0:N-1|0):""+Math.floor(N)}function E(N,R,y){if(N.charCodeAt(0)===40&&!R.match(a)){let F=R.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return y>=0?E("n",F,y):"("+E("n",F,-y)+")"}if(R.charCodeAt(R.length-1)===44)return n(N,R,y);if(R.indexOf("%")!==-1)return r(N,R,y);if(R.indexOf("E")!==-1)return i(R,y);if(R.charCodeAt(0)===36)return"$"+E(N,R.substr(R.charAt(1)==" "?2:1),y);let O,_,U,S,B=Math.abs(y),K=y<0?"-":"";if(R.match(/^00+$/))return K+sr(B,R.length);if(R.match(/^[#?]+$/))return O=sr(y,0),O==="0"&&(O=""),O.length>R.length?O:f(R.substr(0,R.length-O.length))+O;if(_=R.match(s))return l(_,B,K);if(R.match(/^#+0+$/))return K+sr(B,R.length-R.indexOf("0"));if(_=R.match(o))return O=p(y,_[1].length).replace(/^([^\.]+)$/,"$1."+f(_[1])).replace(/\.$/,"."+f(_[1])).replace(/\.(\d*)$/,function(F,fe){return"."+fe+Ze("0",f(_[1]).length-fe.length)}),R.indexOf("0.")!==-1?O:O.replace(/^0\./,".");if(R=R.replace(/^#+([0.])/,"$1"),_=R.match(/^(0*)\.(#*)$/))return K+p(B,_[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,_[1].length?"0.":".");if(_=R.match(/^#{1,3},##0(\.?)$/))return K+qt(sr(B,0));if(_=R.match(/^#,##0\.([#0]*0)$/))return y<0?"-"+E(N,R,-y):qt(""+(Math.floor(y)+h(y,_[1].length)))+"."+ht(d(y,_[1].length),_[1].length);if(_=R.match(/^#,#*,#0/))return E(N,R.replace(/^#,#*,/,""),y);if(_=R.match(/^([0#]+)(\\?-([0#]+))+$/))return O=ar(E(N,R.replace(/[\\-]/g,""),y)),U=0,ar(ar(R.replace(/\\/g,"")).replace(/[0#]/g,function(F){return U<O.length?O.charAt(U++):F==="0"?"0":""}));if(R.match(c))return O=E(N,"##########",y),"("+O.substr(0,3)+") "+O.substr(3,3)+"-"+O.substr(6);let W="";if(_=R.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return U=Math.min(_[4].length,7),S=en(B,Math.pow(10,U)-1,!1),O=""+K,W=wt("n",_[1],S[1]),W.charAt(W.length-1)===" "&&(W=W.substr(0,W.length-1)+"0"),O+=W+_[2]+"/"+_[3],W=Jr(S[2],U),W.length<_[4].length&&(W=f(_[4].substr(_[4].length-W.length))+W),O+=W,O;if(_=R.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return U=Math.min(Math.max(_[1].length,_[4].length),7),S=en(B,Math.pow(10,U)-1,!0),K+(S[0]||(S[1]?"":"0"))+" "+(S[1]?li(S[1],U)+_[2]+"/"+_[3]+Jr(S[2],U):Ze(" ",2*U+1+_[2].length+_[3].length));if(_=R.match(/^[#0?]+$/))return O=sr(y,0),R.length<=O.length?O:f(R.substr(0,R.length-O.length))+O;if(_=R.match(/^([#0?]+)\.([#0]+)$/)){O=""+y.toFixed(Math.min(_[2].length,10)).replace(/([^0])0+$/,"$1"),U=O.indexOf(".");let F=R.indexOf(".")-U,fe=R.length-O.length-F;return f(R.substr(0,F)+O+R.substr(R.length-fe))}if(_=R.match(/^00,000\.([#0]*0)$/))return U=d(y,_[1].length),y<0?"-"+E(N,R,-y):qt(v(y)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(F){return"00,"+(F.length<3?ht(0,3-F.length):"")+F})+"."+ht(U,_[1].length);switch(R){case"###,##0.00":return E(N,"#,##0.00",y);case"###,###":case"##,###":case"#,###":let F=qt(sr(B,0));return F!=="0"?K+F:"";case"###,###.00":return E(N,"###,##0.00",y).replace(/^0\./,".");case"#,###.00":return E(N,"#,##0.00",y).replace(/^0\./,".");default:}throw new Error("unsupported format |"+R+"|")}function g(N,R,y){let O=R.length-1;for(;R.charCodeAt(O-1)===44;)--O;return wt(N,R.substr(0,O),y/Math.pow(10,3*(R.length-O)))}function m(N,R,y){let O=R.replace(e,""),_=R.length-O.length;return wt(N,O,y*Math.pow(10,2*_))+Ze("%",_)}function T(N,R){let y,O=N.indexOf("E")-N.indexOf(".")-1;if(N.match(/^#+0.0E\+0$/)){if(R===0)return"0.0E+0";if(R<0)return"-"+T(N,-R);let _=N.indexOf(".");_===-1&&(_=N.indexOf("E"));let U=Math.floor(Math.log(R)*Math.LOG10E)%_;if(U<0&&(U+=_),y=(R/Math.pow(10,U)).toPrecision(O+1+(_+U)%_),!y.match(/[Ee]/)){let S=Math.floor(Math.log(R)*Math.LOG10E);y.indexOf(".")===-1?y=y.charAt(0)+"."+y.substr(1)+"E+"+(S-y.length+U):y+="E+"+(S-U),y=y.replace(/\+-/,"-")}y=y.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(S,B,K,W){return B+K+W.substr(0,(_+U)%_)+"."+W.substr(U)+"E"})}else y=R.toExponential(O);return N.match(/E\+00$/)&&y.match(/e[+-]\d$/)&&(y=y.substr(0,y.length-1)+"0"+y.charAt(y.length-1)),N.match(/E\-/)&&y.match(/e\+/)&&(y=y.replace(/e\+/,"e")),y.replace("e","E")}function A(N,R,y){if(N.charCodeAt(0)===40&&!R.match(a)){let F=R.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return y>=0?A("n",F,y):"("+A("n",F,-y)+")"}if(R.charCodeAt(R.length-1)===44)return g(N,R,y);if(R.indexOf("%")!==-1)return m(N,R,y);if(R.indexOf("E")!==-1)return T(R,y);if(R.charCodeAt(0)===36)return"$"+A(N,R.substr(R.charAt(1)==" "?2:1),y);let O,_,U,S,B=Math.abs(y),K=y<0?"-":"";if(R.match(/^00+$/))return K+ht(B,R.length);if(R.match(/^[#?]+$/))return O=""+y,y===0&&(O=""),O.length>R.length?O:f(R.substr(0,R.length-O.length))+O;if(_=R.match(s))return u(_,B,K);if(R.match(/^#+0+$/))return K+ht(B,R.length-R.indexOf("0"));if(_=R.match(o))return O=(""+y).replace(/^([^\.]+)$/,"$1."+f(_[1])).replace(/\.$/,"."+f(_[1])),O=O.replace(/\.(\d*)$/,function(F,fe){return"."+fe+Ze("0",f(_[1]).length-fe.length)}),R.indexOf("0.")!==-1?O:O.replace(/^0\./,".");if(R=R.replace(/^#+([0.])/,"$1"),_=R.match(/^(0*)\.(#*)$/))return K+(""+B).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,_[1].length?"0.":".");if(_=R.match(/^#{1,3},##0(\.?)$/))return K+qt(""+B);if(_=R.match(/^#,##0\.([#0]*0)$/))return y<0?"-"+A(N,R,-y):qt(""+y)+"."+Ze("0",_[1].length);if(_=R.match(/^#,#*,#0/))return A(N,R.replace(/^#,#*,/,""),y);if(_=R.match(/^([0#]+)(\\?-([0#]+))+$/))return O=ar(A(N,R.replace(/[\\-]/g,""),y)),U=0,ar(ar(R.replace(/\\/g,"")).replace(/[0#]/g,function(F){return U<O.length?O.charAt(U++):F==="0"?"0":""}));if(R.match(c))return O=A(N,"##########",y),"("+O.substr(0,3)+") "+O.substr(3,3)+"-"+O.substr(6);let W="";if(_=R.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return U=Math.min(_[4].length,7),S=en(B,Math.pow(10,U)-1,!1),O=""+K,W=wt("n",_[1],S[1]),W.charAt(W.length-1)==" "&&(W=W.substr(0,W.length-1)+"0"),O+=W+_[2]+"/"+_[3],W=Jr(S[2],U),W.length<_[4].length&&(W=f(_[4].substr(_[4].length-W.length))+W),O+=W,O;if(_=R.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return U=Math.min(Math.max(_[1].length,_[4].length),7),S=en(B,Math.pow(10,U)-1,!0),K+(S[0]||(S[1]?"":"0"))+" "+(S[1]?li(S[1],U)+_[2]+"/"+_[3]+Jr(S[2],U):Ze(" ",2*U+1+_[2].length+_[3].length));if(_=R.match(/^[#0?]+$/))return O=""+y,R.length<=O.length?O:f(R.substr(0,R.length-O.length))+O;if(_=R.match(/^([#0]+)\.([#0]+)$/)){O=""+y.toFixed(Math.min(_[2].length,10)).replace(/([^0])0+$/,"$1"),U=O.indexOf(".");let F=R.indexOf(".")-U,fe=R.length-O.length-F;return f(R.substr(0,F)+O+R.substr(R.length-fe))}if(_=R.match(/^00,000\.([#0]*0)$/))return y<0?"-"+A(N,R,-y):qt(""+y).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(F){return"00,"+(F.length<3?ht(0,3-F.length):"")+F})+"."+ht(0,_[1].length);switch(R){case"###,###":case"##,###":case"#,###":let F=qt(""+B);return F!=="0"?K+F:"";default:if(R.match(/\.[0#?]*$/))return A(N,R.slice(0,R.lastIndexOf(".")),y)+f(R.slice(R.lastIndexOf(".")))}throw new Error("unsupported format |"+R+"|")}return function(R,y,O){return(O|0)===O?A(R,y,O):E(R,y,O)}}();function Ms(t){let e=[],r=!1,n=0;for(let i=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=t.substr(n,i-n),n=i+1}if(e[e.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}De._split=Ms;var Cs=/\[[HhMmSs]*\]/;function ws(t){let e=0,r="",n="";for(;e<t.length;)switch(r=t.charAt(e)){case"G":jr(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;)++e;++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Cs))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)===" "||t.charAt(e)==="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}De.is_date=ws;function Ps(t,e,r,n){let i=[],s="",l=0,u="",o="t",a,c,f,p="H";for(;l<t.length;)switch(u=t.charAt(l)){case"G":if(!jr(t,l))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(f=t.charCodeAt(++l))!==34&&l<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++l;break;case"\\":let R=t.charAt(++l),y=R==="("||R===")"?R:"t";i[i.length]={t:y,v:R},++l;break;case"_":i[i.length]={t:"t",v:" "},l+=2;break;case"@":i[i.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(a==null&&(a=Cr(e,r,t.charAt(l+1)==="2"),a==null))return"";i[i.length]={t:"X",v:t.substr(l,2)},o=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||a==null&&(a=Cr(e,r),a==null))return"";for(s=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&o.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=p),i[i.length]={t:u,v:s},o=u;break;case"A":case"a":let O={t:u,v:u};if(a==null&&(a=Cr(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(a!=null&&(O.v=a.H>=12?"P":"A"),O.t="T",p="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(a!=null&&(O.v=a.H>=12?"PM":"AM"),O.t="T",l+=5,p="h"):(O.t="t",++l),a==null&&O.t==="T")return"";i[i.length]=O,o=u;break;case"[":for(s=u;t.charAt(l++)!=="]"&&l<t.length;)s+=t.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Cs)){if(a==null&&(a=Cr(e,r),a==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},o=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ws(t)||(i[i.length]={t:"t",v:s}));break;case".":if(a!=null){for(s=u;++l<t.length&&(u=t.charAt(l))==="0";)s+=u;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1||u=="\\"&&t.charAt(l+1)=="-"&&l<t.length-2&&"0#".indexOf(t.charAt(l+2))>-1;)s+=u;i[i.length]={t:"n",v:s};break;case"?":for(s=u;t.charAt(++l)===u;)s+=u;i[i.length]={t:u,v:s},o=u;break;case"*":++l,(t.charAt(l)===" "||t.charAt(l)==="*")&&++l;break;case"(":case")":i[i.length]={t:n===1||typeof e=="number"&&e<0?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)s+=t.charAt(l);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:u,v:u},++l;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++l;break}let d=0,h=0,v;for(l=i.length-1,o="t";l>=0;--l)switch(i[l].t){case"h":case"H":i[l].t=p,o="h",d<1&&(d=1);break;case"s":(v=i[l].v.match(/\.0+$/))&&(h=Math.max(h,v[0].length-1)),d<3&&(d=3);case"d":case"y":case"M":case"e":o=i[l].t;break;case"m":o==="s"&&(i[l].t="M",d<2&&(d=2));break;case"X":break;case"Z":d<1&&i[l].v.match(/[Hh]/)&&(d=1),d<2&&i[l].v.match(/[Mm]/)&&(d=2),d<3&&i[l].v.match(/[Ss]/)&&(d=3)}switch(d){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M);break}let E="",g;for(l=0;l<i.length;++l)switch(i[l].t){case"t":case"T":case" ":case"D":break;case"X":i[l].v="",i[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[l].v=$p(i[l].t.charCodeAt(0),i[l].v,a,h),i[l].t="t";break;case"n":case"(":case"?":for(g=l+1;i[g]!=null&&((u=i[g].t)==="?"||u==="D"||(u===" "||u==="t")&&i[g+1]!=null&&(i[g+1].t==="?"||i[g+1].t==="t"&&i[g+1].v==="/")||i[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[g].v==="/"||i[g].v===" "&&i[g+1]!=null&&i[g+1].t==="?"));)i[l].v+=i[g].v,i[g]={v:"",t:";"},++g;E+=i[l].v,l=g-1;break;case"G":i[l].t="t",i[l].v=tn(e,r);break}let m="",T,A;if(E.length>0){E.charCodeAt(0)===40?(T=e<0&&E.charCodeAt(0)===45?-e:e,A=wt("(",E,T)):(T=e<0&&n>1?-e:e,A=wt("n",E,T),T<0&&i[0]&&i[0].t==="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),g=A.length-1;let R=i.length;for(l=0;l<i.length;++l)if(i[l]!=null&&i[l].t!=="t"&&i[l].v.indexOf(".")>-1){R=l;break}let y=i.length;if(R===i.length&&A.indexOf("E")===-1){for(l=i.length-1;l>=0;--l)i[l]==null||"n?(".indexOf(i[l].t)===-1||(g>=i[l].v.length-1?(g-=i[l].v.length,i[l].v=A.substr(g+1,i[l].v.length)):g<0?i[l].v="":(i[l].v=A.substr(0,g+1),g=-1),i[l].t="t",y=l);g>=0&&y<i.length&&(i[y].v=A.substr(0,g+1)+i[y].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(g=A.indexOf(".")-1,l=R;l>=0;--l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1)){for(c=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")-1:i[l].v.length-1,m=i[l].v.substr(c+1);c>=0;--c)g>=0&&(i[l].v.charAt(c)==="0"||i[l].v.charAt(c)==="#")&&(m=A.charAt(g--)+m);i[l].v=m,i[l].t="t",y=l}for(g>=0&&y<i.length&&(i[y].v=A.substr(0,g+1)+i[y].v),g=A.indexOf(".")+1,l=R;l<i.length;++l)if(!(i[l]==null||"n?(".indexOf(i[l].t)===-1&&l!==R)){for(c=i[l].v.indexOf(".")>-1&&l===R?i[l].v.indexOf(".")+1:0,m=i[l].v.substr(0,c);c<i[l].v.length;++c)g<A.length&&(m+=A.charAt(g++));i[l].v=m,i[l].t="t",y=l}}}for(l=0;l<i.length;++l)i[l]!=null&&"n(?".indexOf(i[l].t)>-1&&(T=n>1&&e<0&&l>0&&i[l-1].v==="-"?-e:e,i[l].v=wt(i[l].t,i[l].v,T),i[l].t="t");let N="";for(l=0;l!==i.length;++l)i[l]!=null&&(N+=i[l].v);return N}De._eval=Ps;var Us=/\[[=<>]/,Ls=/\[([=<>]*)(-?\d+\.?\d*)\]/;function xs(t,e){if(e==null)return!1;let r=parseFloat(e[2]);switch(e[1]){case"=":if(t===r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!==r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Xp(t,e){let r=Ms(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}let s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(Us)!=null||r[1].match(Us)!=null){let l=r[0].match(Ls),u=r[1].match(Ls);return xs(e,l)?[n,r[0]]:xs(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,s]}function ks(t,e,r){r==null&&(r={});let n="";switch(typeof t){case"string":t==="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t===14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Xt)[t];break}if(jr(n,0))return tn(e,r);e instanceof Date&&(e=Os(e,r.date1904));let i=Xp(n,e);if(jr(i[1]))return tn(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Ps(i[1],e,r,i[0])}function Ss(t,e){if(typeof e!="number"){e=+e||-1;for(let r=0;r<392;++r){if(Xt[r]===void 0){e<0&&(e=r);continue}if(Xt[r]===t){e=r;break}}e<0&&(e=391)}return Xt[e]=t,e}De.load=Ss;De._table=Xt;De.get_table=function(){return Xt};De.load_table=function(e){for(let r=0;r!==392;++r)e[r]!==void 0&&Ss(e[r],r)};De.init_table=Ns;De.format=ks;bs.exports=De});var Ds=w((rR,nn)=>{var Fs="\u0E28\u0E39\u0E19\u0E22\u0E4C\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19",Qp=["","\u0E2B\u0E19\u0E36\u0E48\u0E07","\u0E2A\u0E2D\u0E07","\u0E2A\u0E32\u0E21","\u0E2A\u0E35\u0E48","\u0E2B\u0E49\u0E32","\u0E2B\u0E01","\u0E40\u0E08\u0E47\u0E14","\u0E41\u0E1B\u0E14","\u0E40\u0E01\u0E49\u0E32"],Zp=["","\u0E2A\u0E34\u0E1A","\u0E23\u0E49\u0E2D\u0E22","\u0E1E\u0E31\u0E19","\u0E2B\u0E21\u0E37\u0E48\u0E19","\u0E41\u0E2A\u0E19","\u0E25\u0E49\u0E32\u0E19"];function rn(t){let e="",r=t.length,n=7;if(r>n){let i=r-n+1,s=t.slice(0,i),l=t.slice(i);return rn(s)+"\u0E25\u0E49\u0E32\u0E19"+rn(l)}else for(let i=0;i<r;i++){let s=t[i];s>0&&(e+=Qp[s]+Zp[r-i-1])}return e}function Bs(t){let e=t;e=e.replace("\u0E2B\u0E19\u0E36\u0E48\u0E07\u0E2A\u0E34\u0E1A","\u0E2A\u0E34\u0E1A"),e=e.replace("\u0E2A\u0E2D\u0E07\u0E2A\u0E34\u0E1A","\u0E22\u0E35\u0E48\u0E2A\u0E34\u0E1A");let r=5;return e.length>r&&e.length-e.lastIndexOf("\u0E2B\u0E19\u0E36\u0E48\u0E07")===r&&(e=e.substr(0,e.length-r)+"\u0E40\u0E2D\u0E47\u0E14"),e}function Jp(t,e){let r="";return t===""&&e===""?r=Fs:t!==""&&e===""?r=t+"\u0E1A\u0E32\u0E17\u0E16\u0E49\u0E27\u0E19":t===""&&e!==""?r=e+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C":r=t+"\u0E1A\u0E32\u0E17"+e+"\u0E2A\u0E15\u0E32\u0E07\u0E04\u0E4C",r}function jp(t){let e=Fs;if(isNaN(t)||t>=Number.MAX_SAFE_INTEGER)return e;let r=Math.floor(t).toString(),n=Math.round(t%1*100).toString(),i=Array.from(r).map(Number),s=Array.from(n).map(Number),l=rn(i),u=rn(s);return l=Bs(l),u=Bs(u),e=Jp(l,u),e}typeof nn!="undefined"&&nn.exports!=null&&(nn.exports=jp)});var di=w((nR,Hs)=>{var Ye=Oe(),{FormulaHelpers:ed,Types:Y,WildCard:qs}=Ce(),H=ed,pi=hi(),td=Ds(),Gs={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"\uFF61\uFF62\uFF63\uFF64\uFF65\uFF66\uFF67\uFF68\uFF69\uFF6A\uFF6B\uFF6C\uFF6D\uFF6E\uFF6F\uFF70\uFF71\uFF72\uFF73\uFF74\uFF75\uFF76\uFF77\uFF78\uFF79\uFF7A\uFF7B\uFF7C\uFF7D\uFF7E\uFF7F\uFF80\uFF81\uFF82\uFF83\uFF84\uFF85\uFF86\uFF87\uFF88\uFF89\uFF8A\uFF8B\uFF8C\uFF8D\uFF8E\uFF8F\uFF90\uFF91\uFF92\uFF93\uFF94\uFF95\uFF96\uFF97\uFF98\uFF99\uFF9A\uFF9B\uFF9C\uFF9D\uFF9E\uFF9F",full:"\u3002\u300C\u300D\u3001\u30FB\u30F2\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3\u30FC\u30A2\u30A4\u30A6\u30A8\u30AA\u30AB\u30AD\u30AF\u30B1\u30B3\u30B5\u30B7\u30B9\u30BB\u30BD\u30BF\u30C1\u30C4\u30C6\u30C8\u30CA\u30CB\u30CC\u30CD\u30CE\u30CF\u30D2\u30D5\u30D8\u30DB\u30DE\u30DF\u30E0\u30E1\u30E2\u30E4\u30E6\u30E8\u30E9\u30EA\u30EB\u30EC\u30ED\u30EF\u30F3\u309B\u309C"},extras:{delta:0,half:"\xA2\xA3\xAC\xAF\xA6\xA5\u20A9 |\u2190\u2191\u2192\u2193\u25A0\xB0",full:"\uFFE0\uFFE1\uFFE2\uFFE3\uFFE4\uFFE5\uFFE6\u3000\uFFE8\uFFE9\uFFEA\uFFEB\uFFEC\uFFED\uFFEE"}},rd=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)],nd=t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)],Vs=(t,e)=>t[e+"RE"]||new RegExp("["+t[e]+"]","g"),Ws=Object.keys(Gs).map(t=>Gs[t]),id=t=>Ws.reduce((e,r)=>e.replace(Vs(r,"half"),rd(r)),t),od=t=>Ws.reduce((e,r)=>e.replace(Vs(r,"full"),nd(r)),t),Pt={ASC:t=>(t=H.accept(t,Y.STRING),od(t)),BAHTTEXT:t=>{t=H.accept(t,Y.NUMBER);try{return td(t)}catch(e){throw Error(`Error in https://github.com/jojoee/bahttext 
${e.toString()}`)}},CHAR:t=>{if(t=H.accept(t,Y.NUMBER),t>255||t<1)throw Ye.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=H.accept(t,Y.STRING),t.replace(/[\x00-\x1F]/g,"")),CODE:t=>{if(t=H.accept(t,Y.STRING),t.length===0)throw Ye.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return H.flattenParams(t,Y.STRING,!1,r=>{r=H.accept(r,Y.STRING),e+=r}),e},CONCATENATE:(...t)=>{let e="";if(t.length===0)throw Error("CONCATENATE need at least one argument.");return t.forEach(r=>{r=H.accept(r,Y.STRING),e+=r}),e},DBCS:t=>(t=H.accept(t,Y.STRING),id(t)),DOLLAR:(t,e)=>{t=H.accept(t,Y.NUMBER),e=H.accept(e,Y.NUMBER,2);let r=Array(e).fill("0").join("");return pi.format(`$#,##0.${r}_);($#,##0.${r})`,t).trim()},EXACT:(t,e)=>(t=H.accept(t,[Y.STRING]),e=H.accept(e,[Y.STRING]),t===e),FIND:(t,e,r)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.STRING),r=H.accept(r,Y.NUMBER,1),r<1||r>e.length)throw Ye.VALUE;let n=e.indexOf(t,r-1);if(n===-1)throw Ye.VALUE;return n+1},FINDB:(...t)=>Pt.FIND(...t),FIXED:(t,e,r)=>{t=H.accept(t,Y.NUMBER),e=H.accept(e,Y.NUMBER,2),r=H.accept(r,Y.BOOLEAN,!1);let n=Array(e).fill("0").join(""),i=r?"":"#,";return pi.format(`${i}##0.${n}_);(${i}##0.${n})`,t).trim()},LEFT:(t,e)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.NUMBER,1),e<0)throw Ye.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>Pt.LEFT(...t),LEN:t=>(t=H.accept(t,Y.STRING),t.length),LENB:(...t)=>Pt.LEN(...t),LOWER:t=>(t=H.accept(t,Y.STRING),t.toLowerCase()),MID:(t,e,r)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.NUMBER),r=H.accept(r,Y.NUMBER),e>t.length)return"";if(e<1||r<1)throw Ye.VALUE;return t.slice(e-1,e+r-1)},MIDB:(...t)=>Pt.MID(...t),NUMBERVALUE:(t,e,r)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.STRING,"."),r=H.accept(r,Y.STRING,","),t.length===0)return 0;if(e.length===0||r.length===0||(e=e[0],r=r[0],e===r||t.indexOf(e)<t.lastIndexOf(r)))throw Ye.VALUE;let n=t.replace(r,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!n)throw Ye.VALUE;let i=n[1].length,s=n[3].length,l=n[4].length,u=Number(n[2]);if(i>1||i&&!s||!i&&s||isNaN(u))throw Ye.VALUE;return u=u/100**l,i?-u:u},PHONETIC:()=>{},PROPER:t=>(t=H.accept(t,[Y.STRING]),t=t.toLowerCase(),t=t.charAt(0).toUpperCase()+t.slice(1),t.replace(/(?:[^a-zA-Z])([a-zA-Z])/g,e=>e.toUpperCase())),REPLACE:(t,e,r,n)=>{t=H.accept(t,[Y.STRING]),e=H.accept(e,[Y.NUMBER]),r=H.accept(r,[Y.NUMBER]),n=H.accept(n,[Y.STRING]);let i=t.split("");return i.splice(e-1,r,n),i.join("")},REPLACEB:(...t)=>Pt.REPLACE(...t),REPT:(t,e)=>{t=H.accept(t,Y.STRING),e=H.accept(e,Y.NUMBER);let r="";for(let n=0;n<e;n++)r+=t;return r},RIGHT:(t,e)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.NUMBER,1),e<0)throw Ye.VALUE;let r=t.length;return e>r?t:t.slice(r-e)},RIGHTB:(...t)=>Pt.RIGHT(...t),SEARCH:(t,e,r)=>{if(t=H.accept(t,Y.STRING),e=H.accept(e,Y.STRING),r=H.accept(r,Y.NUMBER,1),r<1||r>e.length)throw Ye.VALUE;let n=qs.isWildCard(t)?qs.toRegex(t,"i"):t,i=e.slice(r-1).search(n);if(i===-1)throw Ye.VALUE;return i+r},SEARCHB:(...t)=>Pt.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>(t=H.accept(t),typeof t=="string"?t:""),TEXT:(t,e)=>{t=H.accept(t,Y.NUMBER),e=H.accept(e,Y.STRING);try{return pi.format(e,t)}catch(r){throw console.error(r),Ye.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=H.accept(t,[Y.STRING]),t.replace(/^\s+|\s+$/g,"")),UNICHAR:t=>{if(t=H.accept(t,[Y.NUMBER]),t<=0)throw Ye.VALUE;return String.fromCharCode(t)},UNICODE:t=>Pt.CODE(t)};Hs.exports=Pt});var Pr=w((iR,Ys)=>{var wr=Oe(),{FormulaHelpers:on}=Ce(),ad={unaryOp:(t,e,r)=>{let n=1;if(t.forEach(i=>{if(i!=="+")if(i==="-")n=-n;else throw new Error(`Unrecognized prefix: ${i}`)}),e==null&&(e=0),n===1)return e;try{e=on.acceptNumber(e,r)}catch(i){if(i instanceof wr)Array.isArray(e)&&(e=e[0][0]);else throw i}return typeof e=="number"&&isNaN(e)?wr.VALUE:-e}},sd={percentOp:(t,e,r)=>{try{t=on.acceptNumber(t,r)}catch(n){if(n instanceof wr)return n;throw n}if(e==="%")return t/100;throw new Error(`Unrecognized postfix: ${e}`)}},Gt={boolean:3,string:2,number:1},ud={compareOp:(t,e,r,n,i)=>{t==null&&(t=0),r==null&&(r=0),n&&(t=t[0][0]),i&&(r=r[0][0]);let s=typeof t,l=typeof r;if(s===l)switch(e){case"=":return t===r;case">":return t>r;case"<":return t<r;case"<>":return t!==r;case"<=":return t<=r;case">=":return t>=r}else switch(e){case"=":return!1;case">":return Gt[s]>Gt[l];case"<":return Gt[s]<Gt[l];case"<>":return!0;case"<=":return Gt[s]<=Gt[l];case">=":return Gt[s]>=Gt[l]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,r,n,i)=>{t==null&&(t=""),r==null&&(r=""),n&&(t=t[0][0]),i&&(r=r[0][0]);let s=typeof t,l=typeof r;return s==="boolean"&&(t=t?"TRUE":"FALSE"),l==="boolean"&&(r=r?"TRUE":"FALSE"),""+t+r},mathOp:(t,e,r,n,i)=>{t==null&&(t=0),r==null&&(r=0);try{t=on.acceptNumber(t,n),r=on.acceptNumber(r,i)}catch(s){if(s instanceof wr)return s;throw s}switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return r===0?wr.DIV0:t/r;case"^":return t**r}throw Error("Infix.mathOp: Should not reach here.")}};Ys.exports={Prefix:ad,Postfix:sd,Infix:ud,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}});var Ei=w((oR,$s)=>{var oe=Oe(),{FormulaHelpers:cd,Types:k,Factorials:zs,Criteria:ld}=Ce(),{Infix:fd}=Pr(),L=cd,vi=[],gi=[];function an(t){return t<=100?zs[t]:vi[t]>0?vi[t]:vi[t]=an(t-1)*t}function Ks(t){return t===1||t===0?1:t===2?2:gi[t]>0?gi[t]:gi[t]=Ks(t-2)*t}var Je={ABS:t=>(t=L.accept(t,k.NUMBER),Math.abs(t)),AGGREGATE:(t,e,r,...n)=>{},ARABIC:t=>{if(t=L.accept(t,k.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new oe("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(r){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[r]}),e},BASE:(t,e,r)=>{if(t=L.accept(t,k.NUMBER),t<0||t>=2**53||(e=L.accept(e,k.NUMBER),e<2||e>36)||(r=L.accept(r,k.NUMBER,0),r<0))throw oe.NUM;let n=t.toString(e).toUpperCase();return new Array(Math.max(r+1-n.length,0)).join("0")+n},CEILING:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),e===0)return 0;if(t/e%1==0)return t;let r=Math.abs(e),n=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*(n+1):-r*n:(n+1)*r},"CEILING.MATH":(t,e,r)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,t>0?1:-1),r=L.accept(r,k.NUMBER,0),t>=0)return Je.CEILING(t,e);let n=r?e:0;return Je.CEILING(t,e)-n},"CEILING.PRECISE":(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,1),Je.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),t<0||e<0||t<e)throw oe.NUM;let r=Je.FACT(t),n=Je.FACT(e);return r/n/Je.FACT(t-e)},COMBINA:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),(t===0||t===1)&&e===0)return 1;if(t<0||e<0)throw oe.NUM;return Je.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=L.accept(t,k.STRING),e=L.accept(e,k.NUMBER),e=Math.trunc(e),e<2||e>36)throw oe.NUM;let r=parseInt(t,e);if(isNaN(r))throw oe.NUM;return r},DEGREES:t=>(t=L.accept(t,k.NUMBER),t*(180/Math.PI)),EVEN:t=>Je.CEILING(t,-2),EXP:t=>(t=L.accept(t,k.NUMBER),Math.exp(t)),FACT:t=>{if(t=L.accept(t,k.NUMBER),t=Math.trunc(t),t>170||t<0)throw oe.NUM;return t<=100?zs[t]:an(t)},FACTDOUBLE:t=>{if(t=L.accept(t,k.NUMBER),t=Math.trunc(t),t<-1)throw oe.NUM;return t===-1?1:Ks(t)},FLOOR:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),e===0)return 0;if(t>0&&e<0)throw oe.NUM;if(t/e%1==0)return t;let r=Math.abs(e),n=Math.floor(Math.abs(t)/r);return t<0?e<0?-r*n:-r*(n+1):n*r},"FLOOR.MATH":(t,e,r)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,t>0?1:-1),r=L.accept(r,k.NUMBER,0),r===0||t>=0?Je.FLOOR(t,Math.abs(e)):Je.FLOOR(t,e)+e),"FLOOR.PRECISE":(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,1),Je.FLOOR(t,Math.abs(e))),GCD:(...t)=>{let e=[];L.flattenParams(t,null,!1,l=>{if(l=typeof l=="boolean"?NaN:Number(l),isNaN(l))throw oe.VALUE;if(l<0||l>9007199254740990)throw oe.NUM;e.push(Math.trunc(l))},0);let r,n,i=t.length,s=Math.abs(e[0]);for(r=1;r<i;r++){for(n=Math.abs(e[r]);s&&n;)s>n?s%=n:n%=s;s+=n}return s},INT:t=>(t=L.accept(t,k.NUMBER),Math.floor(t)),"ISO.CEILING":(...t)=>Je["CEILING.PRECISE"](...t),LCM:(...t)=>{let e=[];L.flattenParams(t,null,!1,i=>{if(i=typeof i=="boolean"?NaN:Number(i),isNaN(i))throw oe.VALUE;if(i<0||i>9007199254740990)throw oe.NUM;e.push(Math.trunc(i))},1);let r=e.length,n=Math.abs(e[0]);for(let i=1;i<r;i++){let s=Math.abs(e[i]),l=n;for(;n&&s;)n>s?n%=s:s%=n;n=Math.abs(l*e[i])/(n+s)}return n},LN:t=>(t=L.accept(t,k.NUMBER),Math.log(t)),LOG:(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,10),Math.log(t)/Math.log(e)),LOG10:t=>(t=L.accept(t,k.NUMBER),Math.log10(t)),MDETERM:t=>{if(t=L.accept(t,k.ARRAY,void 0,!1,!0),t[0].length!==t.length)throw oe.VALUE;let e=t.length,r=t[0].length,n=0,i,s;if(e===1)return t[0][0];if(e===2)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let l=0;l<r;l++){i=t[0][l],s=t[0][l];for(let u=1;u<e;u++)s*=t[u][((l+u)%r+r)%r],i*=t[u][((l-u)%r+r)%r];n+=s-i}return n},MINVERSE:t=>{},MMULT:(t,e)=>{t=L.accept(t,k.ARRAY,void 0,!1,!0),e=L.accept(e,k.ARRAY,void 0,!1,!0);let r=t.length,n=t[0].length,i=e.length,s=e[0].length,l=new Array(r);if(n!==i)throw oe.VALUE;for(let u=0;u<r;u++){l[u]=new Array(s);for(let o=0;o<s;o++){l[u][o]=0;for(let a=0;a<n;a++){let c=t[u][a],f=e[a][o];if(typeof c!="number"||typeof f!="number")throw oe.VALUE;l[u][o]+=t[u][a]*e[a][o]}}}return l},MOD:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),e===0)throw oe.DIV0;return t-e*Je.INT(t/e)},MROUND:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),e===0)return 0;if(t>0&&e<0||t<0&&e>0)throw oe.NUM;return t/e%1==0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,r=1;return L.flattenParams(t,k.NUMBER,!1,n=>{if(n<0)throw oe.NUM;e+=n,r*=an(n)}),an(e)/r},MUNIT:t=>{t=L.accept(t,k.NUMBER);let e=[];for(let r=0;r<t;r++){let n=[];for(let i=0;i<t;i++)r===i?n.push(1):n.push(0);e.push(n)}return e},ODD:t=>{if(t=L.accept(t,k.NUMBER),t===0)return 1;let e=Math.ceil(Math.abs(t));return e=e&1?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),t**e),PRODUCT:(...t)=>{let e=1;return L.flattenParams(t,null,!0,(r,n)=>{let i=Number(r);n.isLiteral&&!isNaN(i)?e*=i:typeof r=="number"&&(e*=r)},1),e},QUOTIENT:(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),Math.trunc(t/e)),RADIANS:t=>(t=L.accept(t,k.NUMBER),t/180*Math.PI),RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),Math.floor(Math.random()*(e-t+1)+t)),ROMAN:(t,e)=>{if(t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER,0),e!==0)throw Error("ROMAN: only allows form=0 (classic form).");let r=String(t).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],i="",s=3;for(;s--;)i=(n[+r.pop()+s*10]||"")+i;return new Array(+r.join("")+1).join("M")+i},ROUND:(t,e)=>{t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER);let r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;return e>0?n*Math.round(Math.abs(t)*r)/r:e===0?n*Math.round(Math.abs(t)):n*Math.round(Math.abs(t)/r)*r},ROUNDDOWN:(t,e)=>{t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER);let r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;if(e>0){let i=1/r*.5;return n*Math.round((Math.abs(t)-i)*r)/r}else if(e===0){let i=.5;return n*Math.round(Math.abs(t)-i)}else{let i=r*.5;return n*Math.round((Math.abs(t)-i)/r)*r}},ROUNDUP:(t,e)=>{t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER);let r=Math.pow(10,Math.abs(e)),n=t>0?1:-1;if(e>0){let i=1/r*.5;return n*Math.round((Math.abs(t)+i)*r)/r}else if(e===0){let i=.5;return n*Math.round(Math.abs(t)+i)}else{let i=r*.5;return n*Math.round((Math.abs(t)+i)/r)*r}},SERIESSUM:(t,e,r,n)=>{t=L.accept(t,k.NUMBER),e=L.accept(e,k.NUMBER),r=L.accept(r,k.NUMBER);let i=0,s;return L.flattenParams([n],k.NUMBER,!1,l=>{if(typeof l!="number")throw oe.VALUE;i===0?s=l*Math.pow(t,e):s+=l*Math.pow(t,e+i*r),i++}),s},SIGN:t=>(t=L.accept(t,k.NUMBER),t>0?1:t===0?0:-1),SQRT:t=>{if(t=L.accept(t,k.NUMBER),t<0)throw oe.NUM;return Math.sqrt(t)},SQRTPI:t=>{if(t=L.accept(t,k.NUMBER),t<0)throw oe.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return L.flattenParams(t,k.NUMBER,!0,(r,n)=>{(n.isLiteral||typeof r=="number")&&(e+=r)}),e},SUMIF:(t,e,r,n)=>{let i=L.retrieveRanges(t,e,n);e=i[0],n=i[1],r=L.retrieveArg(t,r);let s=r.isArray;r=ld.parse(L.accept(r));let l=0;return e.forEach((u,o)=>{u.forEach((a,c)=>{let f=n[o][c];typeof f=="number"&&(r.op==="wc"?r.match===r.value.test(a)&&(l+=f):fd.compareOp(a,r.op,r.value,Array.isArray(a),s)&&(l+=f))})}),l},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=L.accept(t,k.ARRAY,void 0,!1,!0),e.forEach(n=>{if(n=L.accept(n,k.ARRAY,void 0,!1,!0),t[0].length!==n[0].length||t.length!==n.length)throw oe.VALUE;for(let i=0;i<t.length;i++)for(let s=0;s<t[0].length;s++)typeof t[i][s]!="number"&&(t[i][s]=0),typeof n[i][s]!="number"&&(n[i][s]=0),t[i][s]*=n[i][s]});let r=0;return t.forEach(n=>{n.forEach(i=>{r+=i})}),r},SUMSQ:(...t)=>{let e=0;return L.flattenParams(t,k.NUMBER,!0,(r,n)=>{(n.isLiteral||typeof r=="number")&&(e+=r**2)}),e},SUMX2MY2:(t,e)=>{let r=[],n=[],i=0;if(L.flattenParams([t],null,!1,(s,l)=>{r.push(s)}),L.flattenParams([e],null,!1,(s,l)=>{n.push(s)}),r.length!==n.length)throw oe.NA;for(let s=0;s<r.length;s++)typeof r[s]=="number"&&typeof n[s]=="number"&&(i+=r[s]**2-n[s]**2);return i},SUMX2PY2:(t,e)=>{let r=[],n=[],i=0;if(L.flattenParams([t],null,!1,(s,l)=>{r.push(s)}),L.flattenParams([e],null,!1,(s,l)=>{n.push(s)}),r.length!==n.length)throw oe.NA;for(let s=0;s<r.length;s++)typeof r[s]=="number"&&typeof n[s]=="number"&&(i+=r[s]**2+n[s]**2);return i},SUMXMY2:(t,e)=>{let r=[],n=[],i=0;if(L.flattenParams([t],null,!1,(s,l)=>{r.push(s)}),L.flattenParams([e],null,!1,(s,l)=>{n.push(s)}),r.length!==n.length)throw oe.NA;for(let s=0;s<r.length;s++)typeof r[s]=="number"&&typeof n[s]=="number"&&(i+=(r[s]-n[s])**2);return i},TRUNC:t=>(t=L.accept(t,k.NUMBER),Math.trunc(t))};$s.exports=Je});var Qs=w((aR,Xs)=>{var ze=Oe(),{FormulaHelpers:hd,Types:Te}=Ce(),Ae=hd,ur=2**27-1,pd={ACOS:t=>{if(t=Ae.accept(t,Te.NUMBER),t>1||t<-1)throw ze.NUM;return Math.acos(t)},ACOSH:t=>{if(t=Ae.accept(t,Te.NUMBER),t<1)throw ze.NUM;return Math.acosh(t)},ACOT:t=>(t=Ae.accept(t,Te.NUMBER),Math.PI/2-Math.atan(t)),ACOTH:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)<=1)throw ze.NUM;return Math.atanh(1/t)},ASIN:t=>{if(t=Ae.accept(t,Te.NUMBER),t>1||t<-1)throw ze.NUM;return Math.asin(t)},ASINH:t=>(t=Ae.accept(t,Te.NUMBER),Math.asinh(t)),ATAN:t=>(t=Ae.accept(t,Te.NUMBER),Math.atan(t)),ATAN2:(t,e)=>{if(t=Ae.accept(t,Te.NUMBER),e=Ae.accept(e,Te.NUMBER),e===0&&t===0)throw ze.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>1)throw ze.NUM;return Math.atanh(t)},COS:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;return Math.cos(t)},COSH:t=>(t=Ae.accept(t,Te.NUMBER),Math.cosh(t)),COT:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;if(t===0)throw ze.DIV0;return 1/Math.tan(t)},COTH:t=>{if(t=Ae.accept(t,Te.NUMBER),t===0)throw ze.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;return 1/Math.sin(t)},CSCH:t=>{if(t=Ae.accept(t,Te.NUMBER),t===0)throw ze.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;return 1/Math.cos(t)},SECH:t=>(t=Ae.accept(t,Te.NUMBER),1/Math.cosh(t)),SIN:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;return Math.sin(t)},SINH:t=>(t=Ae.accept(t,Te.NUMBER),Math.sinh(t)),TAN:t=>{if(t=Ae.accept(t,Te.NUMBER),Math.abs(t)>ur)throw ze.NUM;return Math.tan(t)},TANH:t=>(t=Ae.accept(t,Te.NUMBER),Math.tanh(t))};Xs.exports=pd});var Js=w((sR,Zs)=>{var Vt=Oe(),{FormulaHelpers:dd,Types:mi}=Ce(),pt=dd;function Ri(t){let e=0,r=0;return pt.flattenParams(t,null,!0,n=>{let i=typeof n;i==="string"?n==="TRUE"?n=!0:n==="FALSE"&&(n=!1):i==="number"&&(n=Boolean(n)),typeof n=="boolean"&&(n===!0?e++:r++)}),[e,r]}var vd={AND:(...t)=>{let[e,r]=Ri(t);return e===0&&r===0?Vt.VALUE:e>0&&r===0},FALSE:()=>!1,IF:(t,e,r,n)=>(e=pt.accept(e,mi.BOOLEAN),r=pt.accept(r),n=pt.accept(n,null,!1),e?r:n),IFERROR:(t,e)=>t.value instanceof Vt?pt.accept(e):pt.accept(t),IFNA:function(t,e){if(arguments.length>2)throw Vt.TOO_MANY_ARGS("IFNA");return Vt.NA.equals(t.value)?pt.accept(e):pt.accept(t)},IFS:(...t)=>{if(t.length%2!=0)return new Vt("#N/A","IFS expects all arguments after position 0 to be in pairs.");for(let e=0;e<t.length/2;e++){let r=pt.accept(t[e*2],mi.BOOLEAN),n=pt.accept(t[e*2+1]);if(r)return n}return Vt.NA},NOT:t=>(t=pt.accept(t,mi.BOOLEAN),!t),OR:(...t)=>{let[e,r]=Ri(t);return e===0&&r===0?Vt.VALUE:e>0},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{let[e,r]=Ri(t);return e===0&&r===0?Vt.VALUE:e%2==1}};Zs.exports=vd});var eu=w(Ti=>{var js;(function(t){typeof DO_NOT_EXPORT_BESSEL=="undefined"?typeof Ti=="object"?t(Ti):typeof define=="function"&&define.amd?define(function(){var e={};return t(e),e}):t(js={}):t(js={})})(function(t){t.version="1.0.2";var e=Math;function r(a,c){for(var f=0,p=0;f<a.length;++f)p=c*p+a[f];return p}function n(a,c,f,p,d){if(c===0)return f;if(c===1)return p;for(var h=2/a,v=p,E=1;E<c;++E)v=p*E*h+d*f,f=p,p=v;return v}function i(a,c,f,p,d){return function(v,E){if(p){if(v===0)return p==1?-1/0:1/0;if(v<0)return NaN}if(E===0)return a(v);if(E===1)return c(v);if(E<0)return NaN;E|=0;var g=a(v),m=c(v);return n(v,E,g,m,d)}}var s=function(){var a=.636619772,c=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),f=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),p=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function h(A){var N=0,R=0,y=0,O=A*A;if(A<8)R=r(c,O),y=r(f,O),N=R/y;else{var _=A-.785398164;O=64/O,R=r(p,O),y=r(d,O),N=e.sqrt(a/A)*(e.cos(_)*R-e.sin(_)*y*8/A)}return N}var v=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),E=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),g=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function T(A){var N=0,R=0,y=0,O=A*A,_=e.abs(A)-2.356194491;return Math.abs(A)<8?(R=A*r(v,O),y=r(E,O),N=R/y):(O=64/O,R=r(g,O),y=r(m,O),N=e.sqrt(a/e.abs(A))*(e.cos(_)*R-e.sin(_)*y*8/e.abs(A)),A<0&&(N=-N)),N}return function A(N,R){if(R=Math.round(R),!isFinite(N))return isNaN(N)?N:0;if(R<0)return(R%2?-1:1)*A(N,-R);if(N<0)return(R%2?-1:1)*A(-N,R);if(R===0)return h(N);if(R===1)return T(N);if(N===0)return 0;var y=0;if(N>R)y=n(N,R,h(N),T(N),-1);else{for(var O=2*e.floor((R+e.floor(e.sqrt(40*R)))/2),_=!1,U=0,S=0,B=1,K=0,W=2/N,F=O;F>0;F--)K=F*W*B-U,U=B,B=K,e.abs(B)>1e10&&(B*=1e-10,U*=1e-10,y*=1e-10,S*=1e-10),_&&(S+=B),_=!_,F==R&&(y=U);S=2*S-B,y/=S}return y}}(),l=function(){var a=.636619772,c=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),f=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),p=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),d=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse();function h(A){var N=0,R=0,y=0,O=A*A,_=A-.785398164;return A<8?(R=r(c,O),y=r(f,O),N=R/y+a*s(A,0)*e.log(A)):(O=64/O,R=r(p,O),y=r(d,O),N=e.sqrt(a/A)*(e.sin(_)*R+e.cos(_)*y*8/A)),N}var v=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),E=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),g=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),m=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function T(A){var N=0,R=0,y=0,O=A*A,_=A-2.356194491;return A<8?(R=A*r(v,O),y=r(E,O),N=R/y+a*(s(A,1)*e.log(A)-1/A)):(O=64/O,R=r(g,O),y=r(m,O),N=e.sqrt(a/A)*(e.sin(_)*R+e.cos(_)*y*8/A)),N}return i(h,T,"BESSELY",1,-1)}(),u=function(){var a=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),c=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse();function f(v){return v<=3.75?r(a,v*v/(3.75*3.75)):e.exp(e.abs(v))/e.sqrt(e.abs(v))*r(c,3.75/e.abs(v))}var p=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),d=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();function h(v){return v<3.75?v*r(p,v*v/(3.75*3.75)):(v<0?-1:1)*e.exp(e.abs(v))/e.sqrt(e.abs(v))*r(d,3.75/e.abs(v))}return function v(E,g){if(g=Math.round(g),g===0)return f(E);if(g===1)return h(E);if(g<0)return NaN;if(e.abs(E)===0)return 0;if(E==1/0)return 1/0;var m=0,T,A=2/e.abs(E),N=0,R=1,y=0,O=2*e.round((g+e.round(e.sqrt(40*g)))/2);for(T=O;T>0;T--)y=T*A*R+N,N=R,R=y,e.abs(R)>1e10&&(R*=1e-10,N*=1e-10,m*=1e-10),T==g&&(m=N);return m*=v(E,0)/R,E<0&&g%2?-m:m}}(),o=function(){var a=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),c=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();function f(v){return v<=2?-e.log(v/2)*u(v,0)+r(a,v*v/4):e.exp(-v)/e.sqrt(v)*r(c,2/v)}var p=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),d=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();function h(v){return v<=2?e.log(v/2)*u(v,1)+1/v*r(p,v*v/4):e.exp(-v)/e.sqrt(v)*r(d,2/v)}return i(f,h,"BESSELK",2,1)}();t.besselj=s,t.bessely=l,t.besseli=u,t.besselk=o})});var Ni=w((Ai,tu)=>{(function(t,e){typeof Ai=="object"?tu.exports=e():typeof define=="function"&&define.amd?define(e):t.jStat=e()})(Ai,function(){var t=function(e,r){var n=Array.prototype.concat,i=Array.prototype.slice,s=Object.prototype.toString;function l(E,g){var m=E>g?E:g;return e.pow(10,17-~~(e.log(m>0?m:-m)*e.LOG10E))}var u=Array.isArray||function(g){return s.call(g)==="[object Array]"};function o(E){return s.call(E)==="[object Function]"}function a(E){return typeof E=="number"?E-E==0:!1}function c(E){return n.apply([],E)}function f(){return new f._init(arguments)}f.fn=f.prototype,f._init=function(g){if(u(g[0]))if(u(g[0][0])){o(g[1])&&(g[0]=f.map(g[0],g[1]));for(var m=0;m<g[0].length;m++)this[m]=g[0][m];this.length=g[0].length}else this[0]=o(g[1])?f.map(g[0],g[1]):g[0],this.length=1;else if(a(g[0]))this[0]=f.seq.apply(null,g),this.length=1;else{if(g[0]instanceof f)return f(g[0].toArray());this[0]=[],this.length=1}return this},f._init.prototype=f.prototype,f._init.constructor=f,f.utils={calcRdx:l,isArray:u,isFunction:o,isNumber:a,toVector:c},f._random_fn=e.random,f.setRandom=function(g){if(typeof g!="function")throw new TypeError("fn is not a function");f._random_fn=g},f.extend=function(g){var m,T;if(arguments.length===1){for(T in g)f[T]=g[T];return this}for(m=1;m<arguments.length;m++)for(T in arguments[m])g[T]=arguments[m][T];return g},f.rows=function(g){return g.length||1},f.cols=function(g){return g[0].length||1},f.dimensions=function(g){return{rows:f.rows(g),cols:f.cols(g)}},f.row=function(g,m){return u(m)?m.map(function(T){return f.row(g,T)}):g[m]},f.rowa=function(g,m){return f.row(g,m)},f.col=function(g,m){if(u(m)){var T=f.arange(g.length).map(function(){return new Array(m.length)});return m.forEach(function(R,y){f.arange(g.length).forEach(function(O){T[O][y]=g[O][R]})}),T}for(var A=new Array(g.length),N=0;N<g.length;N++)A[N]=[g[N][m]];return A},f.cola=function(g,m){return f.col(g,m).map(function(T){return T[0]})},f.diag=function(g){for(var m=f.rows(g),T=new Array(m),A=0;A<m;A++)T[A]=[g[A][A]];return T},f.antidiag=function(g){for(var m=f.rows(g)-1,T=new Array(m),A=0;m>=0;m--,A++)T[A]=[g[A][m]];return T},f.transpose=function(g){var m=[],T,A,N,R,y;for(u(g[0])||(g=[g]),A=g.length,N=g[0].length,y=0;y<N;y++){for(T=new Array(A),R=0;R<A;R++)T[R]=g[R][y];m.push(T)}return m.length===1?m[0]:m},f.map=function(g,m,T){var A,N,R,y,O;for(u(g[0])||(g=[g]),N=g.length,R=g[0].length,y=T?g:new Array(N),A=0;A<N;A++)for(y[A]||(y[A]=new Array(R)),O=0;O<R;O++)y[A][O]=m(g[A][O],A,O);return y.length===1?y[0]:y},f.cumreduce=function(g,m,T){var A,N,R,y,O;for(u(g[0])||(g=[g]),N=g.length,R=g[0].length,y=T?g:new Array(N),A=0;A<N;A++)for(y[A]||(y[A]=new Array(R)),R>0&&(y[A][0]=g[A][0]),O=1;O<R;O++)y[A][O]=m(y[A][O-1],g[A][O]);return y.length===1?y[0]:y},f.alter=function(g,m){return f.map(g,m,!0)},f.create=function(g,m,T){var A=new Array(g),N,R;for(o(m)&&(T=m,m=g),N=0;N<g;N++)for(A[N]=new Array(m),R=0;R<m;R++)A[N][R]=T(N,R);return A};function p(){return 0}f.zeros=function(g,m){return a(m)||(m=g),f.create(g,m,p)};function d(){return 1}f.ones=function(g,m){return a(m)||(m=g),f.create(g,m,d)},f.rand=function(g,m){return a(m)||(m=g),f.create(g,m,f._random_fn)};function h(E,g){return E===g?1:0}f.identity=function(g,m){return a(m)||(m=g),f.create(g,m,h)},f.symmetric=function(g){var m=g.length,T,A;if(g.length!==g[0].length)return!1;for(T=0;T<m;T++)for(A=0;A<m;A++)if(g[A][T]!==g[T][A])return!1;return!0},f.clear=function(g){return f.alter(g,p)},f.seq=function(g,m,T,A){o(A)||(A=!1);var N=[],R=l(g,m),y=(m*R-g*R)/((T-1)*R),O=g,_;for(_=0;O<=m&&_<T;_++,O=(g*R+y*R*_)/R)N.push(A?A(O,_):O);return N},f.arange=function(g,m,T){var A=[],N;if(T=T||1,m===r&&(m=g,g=0),g===m||T===0)return[];if(g<m&&T<0)return[];if(g>m&&T>0)return[];if(T>0)for(N=g;N<m;N+=T)A.push(N);else for(N=g;N>m;N+=T)A.push(N);return A},f.slice=function(){function E(m,T,A,N){var R,y=[],O=m.length;if(T===r&&A===r&&N===r)return f.copy(m);if(T=T||0,A=A||m.length,T=T>=0?T:O+T,A=A>=0?A:O+A,N=N||1,T===A||N===0)return[];if(T<A&&N<0)return[];if(T>A&&N>0)return[];if(N>0)for(R=T;R<A;R+=N)y.push(m[R]);else for(R=T;R>A;R+=N)y.push(m[R]);return y}function g(m,T){var A,N;if(T=T||{},a(T.row)){if(a(T.col))return m[T.row][T.col];var R=f.rowa(m,T.row);return A=T.col||{},E(R,A.start,A.end,A.step)}if(a(T.col)){var y=f.cola(m,T.col);return N=T.row||{},E(y,N.start,N.end,N.step)}N=T.row||{},A=T.col||{};var O=E(m,N.start,N.end,N.step);return O.map(function(_){return E(_,A.start,A.end,A.step)})}return g}(),f.sliceAssign=function(g,m,T){var A,N;if(a(m.row)){if(a(m.col))return g[m.row][m.col]=T;m.col=m.col||{},m.col.start=m.col.start||0,m.col.end=m.col.end||g[0].length,m.col.step=m.col.step||1,A=f.arange(m.col.start,e.min(g.length,m.col.end),m.col.step);var R=m.row;return A.forEach(function(O,_){g[R][O]=T[_]}),g}if(a(m.col)){m.row=m.row||{},m.row.start=m.row.start||0,m.row.end=m.row.end||g.length,m.row.step=m.row.step||1,N=f.arange(m.row.start,e.min(g[0].length,m.row.end),m.row.step);var y=m.col;return N.forEach(function(O,_){g[O][y]=T[_]}),g}return T[0].length===r&&(T=[T]),m.row.start=m.row.start||0,m.row.end=m.row.end||g.length,m.row.step=m.row.step||1,m.col.start=m.col.start||0,m.col.end=m.col.end||g[0].length,m.col.step=m.col.step||1,N=f.arange(m.row.start,e.min(g.length,m.row.end),m.row.step),A=f.arange(m.col.start,e.min(g[0].length,m.col.end),m.col.step),N.forEach(function(O,_){A.forEach(function(U,S){g[O][U]=T[_][S]})}),g},f.diagonal=function(g){var m=f.zeros(g.length,g.length);return g.forEach(function(T,A){m[A][A]=T}),m},f.copy=function(g){return g.map(function(m){return a(m)?m:m.map(function(T){return T})})};var v=f.prototype;return v.length=0,v.push=Array.prototype.push,v.sort=Array.prototype.sort,v.splice=Array.prototype.splice,v.slice=Array.prototype.slice,v.toArray=function(){return this.length>1?i.call(this):i.call(this)[0]},v.map=function(g,m){return f(f.map(this,g,m))},v.cumreduce=function(g,m){return f(f.cumreduce(this,g,m))},v.alter=function(g){return f.alter(this,g),this},function(E){for(var g=0;g<E.length;g++)(function(m){v[m]=function(T){var A=this,N;return T?(setTimeout(function(){T.call(A,v[m].call(A))}),this):(N=f[m](this),u(N)?f(N):N)}})(E[g])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(E){for(var g=0;g<E.length;g++)(function(m){v[m]=function(T,A){var N=this;return A?(setTimeout(function(){A.call(N,v[m].call(N,T))}),this):f(f[m](this,T))}})(E[g])}("row col".split(" ")),function(E){for(var g=0;g<E.length;g++)(function(m){v[m]=function(){return f(f[m].apply(null,arguments))}})(E[g])}("create zeros ones rand identity".split(" ")),f}(Math);return function(e,r){var n=e.utils.isFunction;function i(u,o){return u-o}function s(u,o,a){return r.max(o,r.min(u,a))}e.sum=function(o){for(var a=0,c=o.length;--c>=0;)a+=o[c];return a},e.sumsqrd=function(o){for(var a=0,c=o.length;--c>=0;)a+=o[c]*o[c];return a},e.sumsqerr=function(o){for(var a=e.mean(o),c=0,f=o.length,p;--f>=0;)p=o[f]-a,c+=p*p;return c},e.sumrow=function(o){for(var a=0,c=o.length;--c>=0;)a+=o[c];return a},e.product=function(o){for(var a=1,c=o.length;--c>=0;)a*=o[c];return a},e.min=function(o){for(var a=o[0],c=0;++c<o.length;)o[c]<a&&(a=o[c]);return a},e.max=function(o){for(var a=o[0],c=0;++c<o.length;)o[c]>a&&(a=o[c]);return a},e.unique=function(o){for(var a={},c=[],f=0;f<o.length;f++)a[o[f]]||(a[o[f]]=!0,c.push(o[f]));return c},e.mean=function(o){return e.sum(o)/o.length},e.meansqerr=function(o){return e.sumsqerr(o)/o.length},e.geomean=function(o){return r.pow(e.product(o),1/o.length)},e.median=function(o){var a=o.length,c=o.slice().sort(i);return a&1?c[a/2|0]:(c[a/2-1]+c[a/2])/2},e.cumsum=function(o){return e.cumreduce(o,function(a,c){return a+c})},e.cumprod=function(o){return e.cumreduce(o,function(a,c){return a*c})},e.diff=function(o){var a=[],c=o.length,f;for(f=1;f<c;f++)a.push(o[f]-o[f-1]);return a},e.rank=function(u){var o,a=[],c={};for(o=0;o<u.length;o++){var f=u[o];c[f]?c[f]++:(c[f]=1,a.push(f))}var p=a.sort(i),d={},h=1;for(o=0;o<p.length;o++){var f=p[o],v=c[f],E=h,g=h+v-1,m=(E+g)/2;d[f]=m,h+=v}return u.map(function(T){return d[T]})},e.mode=function(o){var a=o.length,c=o.slice().sort(i),f=1,p=0,d=0,h=[],v;for(v=0;v<a;v++)c[v]===c[v+1]?f++:(f>p?(h=[c[v]],p=f,d=0):f===p&&(h.push(c[v]),d++),f=1);return d===0?h[0]:h},e.range=function(o){return e.max(o)-e.min(o)},e.variance=function(o,a){return e.sumsqerr(o)/(o.length-(a?1:0))},e.pooledvariance=function(o){var a=o.reduce(function(f,p){return f+e.sumsqerr(p)},0),c=o.reduce(function(f,p){return f+p.length},0);return a/(c-o.length)},e.deviation=function(u){for(var o=e.mean(u),a=u.length,c=new Array(a),f=0;f<a;f++)c[f]=u[f]-o;return c},e.stdev=function(o,a){return r.sqrt(e.variance(o,a))},e.pooledstdev=function(o){return r.sqrt(e.pooledvariance(o))},e.meandev=function(o){for(var a=e.mean(o),c=[],f=o.length-1;f>=0;f--)c.push(r.abs(o[f]-a));return e.mean(c)},e.meddev=function(o){for(var a=e.median(o),c=[],f=o.length-1;f>=0;f--)c.push(r.abs(o[f]-a));return e.median(c)},e.coeffvar=function(o){return e.stdev(o)/e.mean(o)},e.quartiles=function(o){var a=o.length,c=o.slice().sort(i);return[c[r.round(a/4)-1],c[r.round(a/2)-1],c[r.round(a*3/4)-1]]},e.quantiles=function(o,a,c,f){var p=o.slice().sort(i),d=[a.length],h=o.length,v,E,g,m,T,A;for(typeof c=="undefined"&&(c=3/8),typeof f=="undefined"&&(f=3/8),v=0;v<a.length;v++)E=a[v],g=c+E*(1-c-f),m=h*E+g,T=r.floor(s(m,1,h-1)),A=s(m-T,0,1),d[v]=(1-A)*p[T-1]+A*p[T];return d},e.percentile=function(o,a,c){var f=o.slice().sort(i),p=a*(f.length+(c?1:-1))+(c?0:1),d=parseInt(p),h=p-d;return d+1<f.length?f[d-1]+h*(f[d]-f[d-1]):f[d-1]},e.percentileOfScore=function(o,a,c){var f=0,p=o.length,d=!1,h,v;for(c==="strict"&&(d=!0),v=0;v<p;v++)h=o[v],(d&&h<a||!d&&h<=a)&&f++;return f/p},e.histogram=function(o,a){a=a||4;var c=e.min(o),f=(e.max(o)-c)/a,p=o.length,d=[],h;for(h=0;h<a;h++)d[h]=0;for(h=0;h<p;h++)d[r.min(r.floor((o[h]-c)/f),a-1)]+=1;return d},e.covariance=function(o,a){var c=e.mean(o),f=e.mean(a),p=o.length,d=new Array(p),h;for(h=0;h<p;h++)d[h]=(o[h]-c)*(a[h]-f);return e.sum(d)/(p-1)},e.corrcoeff=function(o,a){return e.covariance(o,a)/e.stdev(o,1)/e.stdev(a,1)},e.spearmancoeff=function(u,o){return u=e.rank(u),o=e.rank(o),e.corrcoeff(u,o)},e.stanMoment=function(o,a){for(var c=e.mean(o),f=e.stdev(o),p=o.length,d=0,h=0;h<p;h++)d+=r.pow((o[h]-c)/f,a);return d/o.length},e.skewness=function(o){return e.stanMoment(o,3)},e.kurtosis=function(o){return e.stanMoment(o,4)-3};var l=e.prototype;(function(u){for(var o=0;o<u.length;o++)(function(a){l[a]=function(c,f){var p=[],d=0,h=this;if(n(c)&&(f=c,c=!1),f)return setTimeout(function(){f.call(h,l[a].call(h,c))}),this;if(this.length>1){for(h=c===!0?this:this.transpose();d<h.length;d++)p[d]=e[a](h[d]);return p}return e[a](this[0],c)}})(u[o])})("cumsum cumprod".split(" ")),function(u){for(var o=0;o<u.length;o++)(function(a){l[a]=function(c,f){var p=[],d=0,h=this;if(n(c)&&(f=c,c=!1),f)return setTimeout(function(){f.call(h,l[a].call(h,c))}),this;if(this.length>1){for(a!=="sumrow"&&(h=c===!0?this:this.transpose());d<h.length;d++)p[d]=e[a](h[d]);return c===!0?e[a](e.utils.toVector(p)):p}return e[a](this[0],c)}})(u[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(u){for(var o=0;o<u.length;o++)(function(a){l[a]=function(){var c=[],f=0,p=this,d=Array.prototype.slice.call(arguments),h;if(n(d[d.length-1])){h=d[d.length-1];var v=d.slice(0,d.length-1);return setTimeout(function(){h.call(p,l[a].apply(p,v))}),this}else{h=void 0;var E=function(m){return e[a].apply(p,[m].concat(d))}}if(this.length>1){for(p=p.transpose();f<p.length;f++)c[f]=E(p[f]);return c}return E(this[0])}})(u[o])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,r){e.gammaln=function(i){var s=0,l=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],u=1.000000000190015,o,a,c;for(c=(a=o=i)+5.5,c-=(o+.5)*r.log(c);s<6;s++)u+=l[s]/++a;return r.log(2.5066282746310007*u/o)-c},e.loggam=function(i){var s,l,u,o,a,c,f,p=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(s=i,f=0,i==1||i==2)return 0;for(i<=7&&(f=r.floor(7-i),s=i+f),l=1/(s*s),u=2*r.PI,a=p[9],c=8;c>=0;c--)a*=l,a+=p[c];if(o=a/s+.5*r.log(u)+(s-.5)*r.log(s)-s,i<=7)for(c=1;c<=f;c++)o-=r.log(s-1),s-=1;return o},e.gammafn=function(i){var s=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],l=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],u=!1,o=0,a=0,c=0,f=i,p,d,h,v;if(i>171.6243769536076)return 1/0;if(f<=0)if(v=f%1+36e-17,v)u=(f&1?-1:1)*r.PI/r.sin(r.PI*v),f=1-f;else return 1/0;for(h=f,f<1?d=f++:d=(f-=o=(f|0)-1)-1,p=0;p<8;++p)c=(c+s[p])*d,a=a*d+l[p];if(v=c/a+1,h<f)v/=h;else if(h>f)for(p=0;p<o;++p)v*=f,f++;return u&&(v=u/v),v},e.gammap=function(i,s){return e.lowRegGamma(i,s)*e.gammafn(i)},e.lowRegGamma=function(i,s){var l=e.gammaln(i),u=i,o=1/i,a=o,c=s+1-i,f=1/1e-30,p=1/c,d=p,h=1,v=-~(r.log(i>=1?i:1/i)*8.5+i*.4+17),E;if(s<0||i<=0)return NaN;if(s<i+1){for(;h<=v;h++)o+=a*=s/++u;return o*r.exp(-s+i*r.log(s)-l)}for(;h<=v;h++)E=-h*(h-i),c+=2,p=E*p+c,f=c+E/f,p=1/p,d*=p*f;return 1-d*r.exp(-s+i*r.log(s)-l)},e.factorialln=function(i){return i<0?NaN:e.gammaln(i+1)},e.factorial=function(i){return i<0?NaN:e.gammafn(i+1)},e.combination=function(i,s){return i>170||s>170?r.exp(e.combinationln(i,s)):e.factorial(i)/e.factorial(s)/e.factorial(i-s)},e.combinationln=function(i,s){return e.factorialln(i)-e.factorialln(s)-e.factorialln(i-s)},e.permutation=function(i,s){return e.factorial(i)/e.factorial(i-s)},e.betafn=function(i,s){if(!(i<=0||s<=0))return i+s>170?r.exp(e.betaln(i,s)):e.gammafn(i)*e.gammafn(s)/e.gammafn(i+s)},e.betaln=function(i,s){return e.gammaln(i)+e.gammaln(s)-e.gammaln(i+s)},e.betacf=function(i,s,l){var u=1e-30,o=1,a=s+l,c=s+1,f=s-1,p=1,d=1-a*i/c,h,v,E,g;for(r.abs(d)<u&&(d=u),d=1/d,g=d;o<=100&&(h=2*o,v=o*(l-o)*i/((f+h)*(s+h)),d=1+v*d,r.abs(d)<u&&(d=u),p=1+v/p,r.abs(p)<u&&(p=u),d=1/d,g*=d*p,v=-(s+o)*(a+o)*i/((s+h)*(c+h)),d=1+v*d,r.abs(d)<u&&(d=u),p=1+v/p,r.abs(p)<u&&(p=u),d=1/d,E=d*p,g*=E,!(r.abs(E-1)<3e-7));o++);return g},e.gammapinv=function(i,s){var l=0,u=s-1,o=1e-8,a=e.gammaln(s),c,f,p,d,h,v,E;if(i>=1)return r.max(100,s+100*r.sqrt(s));if(i<=0)return 0;for(s>1?(v=r.log(u),E=r.exp(u*(v-1)-a),h=i<.5?i:1-i,p=r.sqrt(-2*r.log(h)),c=(2.30753+p*.27061)/(1+p*(.99229+p*.04481))-p,i<.5&&(c=-c),c=r.max(.001,s*r.pow(1-1/(9*s)-c/(3*r.sqrt(s)),3))):(p=1-s*(.253+s*.12),i<p?c=r.pow(i/p,1/s):c=1-r.log(1-(i-p)/(1-p)));l<12;l++){if(c<=0)return 0;if(f=e.lowRegGamma(s,c)-i,s>1?p=E*r.exp(-(c-u)+u*(r.log(c)-v)):p=r.exp(-c+u*r.log(c)-a),d=f/p,c-=p=d/(1-.5*r.min(1,d*((s-1)/c-1))),c<=0&&(c=.5*(c+p)),r.abs(p)<o*c)break}return c},e.erf=function(i){var s=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],l=s.length-1,u=!1,o=0,a=0,c,f,p,d;for(i<0&&(i=-i,u=!0),c=2/(2+i),f=4*c-2;l>0;l--)p=o,o=f*o-a+s[l],a=p;return d=c*r.exp(-i*i+.5*(s[0]+f*o)-a),u?d-1:1-d},e.erfc=function(i){return 1-e.erf(i)},e.erfcinv=function(i){var s=0,l,u,o,a;if(i>=2)return-100;if(i<=0)return 100;for(a=i<1?i:2-i,o=r.sqrt(-2*r.log(a/2)),l=-.70711*((2.30753+o*.27061)/(1+o*(.99229+o*.04481))-o);s<2;s++)u=e.erfc(l)-a,l+=u/(1.1283791670955126*r.exp(-l*l)-l*u);return i<1?l:-l},e.ibetainv=function(i,s,l){var u=1e-8,o=s-1,a=l-1,c=0,f,p,d,h,v,E,g,m,T,A,N;if(i<=0)return 0;if(i>=1)return 1;for(s>=1&&l>=1?(d=i<.5?i:1-i,h=r.sqrt(-2*r.log(d)),g=(2.30753+h*.27061)/(1+h*(.99229+h*.04481))-h,i<.5&&(g=-g),m=(g*g-3)/6,T=2/(1/(2*s-1)+1/(2*l-1)),A=g*r.sqrt(m+T)/T-(1/(2*l-1)-1/(2*s-1))*(m+5/6-2/(3*T)),g=s/(s+l*r.exp(2*A))):(f=r.log(s/(s+l)),p=r.log(l/(s+l)),h=r.exp(s*f)/s,v=r.exp(l*p)/l,A=h+v,i<h/A?g=r.pow(s*A*i,1/s):g=1-r.pow(l*A*(1-i),1/l)),N=-e.gammaln(s)-e.gammaln(l)+e.gammaln(s+l);c<10;c++){if(g===0||g===1)return g;if(E=e.ibeta(g,s,l)-i,h=r.exp(o*r.log(g)+a*r.log(1-g)+N),v=E/h,g-=h=v/(1-.5*r.min(1,v*(o/g-a/(1-g)))),g<=0&&(g=.5*(g+h)),g>=1&&(g=.5*(g+h+1)),r.abs(h)<u*g&&c>0)break}return g},e.ibeta=function(i,s,l){var u=i===0||i===1?0:r.exp(e.gammaln(s+l)-e.gammaln(s)-e.gammaln(l)+s*r.log(i)+l*r.log(1-i));return i<0||i>1?!1:i<(s+1)/(s+l+2)?u*e.betacf(i,s,l)/s:1-u*e.betacf(1-i,l,s)/l},e.randn=function(i,s){var l,u,o,a,c;if(s||(s=i),i)return e.create(i,s,function(){return e.randn()});do l=e._random_fn(),u=1.7156*(e._random_fn()-.5),o=l-.449871,a=r.abs(u)+.386595,c=o*o+a*(.196*a-.25472*o);while(c>.27597&&(c>.27846||u*u>-4*r.log(l)*l*l));return u/l},e.randg=function(i,s,l){var u=i,o,a,c,f,p,d;if(l||(l=s),i||(i=1),s)return d=e.zeros(s,l),d.alter(function(){return e.randg(i)}),d;i<1&&(i+=1),o=i-1/3,a=1/r.sqrt(9*o);do{do p=e.randn(),f=1+a*p;while(f<=0);f=f*f*f,c=e._random_fn()}while(c>1-.331*r.pow(p,4)&&r.log(c)>.5*p*p+o*(1-f+r.log(f)));if(i==u)return o*f;do c=e._random_fn();while(c===0);return r.pow(c,1/u)*o*f},function(n){for(var i=0;i<n.length;i++)(function(s){e.fn[s]=function(){return e(e.map(this,function(l){return e[s](l)}))}})(n[i])}("gammaln gammafn factorial factorialln".split(" ")),function(n){for(var i=0;i<n.length;i++)(function(s){e.fn[s]=function(){return e(e[s].apply(null,arguments))}})(n[i])}("randn".split(" "))}(t,Math),function(e,r){(function(u){for(var o=0;o<u.length;o++)(function(a){e[a]=function c(f,p,d){return this instanceof c?(this._a=f,this._b=p,this._c=d,this):new c(f,p,d)},e.fn[a]=function(c,f,p){var d=e[a](c,f,p);return d.data=this,d},e[a].prototype.sample=function(c){var f=this._a,p=this._b,d=this._c;return c?e.alter(c,function(){return e[a].sample(f,p,d)}):e[a].sample(f,p,d)},function(c){for(var f=0;f<c.length;f++)(function(p){e[a].prototype[p]=function(d){var h=this._a,v=this._b,E=this._c;return!d&&d!==0&&(d=this.data),typeof d!="number"?e.fn.map.call(d,function(g){return e[a][p](g,h,v,E)}):e[a][p](d,h,v,E)}})(c[f])}("pdf cdf inv".split(" ")),function(c){for(var f=0;f<c.length;f++)(function(p){e[a].prototype[p]=function(){return e[a][p](this._a,this._b,this._c)}})(c[f])}("mean median mode variance".split(" "))})(u[o])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(o,a,c){return o>1||o<0?0:a==1&&c==1?1:a<512&&c<512?r.pow(o,a-1)*r.pow(1-o,c-1)/e.betafn(a,c):r.exp((a-1)*r.log(o)+(c-1)*r.log(1-o)-e.betaln(a,c))},cdf:function(o,a,c){return o>1||o<0?(o>1)*1:e.ibeta(o,a,c)},inv:function(o,a,c){return e.ibetainv(o,a,c)},mean:function(o,a){return o/(o+a)},median:function(o,a){return e.ibetainv(.5,o,a)},mode:function(o,a){return(o-1)/(o+a-2)},sample:function(o,a){var c=e.randg(o);return c/(c+e.randg(a))},variance:function(o,a){return o*a/(r.pow(o+a,2)*(o+a+1))}}),e.extend(e.centralF,{pdf:function(o,a,c){var f,p,d;return o<0?0:a<=2?o===0&&a<2?1/0:o===0&&a===2?1:1/e.betafn(a/2,c/2)*r.pow(a/c,a/2)*r.pow(o,a/2-1)*r.pow(1+a/c*o,-(a+c)/2):(f=a*o/(c+o*a),p=c/(c+o*a),d=a*p/2,d*e.binomial.pdf((a-2)/2,(a+c-2)/2,f))},cdf:function(o,a,c){return o<0?0:e.ibeta(a*o/(a*o+c),a/2,c/2)},inv:function(o,a,c){return c/(a*(1/e.ibetainv(o,a/2,c/2)-1))},mean:function(o,a){return a>2?a/(a-2):void 0},mode:function(o,a){return o>2?a*(o-2)/(o*(a+2)):void 0},sample:function(o,a){var c=e.randg(o/2)*2,f=e.randg(a/2)*2;return c/o/(f/a)},variance:function(o,a){if(!(a<=4))return 2*a*a*(o+a-2)/(o*(a-2)*(a-2)*(a-4))}}),e.extend(e.cauchy,{pdf:function(o,a,c){return c<0?0:c/(r.pow(o-a,2)+r.pow(c,2))/r.PI},cdf:function(o,a,c){return r.atan((o-a)/c)/r.PI+.5},inv:function(u,o,a){return o+a*r.tan(r.PI*(u-.5))},median:function(o){return o},mode:function(o){return o},sample:function(o,a){return e.randn()*r.sqrt(1/(2*e.randg(.5)))*a+o}}),e.extend(e.chisquare,{pdf:function(o,a){return o<0?0:o===0&&a===2?.5:r.exp((a/2-1)*r.log(o)-o/2-a/2*r.log(2)-e.gammaln(a/2))},cdf:function(o,a){return o<0?0:e.lowRegGamma(a/2,o/2)},inv:function(u,o){return 2*e.gammapinv(u,.5*o)},mean:function(u){return u},median:function(o){return o*r.pow(1-2/(9*o),3)},mode:function(o){return o-2>0?o-2:0},sample:function(o){return e.randg(o/2)*2},variance:function(o){return 2*o}}),e.extend(e.exponential,{pdf:function(o,a){return o<0?0:a*r.exp(-a*o)},cdf:function(o,a){return o<0?0:1-r.exp(-a*o)},inv:function(u,o){return-r.log(1-u)/o},mean:function(u){return 1/u},median:function(u){return 1/u*r.log(2)},mode:function(){return 0},sample:function(o){return-1/o*r.log(e._random_fn())},variance:function(u){return r.pow(u,-2)}}),e.extend(e.gamma,{pdf:function(o,a,c){return o<0?0:o===0&&a===1?1/c:r.exp((a-1)*r.log(o)-o/c-e.gammaln(a)-a*r.log(c))},cdf:function(o,a,c){return o<0?0:e.lowRegGamma(a,o/c)},inv:function(u,o,a){return e.gammapinv(u,o)*a},mean:function(u,o){return u*o},mode:function(o,a){if(o>1)return(o-1)*a},sample:function(o,a){return e.randg(o)*a},variance:function(o,a){return o*a*a}}),e.extend(e.invgamma,{pdf:function(o,a,c){return o<=0?0:r.exp(-(a+1)*r.log(o)-c/o-e.gammaln(a)+a*r.log(c))},cdf:function(o,a,c){return o<=0?0:1-e.lowRegGamma(a,c/o)},inv:function(u,o,a){return a/e.gammapinv(1-u,o)},mean:function(u,o){return u>1?o/(u-1):void 0},mode:function(o,a){return a/(o+1)},sample:function(o,a){return a/e.randg(o)},variance:function(o,a){if(!(o<=2))return a*a/((o-1)*(o-1)*(o-2))}}),e.extend(e.kumaraswamy,{pdf:function(o,a,c){return o===0&&a===1?c:o===1&&c===1?a:r.exp(r.log(a)+r.log(c)+(a-1)*r.log(o)+(c-1)*r.log(1-r.pow(o,a)))},cdf:function(o,a,c){return o<0?0:o>1?1:1-r.pow(1-r.pow(o,a),c)},inv:function(o,a,c){return r.pow(1-r.pow(1-o,1/c),1/a)},mean:function(u,o){return o*e.gammafn(1+1/u)*e.gammafn(o)/e.gammafn(1+1/u+o)},median:function(o,a){return r.pow(1-r.pow(2,-1/a),1/o)},mode:function(o,a){if(o>=1&&a>=1&&o!==1&&a!==1)return r.pow((o-1)/(o*a-1),1/o)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(o,a,c){return o<=0?0:r.exp(-r.log(o)-.5*r.log(2*r.PI)-r.log(c)-r.pow(r.log(o)-a,2)/(2*c*c))},cdf:function(o,a,c){return o<0?0:.5+.5*e.erf((r.log(o)-a)/r.sqrt(2*c*c))},inv:function(u,o,a){return r.exp(-1.4142135623730951*a*e.erfcinv(2*u)+o)},mean:function(o,a){return r.exp(o+a*a/2)},median:function(o){return r.exp(o)},mode:function(o,a){return r.exp(o-a*a)},sample:function(o,a){return r.exp(e.randn()*a+o)},variance:function(o,a){return(r.exp(a*a)-1)*r.exp(2*o+a*a)}}),e.extend(e.noncentralt,{pdf:function(o,a,c){var f=1e-14;return r.abs(c)<f?e.studentt.pdf(o,a):r.abs(o)<f?r.exp(e.gammaln((a+1)/2)-c*c/2-.5*r.log(r.PI*a)-e.gammaln(a/2)):a/o*(e.noncentralt.cdf(o*r.sqrt(1+2/a),a+2,c)-e.noncentralt.cdf(o,a,c))},cdf:function(o,a,c){var f=1e-14,p=200;if(r.abs(c)<f)return e.studentt.cdf(o,a);var d=!1;o<0&&(d=!0,c=-c);for(var h=e.normal.cdf(-c,0,1),v=f+1,E=v,g=o*o/(o*o+a),m=0,T=r.exp(-c*c/2),A=r.exp(-c*c/2-.5*r.log(2)-e.gammaln(3/2))*c;m<p||E>f||v>f;)E=v,m>0&&(T*=c*c/(2*m),A*=c*c/(2*(m+1/2))),v=T*e.beta.cdf(g,m+.5,a/2)+A*e.beta.cdf(g,m+1,a/2),h+=.5*v,m++;return d?1-h:h}}),e.extend(e.normal,{pdf:function(o,a,c){return r.exp(-.5*r.log(2*r.PI)-r.log(c)-r.pow(o-a,2)/(2*c*c))},cdf:function(o,a,c){return .5*(1+e.erf((o-a)/r.sqrt(2*c*c)))},inv:function(u,o,a){return-1.4142135623730951*a*e.erfcinv(2*u)+o},mean:function(u){return u},median:function(o){return o},mode:function(u){return u},sample:function(o,a){return e.randn()*a+o},variance:function(u,o){return o*o}}),e.extend(e.pareto,{pdf:function(o,a,c){return o<a?0:c*r.pow(a,c)/r.pow(o,c+1)},cdf:function(o,a,c){return o<a?0:1-r.pow(a/o,c)},inv:function(o,a,c){return a/r.pow(1-o,1/c)},mean:function(o,a){if(!(a<=1))return a*r.pow(o,a)/(a-1)},median:function(o,a){return o*(a*r.SQRT2)},mode:function(o){return o},variance:function(u,o){if(!(o<=2))return u*u*o/(r.pow(o-1,2)*(o-2))}}),e.extend(e.studentt,{pdf:function(o,a){return a=a>1e100?1e100:a,1/(r.sqrt(a)*e.betafn(.5,a/2))*r.pow(1+o*o/a,-((a+1)/2))},cdf:function(o,a){var c=a/2;return e.ibeta((o+r.sqrt(o*o+a))/(2*r.sqrt(o*o+a)),c,c)},inv:function(u,o){var a=e.ibetainv(2*r.min(u,1-u),.5*o,.5);return a=r.sqrt(o*(1-a)/a),u>.5?a:-a},mean:function(o){return o>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(o){return e.randn()*r.sqrt(o/(2*e.randg(o/2)))},variance:function(o){return o>2?o/(o-2):o>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(o,a,c){return o<0||a<0||c<0?0:c/a*r.pow(o/a,c-1)*r.exp(-r.pow(o/a,c))},cdf:function(o,a,c){return o<0?0:1-r.exp(-r.pow(o/a,c))},inv:function(u,o,a){return o*r.pow(-r.log(1-u),1/a)},mean:function(u,o){return u*e.gammafn(1+1/o)},median:function(o,a){return o*r.pow(r.log(2),1/a)},mode:function(o,a){return a<=1?0:o*r.pow((a-1)/a,1/a)},sample:function(o,a){return o*r.pow(-r.log(e._random_fn()),1/a)},variance:function(o,a){return o*o*e.gammafn(1+2/a)-r.pow(e.weibull.mean(o,a),2)}}),e.extend(e.uniform,{pdf:function(o,a,c){return o<a||o>c?0:1/(c-a)},cdf:function(o,a,c){return o<a?0:o<c?(o-a)/(c-a):1},inv:function(u,o,a){return o+u*(a-o)},mean:function(o,a){return .5*(o+a)},median:function(o,a){return e.mean(o,a)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,a){return o/2+a/2+(a/2-o/2)*(2*e._random_fn()-1)},variance:function(o,a){return r.pow(a-o,2)/12}});function n(u,o,a,c){for(var f=0,p=1,d=1,h=1,v=0,E=0,g;r.abs((d-E)/d)>c;)E=d,g=-(o+v)*(o+a+v)*u/(o+2*v)/(o+2*v+1),f=d+g*f,p=h+g*p,v=v+1,g=v*(a-v)*u/(o+2*v-1)/(o+2*v),d=f+g*d,h=p+g*h,f=f/h,p=p/h,d=d/h,h=1;return d/o}e.extend(e.binomial,{pdf:function(o,a,c){return c===0||c===1?a*c===o?1:0:e.combination(a,o)*r.pow(c,o)*r.pow(1-c,a-o)},cdf:function(o,a,c){var f,p=1e-10;if(o<0)return 0;if(o>=a)return 1;if(c<0||c>1||a<=0)return NaN;o=r.floor(o);var d=c,h=o+1,v=a-o,E=h+v,g=r.exp(e.gammaln(E)-e.gammaln(v)-e.gammaln(h)+h*r.log(d)+v*r.log(1-d));return d<(h+1)/(E+2)?f=g*n(d,h,v,p):f=1-g*n(1-d,v,h,p),r.round((1-f)*(1/p))/(1/p)}}),e.extend(e.negbin,{pdf:function(o,a,c){return o!==o>>>0?!1:o<0?0:e.combination(o+a-1,a-1)*r.pow(1-c,o)*r.pow(c,a)},cdf:function(o,a,c){var f=0,p=0;if(o<0)return 0;for(;p<=o;p++)f+=e.negbin.pdf(p,a,c);return f}}),e.extend(e.hypgeom,{pdf:function(o,a,c,f){if(o!==o|0)return!1;if(o<0||o<c-(a-f))return 0;if(o>f||o>c)return 0;if(c*2>a)return f*2>a?e.hypgeom.pdf(a-c-f+o,a,a-c,a-f):e.hypgeom.pdf(f-o,a,a-c,f);if(f*2>a)return e.hypgeom.pdf(c-o,a,c,a-f);if(c<f)return e.hypgeom.pdf(o,a,f,c);for(var p=1,d=0,h=0;h<o;h++){for(;p>1&&d<f;)p*=1-c/(a-d),d++;p*=(f-h)*(c-h)/((h+1)*(a-c-f+h+1))}for(;d<f;d++)p*=1-c/(a-d);return r.min(1,r.max(0,p))},cdf:function(o,a,c,f){if(o<0||o<c-(a-f))return 0;if(o>=f||o>=c)return 1;if(c*2>a)return f*2>a?e.hypgeom.cdf(a-c-f+o,a,a-c,a-f):1-e.hypgeom.cdf(f-o-1,a,a-c,f);if(f*2>a)return 1-e.hypgeom.cdf(c-o-1,a,c,a-f);if(c<f)return e.hypgeom.cdf(o,a,f,c);for(var p=1,d=1,h=0,v=0;v<o;v++){for(;p>1&&h<f;){var E=1-c/(a-h);d*=E,p*=E,h++}d*=(f-v)*(c-v)/((v+1)*(a-c-f+v+1)),p+=d}for(;h<f;h++)p*=1-c/(a-h);return r.min(1,r.max(0,p))}}),e.extend(e.poisson,{pdf:function(o,a){return a<0||o%1!=0||o<0?0:r.pow(a,o)*r.exp(-a)/e.factorial(o)},cdf:function(o,a){var c=[],f=0;if(o<0)return 0;for(;f<=o;f++)c.push(e.poisson.pdf(f,a));return e.sum(c)},mean:function(u){return u},variance:function(u){return u},sampleSmall:function(o){var a=1,c=0,f=r.exp(-o);do c++,a*=e._random_fn();while(a>f);return c-1},sampleLarge:function(o){var a=o,c,f,p,d,h,v,E,g,m,T;for(d=r.sqrt(a),h=r.log(a),E=.931+2.53*d,v=-.059+.02483*E,g=1.1239+1.1328/(E-3.4),m=.9277-3.6224/(E-2);;){if(f=r.random()-.5,p=r.random(),T=.5-r.abs(f),c=r.floor((2*v/T+E)*f+a+.43),T>=.07&&p<=m)return c;if(!(c<0||T<.013&&p>T)&&r.log(p)+r.log(g)-r.log(v/(T*T)+E)<=-a+c*h-e.loggam(c+1))return c}},sample:function(o){return o<10?this.sampleSmall(o):this.sampleLarge(o)}}),e.extend(e.triangular,{pdf:function(o,a,c,f){return c<=a||f<a||f>c?NaN:o<a||o>c?0:o<f?2*(o-a)/((c-a)*(f-a)):o===f?2/(c-a):2*(c-o)/((c-a)*(c-f))},cdf:function(o,a,c,f){return c<=a||f<a||f>c?NaN:o<=a?0:o>=c?1:o<=f?r.pow(o-a,2)/((c-a)*(f-a)):1-r.pow(c-o,2)/((c-a)*(c-f))},inv:function(o,a,c,f){return c<=a||f<a||f>c?NaN:o<=(f-a)/(c-a)?a+(c-a)*r.sqrt(o*((f-a)/(c-a))):a+(c-a)*(1-r.sqrt((1-o)*(1-(f-a)/(c-a))))},mean:function(o,a,c){return(o+a+c)/3},median:function(o,a,c){if(c<=(o+a)/2)return a-r.sqrt((a-o)*(a-c))/r.sqrt(2);if(c>(o+a)/2)return o+r.sqrt((a-o)*(c-o))/r.sqrt(2)},mode:function(o,a,c){return c},sample:function(o,a,c){var f=e._random_fn();return f<(c-o)/(a-o)?o+r.sqrt(f*(a-o)*(c-o)):a-r.sqrt((1-f)*(a-o)*(a-c))},variance:function(o,a,c){return(o*o+a*a+c*c-o*a-o*c-a*c)/18}}),e.extend(e.arcsine,{pdf:function(o,a,c){return c<=a?NaN:o<=a||o>=c?0:2/r.PI*r.pow(r.pow(c-a,2)-r.pow(2*o-a-c,2),-.5)},cdf:function(o,a,c){return o<a?0:o<c?2/r.PI*r.asin(r.sqrt((o-a)/(c-a))):1},inv:function(u,o,a){return o+(.5-.5*r.cos(r.PI*u))*(a-o)},mean:function(o,a){return a<=o?NaN:(o+a)/2},median:function(o,a){return a<=o?NaN:(o+a)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(o,a){return(o+a)/2+(a-o)/2*r.sin(2*r.PI*e.uniform.sample(0,1))},variance:function(o,a){return a<=o?NaN:r.pow(a-o,2)/8}});function i(u){return u/r.abs(u)}e.extend(e.laplace,{pdf:function(o,a,c){return c<=0?0:r.exp(-r.abs(o-a)/c)/(2*c)},cdf:function(o,a,c){return c<=0?0:o<a?.5*r.exp((o-a)/c):1-.5*r.exp(-(o-a)/c)},mean:function(u){return u},median:function(u){return u},mode:function(u){return u},variance:function(u,o){return 2*o*o},sample:function(o,a){var c=e._random_fn()-.5;return o-a*i(c)*r.log(1-2*r.abs(c))}});function s(u,o,a){var c=12,f=6,p=-30,d=-50,h=60,v=8,E=3,g=2,m=3,T=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],A=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],N=u*.5;if(N>=v)return 1;var R=2*e.normal.cdf(N,0,1,1,0)-1;R>=r.exp(d/a)?R=r.pow(R,a):R=0;var y;u>E?y=g:y=m;for(var O=N,_=(v-N)/y,U=O+_,S=0,B=a-1,K=1;K<=y;K++){for(var W=0,F=.5*(U+O),fe=.5*(U-O),Be=1;Be<=c;Be++){var We,nt;f<Be?(We=c-Be+1,nt=T[We-1]):(We=Be,nt=-T[We-1]);var Qe=fe*nt,ke=F+Qe,Tt=ke*ke;if(Tt>h)break;var $t=2*e.normal.cdf(ke,0,1,1,0),rr=2*e.normal.cdf(ke,u,1,1,0),Pe=$t*.5-rr*.5;Pe>=r.exp(p/B)&&(Pe=A[We-1]*r.exp(-(.5*Tt))*r.pow(Pe,B),W+=Pe)}W*=2*fe*a/r.sqrt(2*r.PI),S+=W,O=U,U+=_}return R+=S,R<=r.exp(p/o)?0:(R=r.pow(R,o),R>=1?1:R)}function l(u,o,a){var c=.322232421088,f=.099348462606,p=-1,d=.588581570495,h=-.342242088547,v=.531103462366,E=-.204231210125,g=.10353775285,m=-453642210148e-16,T=.0038560700634,A=.8832,N=.2368,R=1.214,y=1.208,O=1.4142,_=120,U=.5-.5*u,S=r.sqrt(r.log(1/(U*U))),B=S+((((S*m+E)*S+h)*S+p)*S+c)/((((S*T+g)*S+v)*S+d)*S+f);a<_&&(B+=(B*B*B+B)/a/4);var K=A-N*B;return a<_&&(K+=-R/a+y*B/a),B*(K*r.log(o-1)+O)}e.extend(e.tukey,{cdf:function(o,a,c){var f=1,p=a,d=16,h=8,v=-30,E=1e-14,g=100,m=800,T=5e3,A=25e3,N=1,R=.5,y=.25,O=.125,_=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],U=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(o<=0)return 0;if(c<2||f<1||p<2)return NaN;if(!Number.isFinite(o))return 1;if(c>A)return s(o,f,p);var S=c*.5,B=S*r.log(c)-c*r.log(2)-e.gammaln(S),K=S-1,W=c*.25,F;c<=g?F=N:c<=m?F=R:c<=T?F=y:F=O,B+=r.log(F);for(var fe=0,Be=1;Be<=50;Be++){for(var We=0,nt=(2*Be-1)*F,Qe=1;Qe<=d;Qe++){var ke,Tt;h<Qe?(ke=Qe-h-1,Tt=B+K*r.log(nt+_[ke]*F)-(_[ke]*F+nt)*W):(ke=Qe-1,Tt=B+K*r.log(nt-_[ke]*F)+(_[ke]*F-nt)*W);var $t;if(Tt>=v){h<Qe?$t=o*r.sqrt((_[ke]*F+nt)*.5):$t=o*r.sqrt((-(_[ke]*F)+nt)*.5);var rr=s($t,f,p),Pe=rr*U[ke]*r.exp(Tt);We+=Pe}}if(Be*F>=1&&We<=E)break;fe+=We}if(We>E)throw new Error("tukey.cdf failed to converge");return fe>1&&(fe=1),fe},inv:function(u,o,a){var c=1,f=o,p=1e-4,d=50;if(a<2||c<1||f<2)return NaN;if(u<0||u>1)return NaN;if(u===0)return 0;if(u===1)return 1/0;var h=l(u,f,a),v=e.tukey.cdf(h,o,a)-u,E;v>0?E=r.max(0,h-1):E=h+1;for(var g=e.tukey.cdf(E,o,a)-u,m,T=1;T<d;T++){m=E-g*(E-h)/(g-v),v=g,h=E,m<0&&(m=0,g=-u),g=e.tukey.cdf(m,o,a)-u,E=m;var A=r.abs(E-h);if(A<p)return m}throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,r){var n=Array.prototype.push,i=e.utils.isArray;function s(l){return i(l)||l instanceof e}e.extend({add:function(u,o){return s(o)?(s(o[0])||(o=[o]),e.map(u,function(a,c,f){return a+o[c][f]})):e.map(u,function(a){return a+o})},subtract:function(u,o){return s(o)?(s(o[0])||(o=[o]),e.map(u,function(a,c,f){return a-o[c][f]||0})):e.map(u,function(a){return a-o})},divide:function(u,o){return s(o)?(s(o[0])||(o=[o]),e.multiply(u,e.inv(o))):e.map(u,function(a){return a/o})},multiply:function(u,o){var a,c,f,p,d,h,v,E;if(u.length===void 0&&o.length===void 0)return u*o;if(d=u.length,h=u[0].length,v=e.zeros(d,f=s(o)?o[0].length:h),E=0,s(o)){for(;E<f;E++)for(a=0;a<d;a++){for(p=0,c=0;c<h;c++)p+=u[a][c]*o[c][E];v[a][E]=p}return d===1&&E===1?v[0][0]:v}return e.map(u,function(g){return g*o})},outer:function(u,o){return e.multiply(u.map(function(a){return[a]}),[o])},dot:function(u,o){s(u[0])||(u=[u]),s(o[0])||(o=[o]);for(var a=u[0].length===1&&u.length!==1?e.transpose(u):u,c=o[0].length===1&&o.length!==1?e.transpose(o):o,f=[],p=0,d=a.length,h=a[0].length,v,E;p<d;p++){for(f[p]=[],v=0,E=0;E<h;E++)v+=a[p][E]*c[p][E];f[p]=v}return f.length===1?f[0]:f},pow:function(u,o){return e.map(u,function(a){return r.pow(a,o)})},exp:function(u){return e.map(u,function(o){return r.exp(o)})},log:function(u){return e.map(u,function(o){return r.log(o)})},abs:function(u){return e.map(u,function(o){return r.abs(o)})},norm:function(u,o){var a=0,c=0;for(isNaN(o)&&(o=2),s(u[0])&&(u=u[0]);c<u.length;c++)a+=r.pow(r.abs(u[c]),o);return r.pow(a,1/o)},angle:function(u,o){return r.acos(e.dot(u,o)/(e.norm(u)*e.norm(o)))},aug:function(u,o){var a=[],c;for(c=0;c<u.length;c++)a.push(u[c].slice());for(c=0;c<a.length;c++)n.apply(a[c],o[c]);return a},inv:function(u){for(var o=u.length,a=u[0].length,c=e.identity(o,a),f=e.gauss_jordan(u,c),p=[],d=0,h;d<o;d++)for(p[d]=[],h=a;h<f[0].length;h++)p[d][h-a]=f[d][h];return p},det:function(u){var o=u.length,a=o*2,c=new Array(a),f=o-1,p=a-1,d=f-o+1,h=p,v=0,E=0,g;if(o===2)return u[0][0]*u[1][1]-u[0][1]*u[1][0];for(;v<a;v++)c[v]=1;for(v=0;v<o;v++){for(g=0;g<o;g++)c[d<0?d+o:d]*=u[v][g],c[h<o?h+o:h]*=u[v][g],d++,h--;d=--f-o+1,h=--p}for(v=0;v<o;v++)E+=c[v];for(;v<a;v++)E-=c[v];return E},gauss_elimination:function(u,o){var a=0,c=0,f=u.length,p=u[0].length,d=1,h=0,v=[],E,g,m,T;for(u=e.aug(u,o),E=u[0].length,a=0;a<f;a++){for(g=u[a][a],c=a,T=a+1;T<p;T++)g<r.abs(u[T][a])&&(g=u[T][a],c=T);if(c!=a)for(T=0;T<E;T++)m=u[a][T],u[a][T]=u[c][T],u[c][T]=m;for(c=a+1;c<f;c++)for(d=u[c][a]/u[a][a],T=a;T<E;T++)u[c][T]=u[c][T]-d*u[a][T]}for(a=f-1;a>=0;a--){for(h=0,c=a+1;c<=f-1;c++)h=h+v[c]*u[a][c];v[a]=(u[a][E-1]-h)/u[a][a]}return v},gauss_jordan:function(u,o){var a=e.aug(u,o),c=a.length,f=a[0].length,p=0,d,h,v;for(h=0;h<c;h++){var E=h;for(v=h+1;v<c;v++)r.abs(a[v][h])>r.abs(a[E][h])&&(E=v);var g=a[h];for(a[h]=a[E],a[E]=g,v=h+1;v<c;v++)for(p=a[v][h]/a[h][h],d=h;d<f;d++)a[v][d]-=a[h][d]*p}for(h=c-1;h>=0;h--){for(p=a[h][h],v=0;v<h;v++)for(d=f-1;d>h-1;d--)a[v][d]-=a[h][d]*a[v][h]/p;for(a[h][h]/=p,d=c;d<f;d++)a[h][d]/=p}return a},triaUpSolve:function(u,o){var a=u[0].length,c=e.zeros(1,a)[0],f,p=!1;return o[0].length!=null&&(o=o.map(function(d){return d[0]}),p=!0),e.arange(a-1,-1,-1).forEach(function(d){f=e.arange(d+1,a).map(function(h){return c[h]*u[d][h]}),c[d]=(o[d]-e.sum(f))/u[d][d]}),p?c.map(function(d){return[d]}):c},triaLowSolve:function(u,o){var a=u[0].length,c=e.zeros(1,a)[0],f,p=!1;return o[0].length!=null&&(o=o.map(function(d){return d[0]}),p=!0),e.arange(a).forEach(function(d){f=e.arange(d).map(function(h){return u[d][h]*c[h]}),c[d]=(o[d]-e.sum(f))/u[d][d]}),p?c.map(function(d){return[d]}):c},lu:function(u){var o=u.length,a=e.identity(o),c=e.zeros(u.length,u[0].length),f;return e.arange(o).forEach(function(p){c[0][p]=u[0][p]}),e.arange(1,o).forEach(function(p){e.arange(p).forEach(function(d){f=e.arange(d).map(function(h){return a[p][h]*c[h][d]}),a[p][d]=(u[p][d]-e.sum(f))/c[d][d]}),e.arange(p,o).forEach(function(d){f=e.arange(p).map(function(h){return a[p][h]*c[h][d]}),c[p][d]=u[f.length][d]-e.sum(f)})}),[a,c]},cholesky:function(u){var o=u.length,a=e.zeros(u.length,u[0].length),c;return e.arange(o).forEach(function(f){c=e.arange(f).map(function(p){return r.pow(a[f][p],2)}),a[f][f]=r.sqrt(u[f][f]-e.sum(c)),e.arange(f+1,o).forEach(function(p){c=e.arange(f).map(function(d){return a[f][d]*a[p][d]}),a[p][f]=(u[f][p]-e.sum(c))/a[f][f]})}),a},gauss_jacobi:function(u,o,a,c){for(var f=0,p=0,d=u.length,h=[],v=[],E=[],g,m,T,A;f<d;f++)for(h[f]=[],v[f]=[],E[f]=[],p=0;p<d;p++)f>p?(h[f][p]=u[f][p],v[f][p]=E[f][p]=0):f<p?(v[f][p]=u[f][p],h[f][p]=E[f][p]=0):(E[f][p]=u[f][p],h[f][p]=v[f][p]=0);for(T=e.multiply(e.multiply(e.inv(E),e.add(h,v)),-1),m=e.multiply(e.inv(E),o),g=a,A=e.add(e.multiply(T,a),m),f=2;r.abs(e.norm(e.subtract(A,g)))>c;)g=A,A=e.add(e.multiply(T,g),m),f++;return A},gauss_seidel:function(u,o,a,c){for(var f=0,p=u.length,d=[],h=[],v=[],E,g,m,T,A;f<p;f++)for(d[f]=[],h[f]=[],v[f]=[],E=0;E<p;E++)f>E?(d[f][E]=u[f][E],h[f][E]=v[f][E]=0):f<E?(h[f][E]=u[f][E],d[f][E]=v[f][E]=0):(v[f][E]=u[f][E],d[f][E]=h[f][E]=0);for(T=e.multiply(e.multiply(e.inv(e.add(v,d)),h),-1),m=e.multiply(e.inv(e.add(v,d)),o),g=a,A=e.add(e.multiply(T,a),m),f=2;r.abs(e.norm(e.subtract(A,g)))>c;)g=A,A=e.add(e.multiply(T,g),m),f=f+1;return A},SOR:function(u,o,a,c,f){for(var p=0,d=u.length,h=[],v=[],E=[],g,m,T,A,N;p<d;p++)for(h[p]=[],v[p]=[],E[p]=[],g=0;g<d;g++)p>g?(h[p][g]=u[p][g],v[p][g]=E[p][g]=0):p<g?(v[p][g]=u[p][g],h[p][g]=E[p][g]=0):(E[p][g]=u[p][g],h[p][g]=v[p][g]=0);for(A=e.multiply(e.inv(e.add(E,e.multiply(h,f))),e.subtract(e.multiply(E,1-f),e.multiply(v,f))),T=e.multiply(e.multiply(e.inv(e.add(E,e.multiply(h,f))),o),f),m=a,N=e.add(e.multiply(A,a),T),p=2;r.abs(e.norm(e.subtract(N,m)))>c;)m=N,N=e.add(e.multiply(A,m),T),p++;return N},householder:function(u){for(var o=u.length,a=u[0].length,c=0,f=[],p=[],d,h,v,E,g;c<o-1;c++){for(d=0,E=c+1;E<a;E++)d+=u[E][c]*u[E][c];for(g=u[c+1][c]>0?-1:1,d=g*r.sqrt(d),h=r.sqrt((d*d-u[c+1][c]*d)/2),f=e.zeros(o,1),f[c+1][0]=(u[c+1][c]-d)/(2*h),v=c+2;v<o;v++)f[v][0]=u[v][c]/(2*h);p=e.subtract(e.identity(o,a),e.multiply(e.multiply(f,e.transpose(f)),2)),u=e.multiply(p,e.multiply(u,p))}return u},QR:function(){var l=e.sum,u=e.arange;function o(a){var c=a.length,f=a[0].length,p=e.zeros(f,f);a=e.copy(a);var d,h,v;for(h=0;h<f;h++){for(p[h][h]=r.sqrt(l(u(c).map(function(E){return a[E][h]*a[E][h]}))),d=0;d<c;d++)a[d][h]=a[d][h]/p[h][h];for(v=h+1;v<f;v++)for(p[h][v]=l(u(c).map(function(E){return a[E][h]*a[E][v]})),d=0;d<c;d++)a[d][v]=a[d][v]-a[d][h]*p[h][v]}return[a,p]}return o}(),lstsq:function(){function l(o){o=e.copy(o);var a=o.length,c=e.identity(a);return e.arange(a-1,-1,-1).forEach(function(f){e.sliceAssign(c,{row:f},e.divide(e.slice(c,{row:f}),o[f][f])),e.sliceAssign(o,{row:f},e.divide(e.slice(o,{row:f}),o[f][f])),e.arange(f).forEach(function(p){var d=e.multiply(o[p][f],-1),h=e.slice(o,{row:p}),v=e.multiply(e.slice(o,{row:f}),d);e.sliceAssign(o,{row:p},e.add(h,v));var E=e.slice(c,{row:p}),g=e.multiply(e.slice(c,{row:f}),d);e.sliceAssign(c,{row:p},e.add(E,g))})}),c}function u(o,a){var c=!1;a[0].length===void 0&&(a=a.map(function(A){return[A]}),c=!0);var f=e.QR(o),p=f[0],d=f[1],h=o[0].length,v=e.slice(p,{col:{end:h}}),E=e.slice(d,{row:{end:h}}),g=l(E),m=e.transpose(v);m[0].length===void 0&&(m=[m]);var T=e.multiply(e.multiply(g,m),a);return T.length===void 0&&(T=[[T]]),c?T.map(function(A){return A[0]}):T}return u}(),jacobi:function(u){for(var o=1,a=u.length,c=e.identity(a,a),f=[],p,d,h,v,E,g,m,T;o===1;){for(g=u[0][1],v=0,E=1,d=0;d<a;d++)for(h=0;h<a;h++)d!=h&&g<r.abs(u[d][h])&&(g=r.abs(u[d][h]),v=d,E=h);for(u[v][v]===u[E][E]?m=u[v][E]>0?r.PI/4:-r.PI/4:m=r.atan(2*u[v][E]/(u[v][v]-u[E][E]))/2,T=e.identity(a,a),T[v][v]=r.cos(m),T[v][E]=-r.sin(m),T[E][v]=r.sin(m),T[E][E]=r.cos(m),c=e.multiply(c,T),p=e.multiply(e.multiply(e.inv(T),u),T),u=p,o=0,d=1;d<a;d++)for(h=1;h<a;h++)d!=h&&r.abs(u[d][h])>.001&&(o=1)}for(d=0;d<a;d++)f.push(u[d][d]);return[c,f]},rungekutta:function(u,o,a,c,f,p){var d,h,v,E,g;if(p===2)for(;c<=a;)d=o*u(c,f),h=o*u(c+o,f+d),v=f+(d+h)/2,f=v,c=c+o;if(p===4)for(;c<=a;)d=o*u(c,f),h=o*u(c+o/2,f+d/2),E=o*u(c+o/2,f+h/2),g=o*u(c+o,f+E),v=f+(d+2*h+2*E+g)/6,f=v,c=c+o;return f},romberg:function(u,o,a,c){for(var f=0,p=(a-o)/2,d=[],h=[],v=[],E,g,m,T,A;f<c/2;){for(A=u(o),m=o,T=0;m<=a;m=m+p,T++)d[T]=m;for(E=d.length,m=1;m<E-1;m++)A+=(m%2!=0?4:2)*u(d[m]);A=p/3*(A+u(a)),v[f]=A,p/=2,f++}for(g=v.length,E=1;g!==1;){for(m=0;m<g-1;m++)h[m]=(r.pow(4,E)*v[m+1]-v[m])/(r.pow(4,E)-1);g=h.length,v=h,h=[],E++}return v},richardson:function(u,o,a,c){function f(N,R){for(var y=0,O=N.length,_;y<O;y++)N[y]===R&&(_=y);return _}for(var p=r.abs(a-u[f(u,a)+1]),d=0,h=[],v=[],E,g,m,T,A;c>=p;)E=f(u,a+c),g=f(u,a),h[d]=(o[E]-2*o[g]+o[2*g-E])/(c*c),c/=2,d++;for(T=h.length,m=1;T!=1;){for(A=0;A<T-1;A++)v[A]=(r.pow(4,m)*h[A+1]-h[A])/(r.pow(4,m)-1);T=v.length,h=v,v=[],m++}return h},simpson:function(u,o,a,c){for(var f=(a-o)/c,p=u(o),d=[],h=o,v=0,E=1,g;h<=a;h=h+f,v++)d[v]=h;for(g=d.length;E<g-1;E++)p+=(E%2!=0?4:2)*u(d[E]);return f/3*(p+u(a))},hermite:function(u,o,a,c){for(var f=u.length,p=0,d=0,h=[],v=[],E=[],g=[],m;d<f;d++){for(h[d]=1,m=0;m<f;m++)d!=m&&(h[d]*=(c-u[m])/(u[d]-u[m]));for(v[d]=0,m=0;m<f;m++)d!=m&&(v[d]+=1/(u[d]-u[m]));E[d]=(1-2*(c-u[d])*v[d])*(h[d]*h[d]),g[d]=(c-u[d])*(h[d]*h[d]),p+=E[d]*o[d]+g[d]*a[d]}return p},lagrange:function(u,o,a){for(var c=0,f=0,p,d,h=u.length;f<h;f++){for(d=o[f],p=0;p<h;p++)f!=p&&(d*=(a-u[p])/(u[f]-u[p]));c+=d}return c},cubic_spline:function(u,o,a){for(var c=u.length,f=0,p,d=[],h=[],v=[],E=[],g=[],m=[],T=[];f<c-1;f++)g[f]=u[f+1]-u[f];for(v[0]=0,f=1;f<c-1;f++)v[f]=3/g[f]*(o[f+1]-o[f])-3/g[f-1]*(o[f]-o[f-1]);for(f=1;f<c-1;f++)d[f]=[],h[f]=[],d[f][f-1]=g[f-1],d[f][f]=2*(g[f-1]+g[f]),d[f][f+1]=g[f],h[f][0]=v[f];for(E=e.multiply(e.inv(d),h),p=0;p<c-1;p++)m[p]=(o[p+1]-o[p])/g[p]-g[p]*(E[p+1][0]+2*E[p][0])/3,T[p]=(E[p+1][0]-E[p][0])/(3*g[p]);for(p=0;p<c&&!(u[p]>a);p++);return p-=1,o[p]+(a-u[p])*m[p]+e.sq(a-u[p])*E[p]+(a-u[p])*e.sq(a-u[p])*T[p]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(u){var o=u.length,a=u[0].length,c=0,f,p,d=[],h=[],v=[],E=[],g=[],m=[],T=[],A=[],N=[],R=[];for(c=0;c<o;c++)d[c]=e.sum(u[c])/a;for(c=0;c<a;c++)for(T[c]=[],f=0;f<o;f++)T[c][f]=u[f][c]-d[f];for(T=e.transpose(T),c=0;c<o;c++)for(A[c]=[],f=0;f<o;f++)A[c][f]=e.dot([T[c]],[T[f]])/(a-1);for(v=e.jacobi(A),N=v[0],h=v[1],R=e.transpose(N),c=0;c<h.length;c++)for(f=c;f<h.length;f++)h[c]<h[f]&&(p=h[c],h[c]=h[f],h[f]=p,E=R[c],R[c]=R[f],R[f]=E);for(m=e.transpose(T),c=0;c<o;c++)for(g[c]=[],f=0;f<m.length;f++)g[c][f]=e.dot([R[c]],[m[f]]);return[u,h,R,g]}}),function(l){for(var u=0;u<l.length;u++)(function(o){e.fn[o]=function(a,c){var f=this;return c?(setTimeout(function(){c.call(f,e.fn[o].call(f,a))},15),this):typeof e[o](this,a)=="number"?e[o](this,a):e(e[o](this,a))}})(l[u])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,r){var n=[].slice,i=e.utils.isNumber,s=e.utils.isArray;e.extend({zscore:function(){var o=n.call(arguments);return i(o[1])?(o[0]-o[1])/o[2]:(o[0]-e.mean(o[1]))/e.stdev(o[1],o[2])},ztest:function(){var o=n.call(arguments),a;return s(o[1])?(a=e.zscore(o[0],o[1],o[3]),o[2]===1?e.normal.cdf(-r.abs(a),0,1):e.normal.cdf(-r.abs(a),0,1)*2):o.length>2?(a=e.zscore(o[0],o[1],o[2]),o[3]===1?e.normal.cdf(-r.abs(a),0,1):e.normal.cdf(-r.abs(a),0,1)*2):(a=o[0],o[1]===1?e.normal.cdf(-r.abs(a),0,1):e.normal.cdf(-r.abs(a),0,1)*2)}}),e.extend(e.fn,{zscore:function(o,a){return(o-this.mean())/this.stdev(a)},ztest:function(o,a,c){var f=r.abs(this.zscore(o,c));return a===1?e.normal.cdf(-f,0,1):e.normal.cdf(-f,0,1)*2}}),e.extend({tscore:function(){var o=n.call(arguments);return o.length===4?(o[0]-o[1])/(o[2]/r.sqrt(o[3])):(o[0]-e.mean(o[1]))/(e.stdev(o[1],!0)/r.sqrt(o[1].length))},ttest:function(){var o=n.call(arguments),a;return o.length===5?(a=r.abs(e.tscore(o[0],o[1],o[2],o[3])),o[4]===1?e.studentt.cdf(-a,o[3]-1):e.studentt.cdf(-a,o[3]-1)*2):i(o[1])?(a=r.abs(o[0]),o[2]==1?e.studentt.cdf(-a,o[1]-1):e.studentt.cdf(-a,o[1]-1)*2):(a=r.abs(e.tscore(o[0],o[1])),o[2]==1?e.studentt.cdf(-a,o[1].length-1):e.studentt.cdf(-a,o[1].length-1)*2)}}),e.extend(e.fn,{tscore:function(o){return(o-this.mean())/(this.stdev(!0)/r.sqrt(this.cols()))},ttest:function(o,a){return a===1?1-e.studentt.cdf(r.abs(this.tscore(o)),this.cols()-1):e.studentt.cdf(-r.abs(this.tscore(o)),this.cols()-1)*2}}),e.extend({anovafscore:function(){var o=n.call(arguments),a,c,f,p,d,h,v,E;if(o.length===1){for(d=new Array(o[0].length),v=0;v<o[0].length;v++)d[v]=o[0][v];o=d}for(c=new Array,v=0;v<o.length;v++)c=c.concat(o[v]);for(f=e.mean(c),a=0,v=0;v<o.length;v++)a=a+o[v].length*r.pow(e.mean(o[v])-f,2);for(a/=o.length-1,h=0,v=0;v<o.length;v++)for(p=e.mean(o[v]),E=0;E<o[v].length;E++)h+=r.pow(o[v][E]-p,2);return h/=c.length-o.length,a/h},anovaftest:function(){var o=n.call(arguments),a,c,f,p;if(i(o[0]))return 1-e.centralF.cdf(o[0],o[1],o[2]);var d=e.anovafscore(o);for(a=o.length-1,f=0,p=0;p<o.length;p++)f=f+o[p].length;return c=f-a-1,1-e.centralF.cdf(d,a,c)},ftest:function(o,a,c){return 1-e.centralF.cdf(o,a,c)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var o=0,a;for(a=0;a<this.length;a++)o=o+this[a].length;return e.ftest(this.anovafscore(),this.length-1,o-this.length)}}),e.extend({qscore:function(){var o=n.call(arguments),a,c,f,p,d;return i(o[0])?(a=o[0],c=o[1],f=o[2],p=o[3],d=o[4]):(a=e.mean(o[0]),c=e.mean(o[1]),f=o[0].length,p=o[1].length,d=o[2]),r.abs(a-c)/(d*r.sqrt((1/f+1/p)/2))},qtest:function(){var o=n.call(arguments),a;o.length===3?(a=o[0],o=o.slice(1)):o.length===7?(a=e.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(a=e.qscore(o[0],o[1],o[2]),o=o.slice(3));var c=o[0],f=o[1];return 1-e.tukey.cdf(a,f,c-f)},tukeyhsd:function(o){for(var a=e.pooledstdev(o),c=o.map(function(E){return e.mean(E)}),f=o.reduce(function(E,g){return E+g.length},0),p=[],d=0;d<o.length;++d)for(var h=d+1;h<o.length;++h){var v=e.qtest(c[d],c[h],o[d].length,o[h].length,a,f,o.length);p.push([[d,h],v])}return p}}),e.extend({normalci:function(){var o=n.call(arguments),a=new Array(2),c;return o.length===4?c=r.abs(e.normal.inv(o[1]/2,0,1)*o[2]/r.sqrt(o[3])):c=r.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/r.sqrt(o[2].length)),a[0]=o[0]-c,a[1]=o[0]+c,a},tci:function(){var o=n.call(arguments),a=new Array(2),c;return o.length===4?c=r.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/r.sqrt(o[3])):c=r.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/r.sqrt(o[2].length)),a[0]=o[0]-c,a[1]=o[0]+c,a},significant:function(o,a){return o<a}}),e.extend(e.fn,{normalci:function(o,a){return e.normalci(o,a,this.toArray())},tci:function(o,a){return e.tci(o,a,this.toArray())}});function l(u,o,a,c){if(u>1||a>1||u<=0||a<=0)throw new Error("Proportions should be greater than 0 and less than 1");var f=(u*o+a*c)/(o+c),p=r.sqrt(f*(1-f)*(1/o+1/c));return(u-a)/p}e.extend(e.fn,{oneSidedDifferenceOfProportions:function(o,a,c,f){var p=l(o,a,c,f);return e.ztest(p,1)},twoSidedDifferenceOfProportions:function(o,a,c,f){var p=l(o,a,c,f);return e.ztest(p,2)}})}(t,Math),t.models=function(){function e(l){var u=l[0].length,o=t.arange(u).map(function(a){var c=t.arange(u).filter(function(f){return f!==a});return r(t.col(l,a).map(function(f){return f[0]}),t.col(l,c))});return o}function r(l,u){var o=l.length,a=u[0].length-1,c=o-a-1,f=t.lstsq(u,l),p=t.multiply(u,f.map(function(T){return[T]})).map(function(T){return T[0]}),d=t.subtract(l,p),h=t.mean(l),v=t.sum(p.map(function(T){return Math.pow(T-h,2)})),E=t.sum(l.map(function(T,A){return Math.pow(T-p[A],2)})),g=v+E,m=v/g;return{exog:u,endog:l,nobs:o,df_model:a,df_resid:c,coef:f,predict:p,resid:d,ybar:h,SST:g,SSE:v,SSR:E,R2:m}}function n(l){var u=e(l.exog),o=Math.sqrt(l.SSR/l.df_resid),a=u.map(function(h){var v=h.SST,E=h.R2;return o/Math.sqrt(v*(1-E))}),c=l.coef.map(function(h,v){return(h-0)/a[v]}),f=c.map(function(h){var v=t.studentt.cdf(h,l.df_resid);return(v>.5?1-v:v)*2}),p=t.studentt.inv(.975,l.df_resid),d=l.coef.map(function(h,v){var E=p*a[v];return[h-E,h+E]});return{se:a,t:c,p:f,sigmaHat:o,interval95:d}}function i(l){var u=l.R2/l.df_model/((1-l.R2)/l.df_resid),o=function(c,f,p){return t.beta.cdf(c/(p/f+c),f/2,p/2)},a=1-o(u,l.df_model,l.df_resid);return{F_statistic:u,pvalue:a}}function s(l,u){var o=r(l,u),a=n(o),c=i(o),f=1-(1-o.R2)*((o.nobs-1)/o.df_resid);return o.t=a,o.f=c,o.adjust_R2=f,o}return{ols:s}}(),t.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),n=0;n<arguments.length;n++){var i=[1];r[n]=i.concat(arguments[n])}return t(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),n=0;n<arguments[0].length;n++){var i=[1];r[n]=i.concat(arguments[0][n])}return t(r)},buildjxmatrix:function(r){for(var n=new Array(r.length),i=0;i<r.length;i++)n[i]=r[i];return t.builddxmatrix(n)},buildymatrix:function(r){return t(r).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(r,n){var i,s,l,u,o;if(r.cols()==n.rows()){if(n.rows()>1){for(u=[],i=0;i<r.rows();i++)for(u[i]=[],s=0;s<n.cols();s++){for(o=0,l=0;l<r.cols();l++)o+=r.toArray()[i][l]*n.toArray()[l][s];u[i][s]=o}return t(u)}for(u=[],i=0;i<r.rows();i++)for(u[i]=[],s=0;s<n.cols();s++){for(o=0,l=0;l<r.cols();l++)o+=r.toArray()[i][l]*n.toArray()[s];u[i][s]=o}return t(u)}},regress:function(r,n){var i=t.xtranspxinv(r),s=r.transpose(),l=t.matrixmult(t(i),s);return t.matrixmult(l,n)},regresst:function(r,n,i){var s=t.regress(r,n),l={};l.anova={};var u=t.jMatYBar(r,s);l.yBar=u;var o=n.mean();l.anova.residuals=t.residuals(n,u),l.anova.ssr=t.ssr(u,o),l.anova.msr=l.anova.ssr/(r[0].length-1),l.anova.sse=t.sse(n,u),l.anova.mse=l.anova.sse/(n.length-(r[0].length-1)-1),l.anova.sst=t.sst(n,o),l.anova.mst=l.anova.sst/(n.length-1),l.anova.r2=1-l.anova.sse/l.anova.sst,l.anova.r2<0&&(l.anova.r2=0),l.anova.fratio=l.anova.msr/l.anova.mse,l.anova.pvalue=t.anovaftest(l.anova.fratio,r[0].length-1,n.length-(r[0].length-1)-1),l.anova.rmse=Math.sqrt(l.anova.mse),l.anova.r2adj=1-l.anova.mse/l.anova.mst,l.anova.r2adj<0&&(l.anova.r2adj=0),l.stats=new Array(r[0].length);for(var a=t.xtranspxinv(r),c,f,p,d=0;d<s.length;d++)c=Math.sqrt(l.anova.mse*Math.abs(a[d][d])),f=Math.abs(s[d]/c),p=t.ttest(f,n.length-r[0].length-1,i),l.stats[d]=[s[d],c,f,p];return l.regress=s,l},xtranspx:function(r){return t.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var n=t.matrixmult(r.transpose(),r),i=t.inv(n);return i},jMatYBar:function(r,n){var i=t.matrixmult(r,n);return new t(i)},residuals:function(r,n){return t.matrixsubtract(r,n)},ssr:function(r,n){for(var i=0,s=0;s<r.length;s++)i+=Math.pow(r[s]-n,2);return i},sse:function(r,n){for(var i=0,s=0;s<r.length;s++)i+=Math.pow(r[s]-n[s],2);return i},sst:function(r,n){for(var i=0,s=0;s<r.length;s++)i+=Math.pow(r[s]-n,2);return i},matrixsubtract:function(r,n){for(var i=new Array(r.length),s=0;s<r.length;s++){i[s]=new Array(r[s].length);for(var l=0;l<r[s].length;l++)i[s][l]=r[s][l]-n[s][l]}return t(i)}}),t.jStat=t,t})});var iu=w((cR,nu)=>{var q=Oe(),dt=di(),{FormulaHelpers:gd,Types:V}=Ce(),G=gd,sn=eu(),ru=Ni(),Ed=536870911,md=-536870912,yi=511,un=-512,Rd=/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/,Td=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,Ad=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function de(t){t=G.accept(t);let e=0,r=0,n="i";if(typeof t=="number")return{real:t,im:r,unit:n};if(typeof t=="boolean")throw q.VALUE;let i=t.match(Rd);if(i)return e=Number(i[0]),{real:e,im:r,unit:n};if(i=t.match(Td),i)return r=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),n=i[0].slice(-1),{real:e,im:r,unit:n};if(i=t.match(Ad),i)return e=Number(i[1]),r=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),n=i[0].slice(-1),{real:e,im:r,unit:n};throw q.NUM}var z={BESSELI:(t,e)=>{if(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw q.NUM;return sn.besseli(t,e)},BESSELJ:(t,e)=>{if(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw q.NUM;return sn.besselj(t,e)},BESSELK:(t,e)=>{if(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw q.NUM;return sn.besselk(t,e)},BESSELY:(t,e)=>{if(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN),e=Math.trunc(e),e<0)throw q.NUM;return sn.bessely(t,e)},BIN2DEC:t=>{t=G.accept(t,V.NUMBER_NO_BOOLEAN);let e=t.toString();if(e.length>10)throw q.NUM;return e.length===10&&e.substring(0,1)==="1"?parseInt(e.substring(1),2)+un:parseInt(e,2)},BIN2HEX:(t,e)=>{t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN,null);let r=t.toString();if(r.length>10)throw q.NUM;if(r.length===10&&r.substring(0,1)==="1")return(parseInt(r.substring(1),2)+1099511627264).toString(16).toUpperCase();let n=parseInt(t,2).toString(16);if(e==null)return n.toUpperCase();if(e<0)throw q.NUM;if(e=Math.trunc(e),e>=n.length)return(dt.REPT("0",e-n.length)+n).toUpperCase();throw q.NUM},BIN2OCT:(t,e)=>{t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER,null);let r=t.toString();if(r.length>10)throw q.NUM;if(r.length===10&&r.substr(0,1)==="1")return(parseInt(r.substr(1),2)+1073741312).toString(8);let n=parseInt(t,2).toString(8);if(e==null)return n.toUpperCase();if(e<0)throw q.NUM;if(e=Math.trunc(e),e>=n.length)return dt.REPT("0",e-n.length)+n;throw q.NUM},BITAND:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>281474976710655||e>281474976710655)throw q.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER),e=Math.trunc(e),Math.abs(e)>53||t<0||Math.floor(t)!==t||t>281474976710655)throw q.NUM;let r=e>=0?t*2**e:Math.trunc(t/2**-e);if(r>281474976710655)throw q.NUM;return r},BITOR:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER),t<0||e<0||Math.floor(t)!==t||Math.floor(e)!==e||t>281474976710655||e>281474976710655)throw q.NUM;return t|e},BITRSHIFT:(t,e)=>(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER),z.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER),t<0||t>281474976710655||Math.floor(t)!==t||e<0||e>281474976710655||Math.floor(e)!==e)throw q.NUM;return t^e},COMPLEX:(t,e,r)=>{if(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN),r=G.accept(r,V.STRING,"i"),r!=="i"&&r!=="j")throw q.VALUE;if(t===0&&e===0)return 0;if(t===0)return e===1?r:e===-1?"-"+r:e.toString()+r;if(e===0)return t.toString();{let n=e>0?"+":"";return e===1?t.toString()+n+r:e===-1?t.toString()+n+"-"+r:t.toString()+n+e.toString()+r}},DEC2BIN:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER,null),t<un||t>yi)throw q.NUM;if(t<0)return"1"+dt.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let r=parseInt(t,10).toString(2);if(e==null)return r;if(e=Math.trunc(e),e<=0||e<r.length)throw q.NUM;return dt.REPT("0",e-r.length)+r},DEC2HEX:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER,null),t<-549755813888||t>549755813888)throw q.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let r=parseInt(t,10).toString(16);if(e==null)return r.toUpperCase();if(e=Math.trunc(e),e<=0||e<r.length)throw q.NUM;return dt.REPT("0",e-r.length)+r.toUpperCase()},DEC2OCT:(t,e)=>{if(t=G.accept(t,V.NUMBER),e=G.accept(e,V.NUMBER,null),t<-536870912||t>536870912)throw q.NUM;if(t<0)return(t+1073741824).toString(8);let r=parseInt(t,10).toString(8);if(e==null)return r.toUpperCase();if(e=Math.trunc(e),e<=0||e<r.length)throw q.NUM;return dt.REPT("0",e-r.length)+r},DELTA:(t,e)=>(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN,0),t===e?1:0),ERF:(t,e)=>(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN,0),ru.erf(t)),ERFC:t=>(t=G.accept(t,V.NUMBER_NO_BOOLEAN),ru.erfc(t)),GESTEP:(t,e)=>(t=G.accept(t,V.NUMBER_NO_BOOLEAN),e=G.accept(e,V.NUMBER_NO_BOOLEAN,0),t>=e?1:0),HEX2BIN:(t,e)=>{if(t=G.accept(t,V.STRING),e=G.accept(e,V.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw q.NUM;let r=t.length===10&&t.substr(0,1).toLowerCase()==="f",n=r?parseInt(t,16)-1099511627776:parseInt(t,16);if(n<un||n>yi)throw q.NUM;if(r)return"1"+dt.REPT("0",9-(n+512).toString(2).length)+(n+512).toString(2);let i=n.toString(2);if(e==null)return i;if(e=Math.trunc(e),e<=0||e<i.length)throw q.NUM;return dt.REPT("0",e-i.length)+i},HEX2DEC:t=>{if(t=G.accept(t,V.STRING),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw q.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if(t=G.accept(t,V.STRING),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw q.NUM;let r=z.HEX2DEC(t);if(r>Ed||r<md)throw q.NUM;return z.DEC2OCT(r,e)},IMABS:t=>{let{real:e,im:r}=de(t);return Math.sqrt(Math.pow(e,2)+Math.pow(r,2))},IMAGINARY:t=>de(t).im,IMARGUMENT:t=>{let{real:e,im:r}=de(t);if(e===0&&r===0)throw q.DIV0;return e===0&&r>0?Math.PI/2:e===0&&r<0?-Math.PI/2:e<0&&r===0?Math.PI:e>0&&r===0?0:e>0?Math.atan(r/e):e<0&&r>0?Math.atan(r/e)+Math.PI:Math.atan(r/e)-Math.PI},IMCONJUGATE:t=>{let{real:e,im:r,unit:n}=de(t);return r!==0?z.COMPLEX(e,-r,n):""+e},IMCOS:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.cos(e)*(Math.exp(r)+Math.exp(-r))/2,s=-Math.sin(e)*(Math.exp(r)-Math.exp(-r))/2;return z.COMPLEX(i,s,n)},IMCOSH:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.cos(r)*(Math.exp(e)+Math.exp(-e))/2,s=-Math.sin(r)*(Math.exp(e)-Math.exp(-e))/2;return z.COMPLEX(i,-s,n)},IMCOT:t=>{t=G.accept(t);let e=z.IMCOS(t),r=z.IMSIN(t);return z.IMDIV(e,r)},IMCSC:t=>(t=G.accept(t),z.IMDIV("1",z.IMSIN(t))),IMCSCH:t=>(t=G.accept(t),z.IMDIV("1",z.IMSINH(t))),IMDIV:(t,e)=>{let r=de(t),n=r.real,i=r.im,s=r.unit,l=de(e),u=l.real,o=l.im,a=l.unit;if(u===0&&o===0||s!==a)throw q.NUM;let c=s,f=Math.pow(u,2)+Math.pow(o,2);return z.COMPLEX((n*u+i*o)/f,(i*u-n*o)/f,c)},IMEXP:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.exp(e);return z.COMPLEX(i*Math.cos(r),i*Math.sin(r),n)},IMLN:t=>{let{real:e,im:r,unit:n}=de(t);return z.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),Math.atan(r/e),n)},IMLOG10:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(10),s=Math.atan(r/e)/Math.log(10);return z.COMPLEX(i,s,n)},IMLOG2:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(r,2)))/Math.log(2),s=Math.atan(r/e)/Math.log(2);return z.COMPLEX(i,s,n)},IMPOWER:(t,e)=>{let{unit:r}=de(t);e=G.accept(e,V.NUMBER_NO_BOOLEAN);let n=Math.pow(z.IMABS(t),e),i=z.IMARGUMENT(t),s=n*Math.cos(e*i),l=n*Math.sin(e*i);return z.COMPLEX(s,l,r)},IMPRODUCT:(...t)=>{let e,r=0;return G.flattenParams(t,null,!1,n=>{if(r===0)e=G.accept(n),de(e);else{let i=de(e),s=i.real,l=i.im,u=i.unit,o=de(n),a=o.real,c=o.im,f=o.unit;if(u!==f)throw q.VALUE;e=z.COMPLEX(s*a-l*c,s*c+l*a)}r++},1),e},IMREAL:t=>de(t).real,IMSEC:t=>z.IMDIV("1",z.IMCOS(t)),IMSECH:t=>z.IMDIV("1",z.IMCOSH(t)),IMSIN:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.sin(e)*(Math.exp(r)+Math.exp(-r))/2,s=Math.cos(e)*(Math.exp(r)-Math.exp(-r))/2;return z.COMPLEX(i,s,n)},IMSINH:t=>{let{real:e,im:r,unit:n}=de(t),i=Math.cos(r)*(Math.exp(e)-Math.exp(-e))/2,s=Math.sin(r)*(Math.exp(e)+Math.exp(-e))/2;return z.COMPLEX(i,s,n)},IMSQRT:t=>{let{unit:e}=de(t),r=Math.sqrt(z.IMABS(t)),n=z.IMARGUMENT(t);return z.COMPLEX(r*Math.cos(n/2),r*Math.sin(n/2),e)},IMSUB:(t,e)=>{let r=de(t),n=r.real,i=r.im,s=r.unit,l=de(e),u=l.real,o=l.im,a=l.unit;if(s!==a)throw q.VALUE;return z.COMPLEX(n-u,i-o,s)},IMSUM:(...t)=>{let e=0,r=0,n;return G.flattenParams(t,null,!1,i=>{let{real:s,im:l,unit:u}=de(i);if(n||(n=u),n!==u)throw q.VALUE;e+=s,r+=l}),z.COMPLEX(e,r,n)},IMTAN:t=>{let{unit:e}=de(t);return z.IMDIV(z.IMSIN(t),z.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=G.accept(t,V.STRING),e=G.accept(e,V.NUMBER,null),t.length>10||e>10||e!==null&&e<0)throw q.NUM;e=Math.trunc(e);let r=t.length===10&&t.substring(0,1)==="7",n=z.OCT2DEC(t);if(n<un||n>yi)return q.NUM;if(r)return"1"+dt.REPT("0",9-(512+n).toString(2).length)+(512+n).toString(2);let i=n.toString(2);if(e===0)return i;if(e<i.length)throw q.NUM;return dt.REPT("0",e-i.length)+i},OCT2DEC:t=>{if(t=G.accept(t,V.STRING),t.length>10)throw q.NUM;for(let r of t)if(r<"0"||r>"7")throw q.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=G.accept(t,V.STRING),e=G.accept(e,V.NUMBER_NO_BOOLEAN,null),t.length>10)throw q.NUM;for(let i of t)if(i<"0"||i>"7")throw q.NUM;if(e=Math.trunc(e),e<0||e>10)throw q.NUM;let r=z.OCT2DEC(t),n=z.DEC2HEX(r);if(e===0)return n;if(e<n.length)throw q.NUM;return dt.REPT("0",e-n.length)+n}};nu.exports=z});var su=w((lR,au)=>{var he=Oe(),{FormulaHelpers:Nd,Types:Ke,WildCard:cn,Address:yd}=Ce(),ou=Ir(),te=Nd,Od={ADDRESS:(t,e,r,n,i)=>{if(t=te.accept(t,Ke.NUMBER),e=te.accept(e,Ke.NUMBER),r=te.accept(r,Ke.NUMBER,1),n=te.accept(n,Ke.BOOLEAN,!0),i=te.accept(i,Ke.STRING,""),t<1||e<1||r<1||r>4)throw he.VALUE;let s="";return i.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(i)?s+=`'${i}'!`:s+=i+"!"),n?(s+=r===1||r===3?"$":"",s+=yd.columnNumberToName(e),s+=r===1||r===2?"$":"",s+=t):(s+="R",s+=r===4||r===3?`[${t}]`:t,s+="C",s+=r===4||r===2?`[${e}]`:e),s},AREAS:t=>(t=te.accept(t),t instanceof ou?t.length:1),CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(e==null){if(t.position.col!=null)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof e!="object"||Array.isArray(e))throw he.VALUE;if(te.isCellRef(e))return e.ref.col;if(te.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")}},COLUMNS:(t,e)=>{if(e==null)throw Error("COLUMNS requires one argument");if(typeof e!="object"||Array.isArray(e))throw he.VALUE;if(te.isCellRef(e))return 1;if(te.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,r,n)=>{t=te.accept(t);try{e=te.accept(e,Ke.ARRAY,void 0,!1)}catch(s){throw s instanceof he?he.NA:s}if(r=te.accept(r,Ke.NUMBER),n=te.accept(n,Ke.BOOLEAN,!0),r<1)throw he.VALUE;if(e[r-1]===void 0)throw he.REF;let i=typeof t;if(n){let s=i===typeof e[0][0]?e[0][0]:null;for(let l=1;l<e[0].length;l++){let u=e[0][l];if(typeof u===i){if(s>t&&u>t)throw he.NA;if(u===t)return e[r-1][l];if(s!=null&&u>t&&s<=t)return e[r-1][l-1];s=u}}if(s==null)throw he.NA;return s}else{let s=-1;if(cn.isWildCard(t)?s=e[0].findIndex(l=>cn.toRegex(t,"i").test(l)):s=e[0].findIndex(l=>l===t),s===-1)throw he.NA;return e[r-1][s]}},INDEX:(t,e,r,n,i)=>{r=t.utils.extractRefValue(r),r={value:r.val,isArray:r.isArray},r=te.accept(r,Ke.NUMBER),r=Math.trunc(r),n==null?n=1:(n=t.utils.extractRefValue(n),n={value:n.val,isArray:n.isArray},n=te.accept(n,Ke.NUMBER,1),n=Math.trunc(n)),i==null?i=1:(i=t.utils.extractRefValue(i),i={value:i.val,isArray:i.isArray},i=te.accept(i,Ke.NUMBER,1),i=Math.trunc(i));let s=e;if(e instanceof ou)s=e.refs[i-1];else if(i>1)throw he.REF;if(r===0&&n===0)return s;if(r===0){if(te.isRangeRef(s)){if(s.ref.to.col-s.ref.from.col<n-1)throw he.REF;return s.ref.from.col+=n-1,s.ref.to.col=s.ref.from.col,s}else if(Array.isArray(s)){let l=[];return s.forEach(u=>l.push([u[n-1]])),l}}if(n===0){if(te.isRangeRef(s)){if(s.ref.to.row-s.ref.from.row<r-1)throw he.REF;return s.ref.from.row+=r-1,s.ref.to.row=s.ref.from.row,s}else if(Array.isArray(s))return s[n-1]}if(r!==0&&n!==0){if(te.isRangeRef(s)){if(s=s.ref,s.to.row-s.from.row<r-1||s.to.col-s.from.col<n-1)throw he.REF;return{ref:{row:s.from.row+r-1,col:s.from.col+n-1}}}else if(te.isCellRef(s)){if(s=s.ref,r>1||n>1)throw he.REF;return{ref:{row:s.row+r-1,col:s.col+n-1}}}else if(Array.isArray(s)){if(s.length<r||s[0].length<n)throw he.REF;return s[r-1][n-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(e==null){if(t.position.row!=null)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}else{if(typeof e!="object"||Array.isArray(e))throw he.VALUE;if(te.isCellRef(e))return e.ref.row;if(te.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")}},ROWS:(t,e)=>{if(e==null)throw Error("ROWS requires one argument");if(typeof e!="object"||Array.isArray(e))throw he.VALUE;if(te.isCellRef(e))return 1;if(te.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=te.accept(t,Ke.ARRAY,void 0,!1);let e=[];for(let r=0;r<t[0].length;r++){e[r]=[];for(let n=0;n<t.length;n++)e[r][n]=t[n][r]}return e},VLOOKUP:(t,e,r,n)=>{t=te.accept(t);try{e=te.accept(e,Ke.ARRAY,void 0,!1)}catch(s){throw s instanceof he?he.NA:s}if(r=te.accept(r,Ke.NUMBER),n=te.accept(n,Ke.BOOLEAN,!0),r<1)throw he.VALUE;if(e[0][r-1]===void 0)throw he.REF;let i=typeof t;if(n){let s=i===typeof e[0][0]?e[0][0]:null;for(let l=1;l<e.length;l++){let u=e[l],o=e[l][0];if(typeof o===i){if(s>t&&o>t)throw he.NA;if(o===t)return u[r-1];if(s!=null&&o>t&&s<=t)return e[l-1][r-1];s=o}}if(s==null)throw he.NA;return s}else{let s=-1;if(cn.isWildCard(t)?s=e.findIndex(l=>cn.toRegex(t,"i").test(l[0])):s=e.findIndex(l=>l[0]===t),s===-1)throw he.NA;return e[s][r-1]}}};au.exports=Od});var cu=w((fR,uu)=>{var Ut=Oe(),{FormulaHelpers:_d,Types:Id}=Ce(),Se=_d,Md={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},Cd={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if(t=Se.accept(t),t instanceof Ut)return Md[t.toString()];throw Ut.NA},INFO:()=>{},ISBLANK:t=>t.ref?t.value==null||t.value==="":!1,ISERR:t=>(t=Se.accept(t),t instanceof Ut&&t.toString()!=="#N/A"),ISERROR:t=>(t=Se.accept(t),t instanceof Ut),ISEVEN:t=>(t=Se.accept(t,Id.NUMBER),t=Math.trunc(t),t%2==0),ISLOGICAL:t=>(t=Se.accept(t),typeof t=="boolean"),ISNA:t=>(t=Se.accept(t),t instanceof Ut&&t.toString()==="#N/A"),ISNONTEXT:t=>(t=Se.accept(t),typeof t!="string"),ISNUMBER:t=>(t=Se.accept(t),typeof t=="number"),ISREF:t=>!t.ref||Se.isCellRef(t)&&(t.ref.row>1048576||t.ref.col>16384)||Se.isRangeRef(t)&&(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384)?!1:(t=Se.accept(t),!(t instanceof Ut&&t.toString()==="#REF!")),ISTEXT:t=>(t=Se.accept(t),typeof t=="string"),N:t=>{t=Se.accept(t);let e=typeof t;if(e==="number")return t;if(e==="boolean")return Number(t);if(t instanceof Ut)throw t;return 0},NA:()=>{throw Ut.NA},TYPE:t=>{if(t.ref){if(Se.isRangeRef(t))return 16;if(Se.isCellRef(t)&&(t=Se.accept(t),typeof t=="string"&&t.length===0))return 1}t=Se.accept(t);let e=typeof t;if(e==="number")return 1;if(e==="string")return 2;if(e==="boolean")return 4;if(t instanceof Ut)return 16;if(Array.isArray(t))return 64}};uu.exports=Cd});var hu=w((hR,fu)=>{var b=Oe(),{FormulaHelpers:wd,Types:I}=Ce(),M=wd,D=Ni(),ln=Ei(),Pd=2.5066282746310002,lu={"BETA.DIST":(t,e,r,n,i,s)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),i=M.accept(i,I.NUMBER,0),s=M.accept(s,I.NUMBER,1),e<=0||r<=0||t<i||t>s||i===s)throw b.NUM;return t=(t-i)/(s-i),n?D.beta.cdf(t,e,r):D.beta.pdf(t,e,r)/(s-i)},"BETA.INV":(t,e,r,n,i)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.NUMBER,0),i=M.accept(i,I.NUMBER,1),e<=0||r<=0||t<=0||t>1)throw b.NUM;return D.beta.inv(t,e,r)*(i-n)+n},"BINOM.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),e<0||r<0||r>1||t<0||t>e)throw b.NUM;return n?D.binomial.cdf(t,e,r):D.binomial.pdf(t,e,r)},"BINOM.DIST.RANGE":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.NUMBER,r),t<0||e<0||e>1||r<0||r>t||n<r||n>t)throw b.NUM;let i=0;for(let s=r;s<=n;s++)i+=ln.COMBIN(t,s)*Math.pow(e,s)*Math.pow(1-e,t-s);return i},"BINOM.INV":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<0||e<0||e>1||r<0||r>1)throw b.NUM;let n=0;for(;n<=t;){if(D.binomial.cdf(n,t,e)>=r)return n;n++}},"CHISQ.DIST":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw b.NUM;return r?D.chisquare.cdf(t,e):D.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),e=Math.trunc(e),t<0||e<1||e>10**10)throw b.NUM;return 1-D.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw b.NUM;return D.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>10**10)throw b.NUM;return D.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{let r=M.accept(t,I.ARRAY,void 0,!1,!1),n=M.accept(e,I.ARRAY,void 0,!1,!1);if(r.length!==n.length||r[0].length!==n[0].length||r.length===1&&r[0].length===1)throw b.NA;let i=r.length,s=r[0].length,l=(i-1)*(s-1);i===1?l=s-1:l=i-1;let u=0;for(let p=0;p<i;p++)for(let d=0;d<s;d++)if(!(typeof r[p][d]!="number"||typeof n[p][d]!="number")){if(n[p][d]===0)throw b.DIV0;u+=Math.pow(r[p][d]-n[p][d],2)/n[p][d]}let o=Math.exp(-.5*u);l%2==1&&(o=o*Math.sqrt(2*u/Math.PI));let a=l;for(;a>=2;)o=o*u/a,a=a-2;let c=o,f=l;for(;c>1e-15*o;)f=f+2,c=c*u/f,o=o+c;return 1-o},"CONFIDENCE.NORM":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),r=Math.trunc(r),t<=0||t>=1||e<=0||r<1)throw b.NUM;return D.normalci(1,t,e,r)[1]-1},"CONFIDENCE.T":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),r=Math.trunc(r),t<=0||t>=1||e<=0||r<1)throw b.NUM;if(r===1)throw b.DIV0;return D.tci(1,t,e,r)[1]-1},CORREL:(t,e)=>{if(t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0),t.length!==e.length)throw b.NA;let r=[],n=[];for(let i=0;i<t.length;i++)typeof t[i]!="number"||typeof e[i]!="number"||(r.push(t[i]),n.push(e[i]));if(r.length<=1)throw b.DIV0;return D.corrcoeff(r,n)},"COVARIANCE.P":(t,e)=>{if(t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0),t.length!==e.length)throw b.NA;let r=[],n=[];for(let u=0;u<t.length;u++)typeof t[u]!="number"||typeof e[u]!="number"||(r.push(t[u]),n.push(e[u]));let i=D.mean(r),s=D.mean(n),l=0;for(let u=0;u<r.length;u++)l+=(r[u]-i)*(n[u]-s);return l/r.length},"COVARIANCE.S":(t,e)=>{if(t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0),t.length!==e.length)throw b.NA;let r=[],n=[];for(let i=0;i<t.length;i++)typeof t[i]!="number"||typeof e[i]!="number"||(r.push(t[i]),n.push(e[i]));if(r.length<=1)throw b.DIV0;return D.covariance(r,n)},DEVSQ:(...t)=>{let e=0,r=[];M.flattenParams(t,I.NUMBER,!0,(i,s)=>{typeof i=="number"&&(e+=i,r.push(i))});let n=e/r.length;e=0;for(let i=0;i<r.length;i++)e+=(r[i]-n)**2;return e},"EXPON.DIST":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.BOOLEAN),t<0||e<=0)throw b.NUM;return r?D.exponential.cdf(t,e):D.exponential.pdf(t,e)},"F.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),t<0||e<1||r<1)throw b.NUM;return e=Math.trunc(e),r=Math.trunc(r),n?D.centralF.cdf(t,e,r):D.centralF.pdf(t,e,r)},"F.DIST.RT":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<0||e<1||r<1)throw b.NUM;return e=Math.trunc(e),r=Math.trunc(r),1-D.centralF.cdf(t,e,r)},"F.INV":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<0||t>1||e<1||r<1)throw b.NUM;return e=Math.trunc(e),r=Math.trunc(r),D.centralF.inv(t,e,r)},"F.INV.RT":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<0||t>1||e<1||e>=Math.pow(10,10)||r<1||r>=Math.pow(10,10))throw b.NUM;return e=Math.trunc(e),r=Math.trunc(r),D.centralF.inv(1-t,e,r)},"F.TEST":(t,e)=>{t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0);let r=[],n=[],i=0,s=0;for(let o=0;o<Math.max(t.length,e.length);o++)typeof t[o]=="number"&&(r.push(t[o]),i+=t[o]),typeof e[o]=="number"&&(n.push(e[o]),s+=e[o]);if(r.length<=1||n.length<=1)throw b.DIV0;i/=r.length,s/=n.length;let l=0,u=0;for(let o=0;o<r.length;o++)l+=(i-r[o])**2;l/=r.length-1;for(let o=0;o<n.length;o++)u+=(s-n[o])**2;return u/=n.length-1,D.centralF.cdf(l/u,r.length-1,n.length-1)*2},FISHER:t=>{if(t=M.accept(t,I.NUMBER),t<=-1||t>=1)throw b.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{t=M.accept(t,I.NUMBER);let e=Math.exp(2*t);return(e-1)/(e+1)},FORECAST:(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.ARRAY,void 0,!0,!0),r=M.accept(r,I.ARRAY,void 0,!0,!0),r.length!==e.length)throw b.NA;let n=[],i=[],s=!0;for(let p=0;p<e.length;p++)typeof e[p]!="number"||typeof r[p]!="number"||(n.push(e[p]),i.push(r[p]),r[p]!==r[0]&&(s=!1));if(s)throw b.DIV0;let l=D.mean(n),u=D.mean(i),o=0,a=0;for(let p=0;p<n.length;p++)o+=(i[p]-u)*(n[p]-l),a+=(i[p]-u)**2;let c=o/a;return l-c*u+c*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>lu.FORECAST(...t),FREQUENCY:(t,e)=>{t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0);let r=[];for(let i=0;i<e.length;i++)typeof e[i]=="number"&&r.push(e[i]);r.sort(),r.push(1/0);let n=[];for(let i=0;i<r.length;i++){n[i]=[],n[i][0]=0;for(let s=0;s<t.length;s++){if(typeof t[s]!="number")continue;t[s]<=r[i]&&(n[i][0]++,t[s]=null)}}return n},GAMMA:t=>{if(t=M.accept(t,I.NUMBER),t===0||t<0&&t===Math.trunc(t))throw b.NUM;return D.gammafn(t)},"GAMMA.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),t<0||e<=0||r<=0)throw b.NUM;return n?D.gamma.cdf(t,e,r,!0):D.gamma.pdf(t,e,r,!1)},"GAMMA.INV":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<0||t>1||e<=0||r<=0)throw b.NUM;return D.gamma.inv(t,e,r)},GAMMALN:t=>{if(t=M.accept(t,I.NUMBER),t<=0)throw b.NUM;return D.gammaln(t)},"GAMMALN.PRECISE":t=>{if(t=M.accept(t,I.NUMBER),t<=0)throw b.NUM;return D.gammaln(t)},GAUSS:t=>(t=M.accept(t,I.NUMBER),D.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{let e=[];return M.flattenParams(t,I.NUMBER,!0,(r,n)=>{typeof r=="number"&&e.push(r)}),D.geomean(e)},GROWTH:(t,e,r,n)=>{t=M.accept(t,I.ARRAY,void 0,!0,!0);for(let d=0;d<t.length;d++)if(typeof t[d]!="number")throw b.VALUE;e=M.accept(e,I.ARRAY,null,!0,!0);let i=e==null;if(e==null){e=[];for(let d=1;d<=t.length;d++)e.push(d)}else{if(e.length!==t.length)throw b.REF;for(let d=0;d<e.length;d++)if(typeof e[d]!="number")throw b.VALUE}if(r=M.accept(r,I.ARRAY,null,!1,!0),r==null&&i){r=[];for(let d=1;d<=t.length;d++)r.push(d);r=[r]}else r==null&&(r=Array.isArray(e[0])?e:[e]);n=M.accept(n,I.BOOLEAN,!0);let s=t.length,l=0,u=0,o=0,a=0;for(let d=0;d<s;d++){let h=e[d],v=Math.log(t[d]);l+=h,u+=v,o+=h*v,a+=h*h}l/=s,u/=s,o/=s,a/=s;let c,f;n?(c=(o-l*u)/(a-l*l),f=u-c*l):(c=o/a,f=0);let p=[];for(let d=0;d<r.length;d++){p[d]=[];for(let h=0;h<r[0].length;h++){if(typeof r[d][h]!="number")throw b.VALUE;p[d][h]=Math.exp(f+c*r[d][h])}}return p},HARMEAN:(...t)=>{let e=0,r=0;return M.flattenParams(t,I.NUMBER,!0,(n,i)=>{typeof n=="number"&&(r+=1/n,e++)}),e/r},"HYPGEOM.DIST":(t,e,r,n,i)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.NUMBER),i=M.accept(i,I.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r=Math.trunc(r),n=Math.trunc(n),n<=0||t<0||e<=0||r<=0||e>n||r>n||e<t||r<t||t<e-n+r)throw b.NUM;function s(u,o,a,c){return ln.COMBIN(a,u)*ln.COMBIN(c-a,o-u)/ln.COMBIN(c,o)}function l(u,o,a,c){let f=0;for(let p=0;p<=u;p++)f+=s(p,o,a,c);return f}return i?l(t,e,r,n):s(t,e,r,n)},INTERCEPT:(t,e)=>{if(t=M.accept(t,I.ARRAY,void 0,!0,!0),e=M.accept(e,I.ARRAY,void 0,!0,!0),e.length!==t.length)throw b.NA;let r=[],n=[];for(let a=0;a<t.length;a++)typeof t[a]!="number"||typeof e[a]!="number"||(r.push(t[a]),n.push(e[a]));if(r.length<=1)throw b.DIV0;let i=D.mean(r),s=D.mean(n),l=0,u=0;for(let a=0;a<r.length;a++)l+=(n[a]-s)*(r[a]-i),u+=(n[a]-s)**2;let o=l/u;return i-o*s},KURT:(...t)=>{let e=0,r=[];M.flattenParams(t,I.NUMBER,!0,(s,l)=>{typeof s=="number"&&(e+=s,r.push(s))});let n=r.length;e/=n;let i=0;for(let s=0;s<n;s++)i+=Math.pow(r[s]-e,4);return i=i/Math.pow(D.stdev(r,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*i-3*(n-1)*(n-1)/((n-2)*(n-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),t<=0||r<=0)throw b.NUM;return n?D.lognormal.cdf(t,e,r):D.lognormal.pdf(t,e,r)},"LOGNORM.INV":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<=0||t>=1||r<=0)throw b.NUM;return D.lognormal.inv(t,e,r)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),r<0||r>1||t<0||e<1)throw b.NUM;return n?D.negbin.cdf(t,e,r):D.negbin.pdf(t,e,r)},"NORM.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),r<=0)throw b.NUM;return n?D.normal.cdf(t,e,r):D.normal.pdf(t,e,r)},"NORM.INV":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),t<=0||t>=1||r<=0)throw b.NUM;return D.normal.inv(t,e,r)},"NORM.S.DIST":(t,e)=>(t=M.accept(t,I.NUMBER),e=M.accept(e,I.BOOLEAN),e?D.normal.cdf(t,0,1):D.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if(t=M.accept(t,I.NUMBER),t<=0||t>=1)throw b.NUM;return D.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>(t=M.accept(t,I.NUMBER),Math.exp(-.5*t*t)/Pd),"POISSON.DIST":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.BOOLEAN),t<0||e<0)throw b.NUM;return t=Math.trunc(t),r?D.poisson.cdf(t,e):D.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),r<=0)throw b.NUM;return(t-e)/r},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,r)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.BOOLEAN),e<1)throw b.NUM;return r?D.studentt.cdf(t,e):D.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),e<1||t<0)throw b.NUM;return(1-D.studentt.cdf(t,e))*2},"T.DIST.RT":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),e<1)throw b.NUM;return 1-D.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),t<=0||t>1||e<1)throw b.NUM;return e=e%1==0?e:Math.trunc(e),D.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),t<=0||t>1||e<1)throw b.NUM;return e=e%1==0?e:Math.trunc(e),Math.abs(D.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,r,n)=>{if(t=M.accept(t,I.NUMBER),e=M.accept(e,I.NUMBER),r=M.accept(r,I.NUMBER),n=M.accept(n,I.BOOLEAN),t<0||e<=0||r<=0)throw b.NUM;return n?1-Math.exp(-Math.pow(t/r,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/r,e))*e/Math.pow(r,e)},"Z.TEST":()=>{}};fu.exports={DistributionFunctions:lu}});var gu=w((dR,vu)=>{var Ud=Oe(),{FormulaHelpers:Ld,Types:fn,Criteria:pu,Address:pR}=Ce(),{Infix:du}=Pr(),Lt=Ld,{DistributionFunctions:xd}=hu(),kd={AVEDEV:(...t)=>{let e=0,r=[];Lt.flattenParams(t,fn.NUMBER,!0,(i,s)=>{typeof i=="number"&&(e+=i,r.push(i))});let n=e/r.length;e=0;for(let i=0;i<r.length;i++)e+=Math.abs(r[i]-n);return e/r.length},AVERAGE:(...t)=>{let e=0,r=0;return Lt.flattenParams(t,fn.NUMBER,!0,(n,i)=>{typeof n=="number"&&(e+=n,r++)}),e/r},AVERAGEA:(...t)=>{let e=0,r=0;return Lt.flattenParams(t,fn.NUMBER,!0,(n,i)=>{let s=typeof n;s==="number"?(e+=n,r++):s==="string"&&r++}),e/r},AVERAGEIF:(t,e,r,n)=>{let i=Lt.retrieveRanges(t,e,n);e=i[0],n=i[1],r=Lt.retrieveArg(t,r);let s=r.isArray;r=pu.parse(Lt.accept(r));let l=0,u=0;if(e.forEach((o,a)=>{o.forEach((c,f)=>{let p=n[a][f];typeof p=="number"&&(r.op==="wc"?r.match===r.value.test(c)&&(l+=p,u++):du.compareOp(c,r.op,r.value,Array.isArray(c),s)&&(l+=p,u++))})}),u===0)throw Ud.DIV0;return l/u},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return Lt.flattenParams(t,null,!0,(r,n)=>{(n.isLiteral&&!isNaN(r)||typeof r=="number")&&e++}),e},COUNTIF:(t,e)=>{t=Lt.accept(t,fn.ARRAY,void 0,!1,!0);let r=e.isArray;e=Lt.accept(e);let n=0;return e=pu.parse(e),t.forEach(i=>{i.forEach(s=>{e.op==="wc"?e.match===e.value.test(s)&&n++:du.compareOp(s,e.op,e.value,Array.isArray(s),r)&&n++})}),n},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};vu.exports=Object.assign(kd,xd)});var Tu=w((vR,Ru)=>{var it=Oe(),{FormulaHelpers:Sd,Types:Le}=Ce(),ye=Sd,hn=1e3*60*60*24,Oi=new Date(Date.UTC(1900,0,1)),bd=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Fd=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Eu=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],Bd=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,Dd=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,qd=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,Gd=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function Vd(t){let e=t.match(Dd),r=t.match(qd),n=t.match(Gd);return e?t=e[1]+e[3]+new Date().getFullYear()+e[5]:r?t=r[1]+r[3]+new Date().getFullYear()+r[5]:n&&(t=n[1]+n[3]+new Date().getFullYear()+n[5]),new Date(Date.parse(`${t} UTC`))}function Wd(t){let e=t.match(Bd);if(!e)return;let r=e[2]?e[2]:":00",n=e[3]?e[3]:":00",i=e[4]?" "+e[4]:"",s=new Date(Date.parse(`1/1/1900 ${e[1]+r+n+i} UTC`)),l=new Date;return l=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds())),new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate(),s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()))}function Qt(t){let e=t>-22038912e5?2:1;return Math.floor((t-Oi)/864e5)+e}function Hd(t){if(t<0)throw it.VALUE;return t<=60?new Date(Oi.getTime()+(t-1)*864e5):new Date(Oi.getTime()+(t-2)*864e5)}function mu(t){if(t instanceof Date)return{date:t};t=ye.accept(t);let e=!0,r;return isNaN(t)?(r=Wd(t),r?e=!1:r=Vd(t)):(t=Number(t),r=Hd(t)),{date:r,isDateGiven:e}}function ae(t){return mu(t).date}function _i(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}function Yd(t){return t===1900?!0:new Date(t,1,29).getMonth()===1}var Zt={DATE:(t,e,r)=>{if(t=ye.accept(t,Le.NUMBER),e=ye.accept(e,Le.NUMBER),r=ye.accept(r,Le.NUMBER),t<0||t>=1e4)throw it.NUM;return t<1900&&(t+=1900),Qt(Date.UTC(t,e-1,r))},DATEDIF:(t,e,r)=>{if(t=ae(t),e=ae(e),r=ye.accept(r,Le.STRING).toLowerCase(),t>e)throw it.NUM;let n=e.getUTCFullYear()-t.getUTCFullYear(),i=e.getUTCMonth()-t.getUTCMonth(),s=e.getUTCDate()-t.getUTCDate(),l;switch(r){case"y":return l=i<0||i===0&&s<0?-1:0,l+n;case"m":return l=s<0?-1:0,n*12+i+l;case"d":return Math.floor(e-t)/hn;case"md":return t.setUTCFullYear(e.getUTCFullYear()),s<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/hn;case"ym":return l=s<0?-1:0,(l+n*12+i)%12;case"yd":return i<0||i===0&&s<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/hn}},DATEVALUE:t=>{t=ye.accept(t,Le.STRING);let{date:e,isDateGiven:r}=mu(t);if(!r)return 0;let n=Qt(e);if(n<0||n>2958465)throw it.VALUE;return n},DAY:t=>ae(t).getUTCDate(),DAYS:(t,e)=>{t=ae(t),e=ae(e);let r=0;return e<-22038912e5&&-22038912e5<t&&(r=1),Math.floor(t-e)/hn+r},DAYS360:(t,e,r)=>{t=ae(t),e=ae(e),r=ye.accept(r,Le.BOOLEAN,!1),t.getUTCDate()===31&&t.setUTCDate(30),!r&&t.getUTCDate()<30&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):e.getUTCDate()===31&&e.setUTCDate(30);let n=e.getUTCFullYear()-t.getUTCFullYear(),i=e.getUTCMonth()-t.getUTCMonth(),s=e.getUTCDate()-t.getUTCDate();return i*30+s+n*12*30},EDATE:(t,e)=>(t=ae(t),e=ye.accept(e,Le.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),Qt(t)),EOMONTH:(t,e)=>(t=ae(t),e=ye.accept(e,Le.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),Qt(t)),HOUR:t=>ae(t).getUTCHours(),ISOWEEKNUM:t=>{let e=ae(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=r.getUTCDay();r.setUTCDate(r.getUTCDate()+4-n);let i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r-i)/864e5+1)/7)},MINUTE:t=>ae(t).getUTCMinutes(),MONTH:t=>ae(t).getUTCMonth()+1,NETWORKDAYS:(t,e,r)=>{t=ae(t),e=ae(e);let n=1;if(t>e){n=-1;let l=t;t=e,e=l}let i=[];r!=null&&ye.flattenParams([r],Le.NUMBER,!1,l=>{i.push(ae(l))});let s=0;for(;t<=e;){if(t.getUTCDay()!==0&&t.getUTCDay()!==6){let l=!1;for(let u=0;u<i.length;u++)if(_i(t,i[u])){l=!0;break}l||s++}t.setUTCDate(t.getUTCDate()+1)}return n*s},"NETWORKDAYS.INTL":(t,e,r,n)=>{t=ae(t),e=ae(e);let i=1;if(t>e){i=-1;let u=t;t=e,e=u}if(r=ye.accept(r,null,1),r==="1111111")return 0;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw it.VALUE;r=r.charAt(6)+r.slice(0,6);let u=[];for(let o=0;o<r.length;o++)r.charAt(o)==="1"&&u.push(o);r=u}else{if(typeof r!="number")throw it.VALUE;r=Eu[r]}let s=[];n!=null&&ye.flattenParams([n],Le.NUMBER,!1,u=>{s.push(ae(u))});let l=0;for(;t<=e;){let u=!1;for(let o=0;o<r.length;o++)if(r[o]===t.getUTCDay()){u=!0;break}if(!u){let o=!1;for(let a=0;a<s.length;a++)if(_i(t,s[a])){o=!0;break}o||l++}t.setUTCDate(t.getUTCDate()+1)}return i*l},NOW:()=>{let t=new Date;return Qt(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>ae(t).getUTCSeconds(),TIME:(t,e,r)=>{if(t=ye.accept(t,Le.NUMBER),e=ye.accept(e,Le.NUMBER),r=ye.accept(r,Le.NUMBER),t<0||t>32767||e<0||e>32767||r<0||r>32767)throw it.NUM;return(3600*t+60*e+r)/86400},TIMEVALUE:t=>(t=ae(t),(3600*t.getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400),TODAY:()=>{let t=new Date;return Qt(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{let r=ae(t);e=ye.accept(e,Le.NUMBER,1);let n=r.getUTCDay(),i=Fd[e];if(!i)throw it.NUM;return i[n]},WEEKNUM:(t,e)=>{let r=ae(t);if(e=ye.accept(e,Le.NUMBER,1),e===21)return Zt.ISOWEEKNUM(t);let n=bd[e],i=new Date(Date.UTC(r.getUTCFullYear(),0,1)),s=i.getUTCDay()<n?1:0;return Math.ceil(((r-i)/864e5+1)/7)+s},WORKDAY:(t,e,r)=>Zt["WORKDAY.INTL"](t,e,1,r),"WORKDAY.INTL":(t,e,r,n)=>{if(t=ae(t),e=ye.accept(e,Le.NUMBER),r=ye.accept(r,null,1),r==="1111111")throw it.VALUE;if(typeof r=="string"&&Number(r).toString()!==r){if(r.length!==7)throw it.VALUE;r=r.charAt(6)+r.slice(0,6);let l=[];for(let u=0;u<r.length;u++)r.charAt(u)==="1"&&l.push(u);r=l}else{if(typeof r!="number")throw it.VALUE;if(r=Eu[r],r==null)throw it.NUM}let i=[];n!=null&&ye.flattenParams([n],Le.NUMBER,!1,l=>{i.push(ae(l))}),t.setUTCDate(t.getUTCDate()+1);let s=0;for(;s<e;){let l=!1;for(let u=0;u<r.length;u++)if(r[u]===t.getUTCDay()){l=!0;break}if(!l){let u=!1;for(let o=0;o<i.length;o++)if(_i(t,i[o])){u=!0;break}u||s++}t.setUTCDate(t.getUTCDate()+1)}return Qt(t)-1},YEAR:t=>ae(t).getUTCFullYear(),YEARFRAC:(t,e,r)=>{if(t=ae(t),e=ae(e),t>e){let a=t;t=e,e=a}if(r=ye.accept(r,Le.NUMBER,0),r=Math.trunc(r),r<0||r>4)throw it.VALUE;let n=t.getUTCDate(),i=t.getUTCMonth()+1,s=t.getUTCFullYear(),l=e.getUTCDate(),u=e.getUTCMonth()+1,o=e.getUTCFullYear();switch(r){case 0:return n===31&&l===31?(n=30,l=30):n===31?n=30:n===30&&l===31&&(l=30),Math.abs(l+u*30+o*360-(n+i*30+s*360))/360;case 1:if(o-s<2){let a=Yd(s)&&s!==1900?366:365;return Zt.DAYS(e,t)/a}else{let a=o-s+1,f=(new Date(o+1,0,1)-new Date(s,0,1))/1e3/60/60/24/a;return Zt.DAYS(e,t)/f}case 2:return Math.abs(Zt.DAYS(e,t)/360);case 3:return Math.abs(Zt.DAYS(e,t)/365);case 4:return Math.abs(l+u*30+o*360-(n+i*30+s*360))/360}}};Ru.exports=Zt});var _u=w((gR,Ou)=>{var Au=Oe(),{FormulaHelpers:zd,Types:Nu}=Ce(),yu=zd,Kd={ENCODEURL:t=>encodeURIComponent(yu.accept(t,Nu.STRING)),FILTERXML:()=>{},WEBSERVICE:(t,e)=>{throw Au.ERROR("WEBSERVICE is not supported in sync mode.")}};Ou.exports=Kd});var Ii=w(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.VERSION=void 0;pn.VERSION="7.1.2"});var J=w((exports,module)=>{"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.peek=exports.toFastProperties=exports.applyMixins=exports.isES2015MapSupported=exports.PRINT_WARNING=exports.PRINT_ERROR=exports.packArray=exports.IDENTITY=exports.NOOP=exports.merge=exports.groupBy=exports.defaults=exports.assignNoOverwrite=exports.assign=exports.zipObject=exports.sortBy=exports.indexOf=exports.some=exports.difference=exports.every=exports.isObject=exports.isRegExp=exports.isArray=exports.partial=exports.uniq=exports.compact=exports.reduce=exports.findAll=exports.find=exports.cloneObj=exports.cloneArr=exports.contains=exports.has=exports.pick=exports.reject=exports.filter=exports.dropRight=exports.drop=exports.isFunction=exports.isUndefined=exports.isString=exports.forEach=exports.last=exports.first=exports.flatten=exports.map=exports.mapValues=exports.values=exports.keys=exports.isEmpty=void 0;exports.timer=void 0;function isEmpty(t){return t&&t.length===0}exports.isEmpty=isEmpty;function keys(t){return t==null?[]:Object.keys(t)}exports.keys=keys;function values(t){for(var e=[],r=Object.keys(t),n=0;n<r.length;n++)e.push(t[r[n]]);return e}exports.values=values;function mapValues(t,e){for(var r=[],n=keys(t),i=0;i<n.length;i++){var s=n[i];r.push(e.call(null,t[s],s))}return r}exports.mapValues=mapValues;function map(t,e){for(var r=[],n=0;n<t.length;n++)r.push(e.call(null,t[n],n));return r}exports.map=map;function flatten(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];Array.isArray(n)?e=e.concat(flatten(n)):e.push(n)}return e}exports.flatten=flatten;function first(t){return isEmpty(t)?void 0:t[0]}exports.first=first;function last(t){var e=t&&t.length;return e?t[e-1]:void 0}exports.last=last;function forEach(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e.call(null,t[r],r);else if(isObject(t))for(var n=keys(t),r=0;r<n.length;r++){var i=n[r],s=t[i];e.call(null,s,i)}else throw Error("non exhaustive match")}exports.forEach=forEach;function isString(t){return typeof t=="string"}exports.isString=isString;function isUndefined(t){return t===void 0}exports.isUndefined=isUndefined;function isFunction(t){return t instanceof Function}exports.isFunction=isFunction;function drop(t,e){return e===void 0&&(e=1),t.slice(e,t.length)}exports.drop=drop;function dropRight(t,e){return e===void 0&&(e=1),t.slice(0,t.length-e)}exports.dropRight=dropRight;function filter(t,e){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}exports.filter=filter;function reject(t,e){return filter(t,function(r){return!e(r)})}exports.reject=reject;function pick(t,e){for(var r=Object.keys(t),n={},i=0;i<r.length;i++){var s=r[i],l=t[s];e(l)&&(n[s]=l)}return n}exports.pick=pick;function has(t,e){return isObject(t)?t.hasOwnProperty(e):!1}exports.has=has;function contains(t,e){return find(t,function(r){return r===e})!==void 0}exports.contains=contains;function cloneArr(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}exports.cloneArr=cloneArr;function cloneObj(t){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}exports.cloneObj=cloneObj;function find(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(e.call(null,n))return n}}exports.find=find;function findAll(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];e.call(null,i)&&r.push(i)}return r}exports.findAll=findAll;function reduce(t,e,r){for(var n=Array.isArray(t),i=n?t:values(t),s=n?[]:keys(t),l=r,u=0;u<i.length;u++)l=e.call(null,l,i[u],n?u:s[u]);return l}exports.reduce=reduce;function compact(t){return reject(t,function(e){return e==null})}exports.compact=compact;function uniq(t,e){e===void 0&&(e=function(n){return n});var r=[];return reduce(t,function(n,i){var s=e(i);return contains(r,s)?n:(r.push(s),n.concat(i))},[])}exports.uniq=uniq;function partial(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=[null],i=n.concat(e);return Function.bind.apply(t,i)}exports.partial=partial;function isArray(t){return Array.isArray(t)}exports.isArray=isArray;function isRegExp(t){return t instanceof RegExp}exports.isRegExp=isRegExp;function isObject(t){return t instanceof Object}exports.isObject=isObject;function every(t,e){for(var r=0;r<t.length;r++)if(!e(t[r],r))return!1;return!0}exports.every=every;function difference(t,e){return reject(t,function(r){return contains(e,r)})}exports.difference=difference;function some(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return!0;return!1}exports.some=some;function indexOf(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return r;return-1}exports.indexOf=indexOf;function sortBy(t,e){var r=cloneArr(t);return r.sort(function(n,i){return e(n)-e(i)}),r}exports.sortBy=sortBy;function zipObject(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<t.length;n++)r[t[n]]=e[n];return r}exports.zipObject=zipObject;function assign(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],s=keys(i),l=0;l<s.length;l++){var u=s[l];t[u]=i[u]}return t}exports.assign=assign;function assignNoOverwrite(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=0;n<e.length;n++)for(var i=e[n],s=keys(i),l=0;l<s.length;l++){var u=s[l];has(t,u)||(t[u]=i[u])}return t}exports.assignNoOverwrite=assignNoOverwrite;function defaults(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return assignNoOverwrite.apply(null,[{}].concat(t))}exports.defaults=defaults;function groupBy(t,e){var r={};return forEach(t,function(n){var i=e(n),s=r[i];s?s.push(n):r[i]=[n]}),r}exports.groupBy=groupBy;function merge(t,e){for(var r=cloneObj(t),n=keys(e),i=0;i<n.length;i++){var s=n[i],l=e[s];r[s]=l}return r}exports.merge=merge;function NOOP(){}exports.NOOP=NOOP;function IDENTITY(t){return t}exports.IDENTITY=IDENTITY;function packArray(t){for(var e=[],r=0;r<t.length;r++){var n=t[r];e.push(n!==void 0?n:void 0)}return e}exports.packArray=packArray;function PRINT_ERROR(t){console&&console.error&&console.error("Error: "+t)}exports.PRINT_ERROR=PRINT_ERROR;function PRINT_WARNING(t){console&&console.warn&&console.warn("Warning: "+t)}exports.PRINT_WARNING=PRINT_WARNING;function isES2015MapSupported(){return typeof Map=="function"}exports.isES2015MapSupported=isES2015MapSupported;function applyMixins(t,e){e.forEach(function(r){var n=r.prototype;Object.getOwnPropertyNames(n).forEach(function(i){if(i!=="constructor"){var s=Object.getOwnPropertyDescriptor(n,i);s&&(s.get||s.set)?Object.defineProperty(t.prototype,i,s):t.prototype[i]=r.prototype[i]}})})}exports.applyMixins=applyMixins;function toFastProperties(toBecomeFast){function FakeConstructor(){}FakeConstructor.prototype=toBecomeFast;var fakeInstance=new FakeConstructor;function fakeAccess(){return typeof fakeInstance.bar}return fakeAccess(),fakeAccess(),toBecomeFast;eval(toBecomeFast)}exports.toFastProperties=toFastProperties;function peek(t){return t[t.length-1]}exports.peek=peek;function timer(t){var e=new Date().getTime(),r=t(),n=new Date().getTime(),i=n-e;return{time:i,value:r}}exports.timer=timer});var vn=w((Iu,dn)=>{(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof dn=="object"&&dn.exports?dn.exports=e():t.regexpToAst=e()})(typeof self!="undefined"?self:Iu,function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(h){this.idx=h.idx,this.input=h.input,this.groupIdx=h.groupIdx},t.prototype.pattern=function(h){this.idx=0,this.input=h,this.groupIdx=0,this.consumeChar("/");var v=this.disjunction();this.consumeChar("/");for(var E={type:"Flags",loc:{begin:this.idx,end:h.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":l(E,"global");break;case"i":l(E,"ignoreCase");break;case"m":l(E,"multiLine");break;case"u":l(E,"unicode");break;case"y":l(E,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:E,value:v,loc:this.loc(0)}},t.prototype.disjunction=function(){var h=[],v=this.idx;for(h.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),h.push(this.alternative());return{type:"Disjunction",value:h,loc:this.loc(v)}},t.prototype.alternative=function(){for(var h=[],v=this.idx;this.isTerm();)h.push(this.term());return{type:"Alternative",value:h,loc:this.loc(v)}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){var h=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(h)};case"$":return{type:"EndAnchor",loc:this.loc(h)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(h)};case"B":return{type:"NonWordBoundary",loc:this.loc(h)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");var v;switch(this.popChar()){case"=":v="Lookahead";break;case"!":v="NegativeLookahead";break}u(v);var E=this.disjunction();return this.consumeChar(")"),{type:v,value:E,loc:this.loc(h)}}o()},t.prototype.quantifier=function(h){var v,E=this.idx;switch(this.popChar()){case"*":v={atLeast:0,atMost:1/0};break;case"+":v={atLeast:1,atMost:1/0};break;case"?":v={atLeast:0,atMost:1};break;case"{":var g=this.integerIncludingZero();switch(this.popChar()){case"}":v={atLeast:g,atMost:g};break;case",":var m;this.isDigit()?(m=this.integerIncludingZero(),v={atLeast:g,atMost:m}):v={atLeast:g,atMost:1/0},this.consumeChar("}");break}if(h===!0&&v===void 0)return;u(v);break}if(!(h===!0&&v===void 0))return u(v),this.peekChar(0)==="?"?(this.consumeChar("?"),v.greedy=!1):v.greedy=!0,v.type="Quantifier",v.loc=this.loc(E),v},t.prototype.atom=function(){var h,v=this.idx;switch(this.peekChar()){case".":h=this.dotAll();break;case"\\":h=this.atomEscape();break;case"[":h=this.characterClass();break;case"(":h=this.group();break}return h===void 0&&this.isPatternCharacter()&&(h=this.patternCharacter()),u(h),h.loc=this.loc(v),this.isQuantifier()&&(h.quantifier=this.quantifier()),h},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i(`
`),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){var h=this.positiveInteger();return{type:"GroupBackReference",value:h}},t.prototype.characterClassEscape=function(){var h,v=!1;switch(this.popChar()){case"d":h=c;break;case"D":h=c,v=!0;break;case"s":h=p;break;case"S":h=p,v=!0;break;case"w":h=f;break;case"W":h=f,v=!0;break}return u(h),{type:"Set",value:h,complement:v}},t.prototype.controlEscapeAtom=function(){var h;switch(this.popChar()){case"f":h=i("\f");break;case"n":h=i(`
`);break;case"r":h=i("\r");break;case"t":h=i("	");break;case"v":h=i("\v");break}return u(h),{type:"Character",value:h}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var h=this.popChar();if(/[a-zA-Z]/.test(h)===!1)throw Error("Invalid ");var v=h.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:v}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){var h=this.popChar();return{type:"Character",value:i(h)}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:var h=this.popChar();return{type:"Character",value:i(h)}}},t.prototype.characterClass=function(){var h=[],v=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),v=!0);this.isClassAtom();){var E=this.classAtom(),g=E.type==="Character";if(g&&this.isRangeDash()){this.consumeChar("-");var m=this.classAtom(),T=m.type==="Character";if(T){if(m.value<E.value)throw Error("Range out of order in character class");h.push({from:E.value,to:m.value})}else s(E.value,h),h.push(i("-")),s(m.value,h)}else s(E.value,h)}return this.consumeChar("]"),{type:"Set",complement:v,value:h}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var h=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),h=!1;break;default:this.groupIdx++;break}var v=this.disjunction();this.consumeChar(")");var E={type:"Group",capturing:h,value:v};return h&&(E.idx=this.groupIdx),E},t.prototype.positiveInteger=function(){var h=this.popChar();if(n.test(h)===!1)throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)h+=this.popChar();return parseInt(h,10)},t.prototype.integerIncludingZero=function(){var h=this.popChar();if(r.test(h)===!1)throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)h+=this.popChar();return parseInt(h,10)},t.prototype.patternCharacter=function(){var h=this.popChar();switch(h){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(h)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return this.peekChar()==="-"&&this.isClassAtom(1)},t.prototype.isDigit=function(){return r.test(this.peekChar(0))},t.prototype.isClassAtom=function(h){switch(h===void 0&&(h=0),this.peekChar(h)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}},t.prototype.isQuantifier=function(){var h=this.saveState();try{return this.quantifier(!0)!==void 0}catch(v){return!1}finally{this.restoreState(h)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(h){for(var v="",E=0;E<h;E++){var g=this.popChar();if(e.test(g)===!1)throw Error("Expecting a HexDecimal digits");v+=g}var m=parseInt(v,16);return{type:"Character",value:m}},t.prototype.peekChar=function(h){return h===void 0&&(h=0),this.input[this.idx+h]},t.prototype.popChar=function(){var h=this.peekChar(0);return this.consumeChar(),h},t.prototype.consumeChar=function(h){if(h!==void 0&&this.input[this.idx]!==h)throw Error("Expected: '"+h+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++},t.prototype.loc=function(h){return{begin:h,end:this.idx}};var e=/[0-9a-fA-F]/,r=/[0-9]/,n=/[1-9]/;function i(h){return h.charCodeAt(0)}function s(h,v){h.length!==void 0?h.forEach(function(E){v.push(E)}):v.push(h)}function l(h,v){if(h[v]===!0)throw"duplicate flag "+v;h[v]=!0}function u(h){if(h===void 0)throw Error("Internal Error - Should never get here!")}function o(){throw Error("Internal Error - Should never get here!")}var a,c=[];for(a=i("0");a<=i("9");a++)c.push(a);var f=[i("_")].concat(c);for(a=i("a");a<=i("z");a++)f.push(a);for(a=i("A");a<=i("Z");a++)f.push(a);var p=[i(" "),i("\f"),i(`
`),i("\r"),i("	"),i("\v"),i("	"),i("\xA0"),i("\u1680"),i("\u2000"),i("\u2001"),i("\u2002"),i("\u2003"),i("\u2004"),i("\u2005"),i("\u2006"),i("\u2007"),i("\u2008"),i("\u2009"),i("\u200A"),i("\u2028"),i("\u2029"),i("\u202F"),i("\u205F"),i("\u3000"),i("\uFEFF")];function d(){}return d.prototype.visitChildren=function(h){for(var v in h){var E=h[v];h.hasOwnProperty(v)&&(E.type!==void 0?this.visit(E):Array.isArray(E)&&E.forEach(function(g){this.visit(g)},this))}},d.prototype.visit=function(h){switch(h.type){case"Pattern":this.visitPattern(h);break;case"Flags":this.visitFlags(h);break;case"Disjunction":this.visitDisjunction(h);break;case"Alternative":this.visitAlternative(h);break;case"StartAnchor":this.visitStartAnchor(h);break;case"EndAnchor":this.visitEndAnchor(h);break;case"WordBoundary":this.visitWordBoundary(h);break;case"NonWordBoundary":this.visitNonWordBoundary(h);break;case"Lookahead":this.visitLookahead(h);break;case"NegativeLookahead":this.visitNegativeLookahead(h);break;case"Character":this.visitCharacter(h);break;case"Set":this.visitSet(h);break;case"Group":this.visitGroup(h);break;case"GroupBackReference":this.visitGroupBackReference(h);break;case"Quantifier":this.visitQuantifier(h);break}this.visitChildren(h)},d.prototype.visitPattern=function(h){},d.prototype.visitFlags=function(h){},d.prototype.visitDisjunction=function(h){},d.prototype.visitAlternative=function(h){},d.prototype.visitStartAnchor=function(h){},d.prototype.visitEndAnchor=function(h){},d.prototype.visitWordBoundary=function(h){},d.prototype.visitNonWordBoundary=function(h){},d.prototype.visitLookahead=function(h){},d.prototype.visitNegativeLookahead=function(h){},d.prototype.visitCharacter=function(h){},d.prototype.visitSet=function(h){},d.prototype.visitGroup=function(h){},d.prototype.visitGroupBackReference=function(h){},d.prototype.visitQuantifier=function(h){},{RegExpParser:t,BaseRegExpVisitor:d,VERSION:"0.5.0"}})});var En=w(cr=>{"use strict";Object.defineProperty(cr,"__esModule",{value:!0});cr.clearRegExpParserCache=cr.getRegExpAst=void 0;var $d=vn(),gn={},Xd=new $d.RegExpParser;function Qd(t){var e=t.toString();if(gn.hasOwnProperty(e))return gn[e];var r=Xd.pattern(e);return gn[e]=r,r}cr.getRegExpAst=Qd;function Zd(){gn={}}cr.clearRegExpParserCache=Zd});var Uu=w(je=>{"use strict";var Jd=je&&je.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(je,"__esModule",{value:!0});je.canMatchCharCode=je.firstCharOptimizedIndices=je.getOptimizedStartCodesIndices=je.failedOptimizationPrefixMsg=void 0;var Mu=vn(),ut=J(),Cu=En(),xt=Ci(),wu="Complement Sets are not supported for first char optimization";je.failedOptimizationPrefixMsg=`Unable to use "first char" lexer optimizations:
`;function jd(t,e){e===void 0&&(e=!1);try{var r=Cu.getRegExpAst(t),n=mn(r.value,{},r.flags.ignoreCase);return n}catch(s){if(s.message===wu)e&&ut.PRINT_WARNING(""+je.failedOptimizationPrefixMsg+("	Unable to optimize: < "+t.toString()+` >
`)+`	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{var i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),ut.PRINT_ERROR(je.failedOptimizationPrefixMsg+`
`+("	Failed parsing: < "+t.toString()+` >
`)+("	Using the regexp-to-ast library version: "+Mu.VERSION+`
`)+"	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}je.getOptimizedStartCodesIndices=jd;function mn(t,e,r){switch(t.type){case"Disjunction":for(var n=0;n<t.value.length;n++)mn(t.value[n],e,r);break;case"Alternative":for(var i=t.value,n=0;n<i.length;n++){var s=i[n];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var l=s;switch(l.type){case"Character":Rn(l.value,e,r);break;case"Set":if(l.complement===!0)throw Error(wu);ut.forEach(l.value,function(a){if(typeof a=="number")Rn(a,e,r);else{var c=a;if(r===!0)for(var f=c.from;f<=c.to;f++)Rn(f,e,r);else{for(var f=c.from;f<=c.to&&f<xt.minOptimizationVal;f++)Rn(f,e,r);if(c.to>=xt.minOptimizationVal)for(var p=c.from>=xt.minOptimizationVal?c.from:xt.minOptimizationVal,d=c.to,h=xt.charCodeToOptimizedIndex(p),v=xt.charCodeToOptimizedIndex(d),E=h;E<=v;E++)e[E]=E}}});break;case"Group":mn(l.value,e,r);break;default:throw Error("Non Exhaustive Match")}var u=l.quantifier!==void 0&&l.quantifier.atLeast===0;if(l.type==="Group"&&Mi(l)===!1||l.type!=="Group"&&u===!1)break}break;default:throw Error("non exhaustive match!")}return ut.values(e)}je.firstCharOptimizedIndices=mn;function Rn(t,e,r){var n=xt.charCodeToOptimizedIndex(t);e[n]=n,r===!0&&e1(t,e)}function e1(t,e){var r=String.fromCharCode(t),n=r.toUpperCase();if(n!==r){var i=xt.charCodeToOptimizedIndex(n.charCodeAt(0));e[i]=i}else{var s=r.toLowerCase();if(s!==r){var i=xt.charCodeToOptimizedIndex(s.charCodeAt(0));e[i]=i}}}function Pu(t,e){return ut.find(t.value,function(r){if(typeof r=="number")return ut.contains(e,r);var n=r;return ut.find(e,function(i){return n.from<=i&&i<=n.to})!==void 0})}function Mi(t){return t.quantifier&&t.quantifier.atLeast===0?!0:t.value?ut.isArray(t.value)?ut.every(t.value,Mi):Mi(t.value):!1}var t1=function(t){Jd(e,t);function e(r){var n=t.call(this)||this;return n.targetCharCodes=r,n.found=!1,n}return e.prototype.visitChildren=function(r){if(this.found!==!0){switch(r.type){case"Lookahead":this.visitLookahead(r);return;case"NegativeLookahead":this.visitNegativeLookahead(r);return}t.prototype.visitChildren.call(this,r)}},e.prototype.visitCharacter=function(r){ut.contains(this.targetCharCodes,r.value)&&(this.found=!0)},e.prototype.visitSet=function(r){r.complement?Pu(r,this.targetCharCodes)===void 0&&(this.found=!0):Pu(r,this.targetCharCodes)!==void 0&&(this.found=!0)},e}(Mu.BaseRegExpVisitor);function r1(t,e){if(e instanceof RegExp){var r=Cu.getRegExpAst(e),n=new t1(t);return n.visit(r),n.found}else return ut.find(e,function(i){return ut.contains(t,i.charCodeAt(0))})!==void 0}je.canMatchCharCode=r1});var Ci=w(x=>{"use strict";var Lu=x&&x.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(x,"__esModule",{value:!0});x.charCodeToOptimizedIndex=x.minOptimizationVal=x.buildLineBreakIssueMessage=x.LineTerminatorOptimizedTester=x.isShortPattern=x.isCustomPattern=x.cloneEmptyGroups=x.performWarningRuntimeChecks=x.performRuntimeChecks=x.addStickyFlag=x.addStartOfInput=x.findUnreachablePatterns=x.findModesThatDoNotExist=x.findInvalidGroupType=x.findDuplicatePatterns=x.findUnsupportedFlags=x.findStartOfInputAnchor=x.findEmptyMatchRegExps=x.findEndOfInputAnchor=x.findInvalidPatterns=x.findMissingPatterns=x.validatePatterns=x.analyzeTokenTypes=x.enableSticky=x.disableSticky=x.SUPPORT_STICKY=x.MODES=x.DEFAULT_MODE=void 0;var xu=vn(),ue=Ur(),C=J(),lr=Uu(),ku=En(),At="PATTERN";x.DEFAULT_MODE="defaultMode";x.MODES="modes";x.SUPPORT_STICKY=typeof new RegExp("(?:)").sticky=="boolean";function n1(){x.SUPPORT_STICKY=!1}x.disableSticky=n1;function i1(){x.SUPPORT_STICKY=!0}x.enableSticky=i1;function o1(t,e){e=C.defaults(e,{useSticky:x.SUPPORT_STICKY,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:function(m,T){return T()}});var r=e.tracer;r("initCharCodeToOptimizedIndexMap",function(){v1()});var n;r("Reject Lexer.NA",function(){n=C.reject(t,function(m){return m[At]===ue.Lexer.NA})});var i=!1,s;r("Transform Patterns",function(){i=!1,s=C.map(n,function(m){var T=m[At];if(C.isRegExp(T)){var A=T.source;return A.length===1&&A!=="^"&&A!=="$"&&A!=="."&&!T.ignoreCase?A:A.length===2&&A[0]==="\\"&&!C.contains(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],A[1])?A[1]:e.useSticky?Pi(T):wi(T)}else{if(C.isFunction(T))return i=!0,{exec:T};if(C.has(T,"exec"))return i=!0,T;if(typeof T=="string"){if(T.length===1)return T;var N=T.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),R=new RegExp(N);return e.useSticky?Pi(R):wi(R)}else throw Error("non exhaustive match")}})});var l,u,o,a,c;r("misc mapping",function(){l=C.map(n,function(m){return m.tokenTypeIdx}),u=C.map(n,function(m){var T=m.GROUP;if(T!==ue.Lexer.SKIPPED){if(C.isString(T))return T;if(C.isUndefined(T))return!1;throw Error("non exhaustive match")}}),o=C.map(n,function(m){var T=m.LONGER_ALT;if(T){var A=C.indexOf(n,T);return A}}),a=C.map(n,function(m){return m.PUSH_MODE}),c=C.map(n,function(m){return C.has(m,"POP_MODE")})});var f;r("Line Terminator Handling",function(){var m=$u(e.lineTerminatorCharacters);f=C.map(n,function(T){return!1}),e.positionTracking!=="onlyOffset"&&(f=C.map(n,function(T){if(C.has(T,"LINE_BREAKS"))return T.LINE_BREAKS;if(zu(T,m)===!1)return lr.canMatchCharCode(m,T.PATTERN)}))});var p,d,h,v;r("Misc Mapping #2",function(){p=C.map(n,Ui),d=C.map(s,Yu),h=C.reduce(n,function(m,T){var A=T.GROUP;return C.isString(A)&&A!==ue.Lexer.SKIPPED&&(m[A]=[]),m},{}),v=C.map(s,function(m,T){return{pattern:s[T],longerAlt:o[T],canLineTerminator:f[T],isCustom:p[T],short:d[T],group:u[T],push:a[T],pop:c[T],tokenTypeIdx:l[T],tokenType:n[T]}})});var E=!0,g=[];return e.safeMode||r("First Char Optimization",function(){g=C.reduce(n,function(m,T,A){if(typeof T.PATTERN=="string"){var N=T.PATTERN.charCodeAt(0),R=xi(N);Li(m,R,v[A])}else if(C.isArray(T.START_CHARS_HINT)){var y;C.forEach(T.START_CHARS_HINT,function(_){var U=typeof _=="string"?_.charCodeAt(0):_,S=xi(U);y!==S&&(y=S,Li(m,S,v[A]))})}else if(C.isRegExp(T.PATTERN))if(T.PATTERN.unicode)E=!1,e.ensureOptimizations&&C.PRINT_ERROR(""+lr.failedOptimizationPrefixMsg+("	Unable to analyze < "+T.PATTERN.toString()+` > pattern.
`)+`	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{var O=lr.getOptimizedStartCodesIndices(T.PATTERN,e.ensureOptimizations);C.isEmpty(O)&&(E=!1),C.forEach(O,function(_){Li(m,_,v[A])})}else e.ensureOptimizations&&C.PRINT_ERROR(""+lr.failedOptimizationPrefixMsg+("	TokenType: <"+T.name+`> is using a custom token pattern without providing <start_chars_hint> parameter.
`)+`	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),E=!1;return m},[])}),r("ArrayPacking",function(){g=C.packArray(g)}),{emptyGroups:h,patternIdxToConfig:v,charCodeToPatternIdxToConfig:g,hasCustom:i,canBeOptimized:E}}x.analyzeTokenTypes=o1;function a1(t,e){var r=[],n=Su(t);r=r.concat(n.errors);var i=bu(n.valid),s=i.valid;return r=r.concat(i.errors),r=r.concat(s1(s)),r=r.concat(Vu(s)),r=r.concat(Wu(s,e)),r=r.concat(Hu(s)),r}x.validatePatterns=a1;function s1(t){var e=[],r=C.filter(t,function(n){return C.isRegExp(n[At])});return e=e.concat(Fu(r)),e=e.concat(Du(r)),e=e.concat(qu(r)),e=e.concat(Gu(r)),e=e.concat(Bu(r)),e}function Su(t){var e=C.filter(t,function(i){return!C.has(i,At)}),r=C.map(e,function(i){return{message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:ue.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[i]}}),n=C.difference(t,e);return{errors:r,valid:n}}x.findMissingPatterns=Su;function bu(t){var e=C.filter(t,function(i){var s=i[At];return!C.isRegExp(s)&&!C.isFunction(s)&&!C.has(s,"exec")&&!C.isString(s)}),r=C.map(e,function(i){return{message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:ue.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[i]}}),n=C.difference(t,e);return{errors:r,valid:n}}x.findInvalidPatterns=bu;var u1=/[^\\][\$]/;function Fu(t){var e=function(i){Lu(s,i);function s(){var l=i!==null&&i.apply(this,arguments)||this;return l.found=!1,l}return s.prototype.visitEndAnchor=function(l){this.found=!0},s}(xu.BaseRegExpVisitor),r=C.filter(t,function(i){var s=i[At];try{var l=ku.getRegExpAst(s),u=new e;return u.visit(l),u.found}catch(o){return u1.test(s.source)}}),n=C.map(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:ue.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}x.findEndOfInputAnchor=Fu;function Bu(t){var e=C.filter(t,function(n){var i=n[At];return i.test("")}),r=C.map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:ue.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[n]}});return r}x.findEmptyMatchRegExps=Bu;var c1=/[^\\[][\^]|^\^/;function Du(t){var e=function(i){Lu(s,i);function s(){var l=i!==null&&i.apply(this,arguments)||this;return l.found=!1,l}return s.prototype.visitStartAnchor=function(l){this.found=!0},s}(xu.BaseRegExpVisitor),r=C.filter(t,function(i){var s=i[At];try{var l=ku.getRegExpAst(s),u=new e;return u.visit(l),u.found}catch(o){return c1.test(s.source)}}),n=C.map(r,function(i){return{message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:ue.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[i]}});return n}x.findStartOfInputAnchor=Du;function qu(t){var e=C.filter(t,function(n){var i=n[At];return i instanceof RegExp&&(i.multiline||i.global)}),r=C.map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:ue.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}});return r}x.findUnsupportedFlags=qu;function Gu(t){var e=[],r=C.map(t,function(s){return C.reduce(t,function(l,u){return s.PATTERN.source===u.PATTERN.source&&!C.contains(e,u)&&u.PATTERN!==ue.Lexer.NA&&(e.push(u),l.push(u)),l},[])});r=C.compact(r);var n=C.filter(r,function(s){return s.length>1}),i=C.map(n,function(s){var l=C.map(s,function(o){return o.name}),u=C.first(s).PATTERN;return{message:"The same RegExp pattern ->"+u+"<-"+("has been used in all of the following Token Types: "+l.join(", ")+" <-"),type:ue.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}});return i}x.findDuplicatePatterns=Gu;function Vu(t){var e=C.filter(t,function(n){if(!C.has(n,"GROUP"))return!1;var i=n.GROUP;return i!==ue.Lexer.SKIPPED&&i!==ue.Lexer.NA&&!C.isString(i)}),r=C.map(e,function(n){return{message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:ue.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}});return r}x.findInvalidGroupType=Vu;function Wu(t,e){var r=C.filter(t,function(i){return i.PUSH_MODE!==void 0&&!C.contains(e,i.PUSH_MODE)}),n=C.map(r,function(i){var s="Token Type: ->"+i.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+i.PUSH_MODE+"<-which does not exist";return{message:s,type:ue.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}});return n}x.findModesThatDoNotExist=Wu;function Hu(t){var e=[],r=C.reduce(t,function(n,i,s){var l=i.PATTERN;return l===ue.Lexer.NA||(C.isString(l)?n.push({str:l,idx:s,tokenType:i}):C.isRegExp(l)&&f1(l)&&n.push({str:l.source,idx:s,tokenType:i})),n},[]);return C.forEach(t,function(n,i){C.forEach(r,function(s){var l=s.str,u=s.idx,o=s.tokenType;if(i<u&&l1(l,n.PATTERN)){var a="Token: ->"+o.name+`<- can never be matched.
`+("Because it appears AFTER the Token Type ->"+n.name+"<-")+`in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:a,type:ue.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[n,o]})}})}),e}x.findUnreachablePatterns=Hu;function l1(t,e){if(C.isRegExp(e)){var r=e.exec(t);return r!==null&&r.index===0}else{if(C.isFunction(e))return e(t,0,[],{});if(C.has(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function f1(t){var e=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return C.find(e,function(r){return t.source.indexOf(r)!==-1})===void 0}function wi(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}x.addStartOfInput=wi;function Pi(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}x.addStickyFlag=Pi;function h1(t,e,r){var n=[];return C.has(t,x.DEFAULT_MODE)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+x.DEFAULT_MODE+`> property in its definition
`,type:ue.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),C.has(t,x.MODES)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+x.MODES+`> property in its definition
`,type:ue.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),C.has(t,x.MODES)&&C.has(t,x.DEFAULT_MODE)&&!C.has(t.modes,t.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+x.DEFAULT_MODE+": <"+t.defaultMode+`>which does not exist
`,type:ue.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),C.has(t,x.MODES)&&C.forEach(t.modes,function(i,s){C.forEach(i,function(l,u){C.isUndefined(l)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:"+("<"+s+"> at index: <"+u+`>
`),type:ue.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}x.performRuntimeChecks=h1;function p1(t,e,r){var n=[],i=!1,s=C.compact(C.flatten(C.mapValues(t.modes,function(o){return o}))),l=C.reject(s,function(o){return o[At]===ue.Lexer.NA}),u=$u(r);return e&&C.forEach(l,function(o){var a=zu(o,u);if(a!==!1){var c=Ku(o,a),f={message:c,type:a.issue,tokenType:o};n.push(f)}else C.has(o,"LINE_BREAKS")?o.LINE_BREAKS===!0&&(i=!0):lr.canMatchCharCode(u,o.PATTERN)&&(i=!0)}),e&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:ue.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}x.performWarningRuntimeChecks=p1;function d1(t){var e={},r=C.keys(t);return C.forEach(r,function(n){var i=t[n];if(C.isArray(i))e[n]=[];else throw Error("non exhaustive match")}),e}x.cloneEmptyGroups=d1;function Ui(t){var e=t.PATTERN;if(C.isRegExp(e))return!1;if(C.isFunction(e))return!0;if(C.has(e,"exec"))return!0;if(C.isString(e))return!1;throw Error("non exhaustive match")}x.isCustomPattern=Ui;function Yu(t){return C.isString(t)&&t.length===1?t.charCodeAt(0):!1}x.isShortPattern=Yu;x.LineTerminatorOptimizedTester={test:function(t){for(var e=t.length,r=this.lastIndex;r<e;r++){var n=t.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return t.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function zu(t,e){if(C.has(t,"LINE_BREAKS"))return!1;if(C.isRegExp(t.PATTERN)){try{lr.canMatchCharCode(e,t.PATTERN)}catch(r){return{issue:ue.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(C.isString(t.PATTERN))return!1;if(Ui(t))return{issue:ue.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Ku(t,e){if(e.issue===ue.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
`+("	The problem is in the <"+t.name+`> Token Type
`)+("	 Root cause: "+e.errMsg+`.
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===ue.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
`+("	The problem is in the <"+t.name+`> Token Type
`)+"	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}x.buildLineBreakIssueMessage=Ku;function $u(t){var e=C.map(t,function(r){return C.isString(r)&&r.length>0?r.charCodeAt(0):r});return e}function Li(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}x.minOptimizationVal=256;function xi(t){return t<x.minOptimizationVal?t:Tn[t]}x.charCodeToOptimizedIndex=xi;var Tn=[];function v1(){if(C.isEmpty(Tn)){Tn=new Array(65536);for(var t=0;t<65536;t++)Tn[t]=t>255?255+~~(t/255):t}}});var fr=w(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.isTokenType=Q.hasExtendingTokensTypesMapProperty=Q.hasExtendingTokensTypesProperty=Q.hasCategoriesProperty=Q.hasShortKeyProperty=Q.singleAssignCategoriesToksMap=Q.assignCategoriesMapProp=Q.assignCategoriesTokensProp=Q.assignTokenDefaultProps=Q.expandCategories=Q.augmentTokenTypes=Q.tokenIdxToClass=Q.tokenShortNameIdx=Q.tokenStructuredMatcherNoCategories=Q.tokenStructuredMatcher=void 0;var _e=J();function g1(t,e){var r=t.tokenTypeIdx;return r===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[r]===!0}Q.tokenStructuredMatcher=g1;function E1(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}Q.tokenStructuredMatcherNoCategories=E1;Q.tokenShortNameIdx=1;Q.tokenIdxToClass={};function m1(t){var e=Xu(t);Qu(e),Ju(e),Zu(e),_e.forEach(e,function(r){r.isParent=r.categoryMatches.length>0})}Q.augmentTokenTypes=m1;function Xu(t){for(var e=_e.cloneArr(t),r=t,n=!0;n;){r=_e.compact(_e.flatten(_e.map(r,function(s){return s.CATEGORIES})));var i=_e.difference(r,e);e=e.concat(i),_e.isEmpty(i)?n=!1:r=i}return e}Q.expandCategories=Xu;function Qu(t){_e.forEach(t,function(e){ju(e)||(Q.tokenIdxToClass[Q.tokenShortNameIdx]=e,e.tokenTypeIdx=Q.tokenShortNameIdx++),Si(e)&&!_e.isArray(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),Si(e)||(e.CATEGORIES=[]),ec(e)||(e.categoryMatches=[]),tc(e)||(e.categoryMatchesMap={})})}Q.assignTokenDefaultProps=Qu;function Zu(t){_e.forEach(t,function(e){e.categoryMatches=[],_e.forEach(e.categoryMatchesMap,function(r,n){e.categoryMatches.push(Q.tokenIdxToClass[n].tokenTypeIdx)})})}Q.assignCategoriesTokensProp=Zu;function Ju(t){_e.forEach(t,function(e){ki([],e)})}Q.assignCategoriesMapProp=Ju;function ki(t,e){_e.forEach(t,function(r){e.categoryMatchesMap[r.tokenTypeIdx]=!0}),_e.forEach(e.CATEGORIES,function(r){var n=t.concat(e);_e.contains(n,r)||ki(n,r)})}Q.singleAssignCategoriesToksMap=ki;function ju(t){return _e.has(t,"tokenTypeIdx")}Q.hasShortKeyProperty=ju;function Si(t){return _e.has(t,"CATEGORIES")}Q.hasCategoriesProperty=Si;function ec(t){return _e.has(t,"categoryMatches")}Q.hasExtendingTokensTypesProperty=ec;function tc(t){return _e.has(t,"categoryMatchesMap")}Q.hasExtendingTokensTypesMapProperty=tc;function R1(t){return _e.has(t,"tokenTypeIdx")}Q.isTokenType=R1});var bi=w(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.defaultLexerErrorProvider=void 0;An.defaultLexerErrorProvider={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,r,n,i){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+","+(" skipped "+r+" characters.")}}});var Ur=w(Jt=>{"use strict";Object.defineProperty(Jt,"__esModule",{value:!0});Jt.Lexer=Jt.LexerDefinitionErrorType=void 0;var vt=Ci(),ce=J(),T1=fr(),A1=bi(),N1=En(),y1;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"})(y1=Jt.LexerDefinitionErrorType||(Jt.LexerDefinitionErrorType={}));var Lr={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:A1.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(Lr);var O1=function(){function t(e,r){var n=this;if(r===void 0&&(r=Lr),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=ce.merge(Lr,r);var i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var s,l=!0;n.TRACE_INIT("Lexer Config handling",function(){if(n.config.lineTerminatorsPattern===Lr.lineTerminatorsPattern)n.config.lineTerminatorsPattern=vt.LineTerminatorOptimizedTester;else if(n.config.lineTerminatorCharacters===Lr.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),ce.isArray(e)?(s={modes:{}},s.modes[vt.DEFAULT_MODE]=ce.cloneArr(e),s[vt.DEFAULT_MODE]=vt.DEFAULT_MODE):(l=!1,s=ce.cloneObj(e))}),n.config.skipValidations===!1&&(n.TRACE_INIT("performRuntimeChecks",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(vt.performRuntimeChecks(s,n.trackStartLines,n.config.lineTerminatorCharacters))}),n.TRACE_INIT("performWarningRuntimeChecks",function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(vt.performWarningRuntimeChecks(s,n.trackStartLines,n.config.lineTerminatorCharacters))})),s.modes=s.modes?s.modes:{},ce.forEach(s.modes,function(c,f){s.modes[f]=ce.reject(c,function(p){return ce.isUndefined(p)})});var u=ce.keys(s.modes);if(ce.forEach(s.modes,function(c,f){n.TRACE_INIT("Mode: <"+f+"> processing",function(){if(n.modes.push(f),n.config.skipValidations===!1&&n.TRACE_INIT("validatePatterns",function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(vt.validatePatterns(c,u))}),ce.isEmpty(n.lexerDefinitionErrors)){T1.augmentTokenTypes(c);var p;n.TRACE_INIT("analyzeTokenTypes",function(){p=vt.analyzeTokenTypes(c,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:n.TRACE_INIT.bind(n)})}),n.patternIdxToConfig[f]=p.patternIdxToConfig,n.charCodeToPatternIdxToConfig[f]=p.charCodeToPatternIdxToConfig,n.emptyGroups=ce.merge(n.emptyGroups,p.emptyGroups),n.hasCustom=p.hasCustom||n.hasCustom,n.canModeBeOptimized[f]=p.canBeOptimized}})}),n.defaultMode=s.defaultMode,!ce.isEmpty(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var o=ce.map(n.lexerDefinitionErrors,function(c){return c.message}),a=o.join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+a)}ce.forEach(n.lexerDefinitionWarning,function(c){ce.PRINT_WARNING(c.message)}),n.TRACE_INIT("Choosing sub-methods implementations",function(){if(vt.SUPPORT_STICKY?(n.chopInput=ce.IDENTITY,n.match=n.matchWithTest):(n.updateLastIndex=ce.NOOP,n.match=n.matchWithExec),l&&(n.handleModes=ce.NOOP),n.trackStartLines===!1&&(n.computeNewColumn=ce.IDENTITY),n.trackEndLines===!1&&(n.updateTokenEndLineColumnLocation=ce.NOOP),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else if(/onlyOffset/i.test(n.config.positionTracking))n.createTokenInstance=n.createOffsetOnlyToken;else throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)}),n.TRACE_INIT("Failed Optimization Warnings",function(){var c=ce.reduce(n.canModeBeOptimized,function(f,p,d){return p===!1&&f.push(d),f},[]);if(r.ensureOptimizations&&!ce.isEmpty(c))throw Error("Lexer Modes: < "+c.join(", ")+` > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),n.TRACE_INIT("clearRegExpParserCache",function(){N1.clearRegExpParserCache()}),n.TRACE_INIT("toFastProperties",function(){ce.toFastProperties(n)})})}return t.prototype.tokenize=function(e,r){if(r===void 0&&(r=this.defaultMode),!ce.isEmpty(this.lexerDefinitionErrors)){var n=ce.map(this.lexerDefinitionErrors,function(l){return l.message}),i=n.join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}var s=this.tokenizeInternal(e,r);return s},t.prototype.tokenizeInternal=function(e,r){var n=this,i,s,l,u,o,a,c,f,p,d,h,v,E,g,m,T=e,A=T.length,N=0,R=0,y=this.hasCustom?0:Math.floor(e.length/10),O=new Array(y),_=[],U=this.trackStartLines?1:void 0,S=this.trackStartLines?1:void 0,B=vt.cloneEmptyGroups(this.emptyGroups),K=this.trackStartLines,W=this.config.lineTerminatorsPattern,F=0,fe=[],Be=[],We=[],nt=[];Object.freeze(nt);var Qe=void 0;function ke(){return fe}function Tt(He){var Or=vt.charCodeToOptimizedIndex(He),nr=Be[Or];return nr===void 0?nt:nr}var $t=function(He){if(We.length===1&&He.tokenType.PUSH_MODE===void 0){var Or=n.config.errorMessageProvider.buildUnableToPopLexerModeMessage(He);_.push({offset:He.startOffset,line:He.startLine!==void 0?He.startLine:void 0,column:He.startColumn!==void 0?He.startColumn:void 0,length:He.image.length,message:Or})}else{We.pop();var nr=ce.last(We);fe=n.patternIdxToConfig[nr],Be=n.charCodeToPatternIdxToConfig[nr],F=fe.length;var r0=n.canModeBeOptimized[nr]&&n.config.safeMode===!1;Be&&r0?Qe=Tt:Qe=ke}};function rr(He){We.push(He),Be=this.charCodeToPatternIdxToConfig[He],fe=this.patternIdxToConfig[He],F=fe.length,F=fe.length;var Or=this.canModeBeOptimized[He]&&this.config.safeMode===!1;Be&&Or?Qe=Tt:Qe=ke}rr.call(this,r);for(var Pe;N<A;){o=null;var Ao=T.charCodeAt(N),No=Qe(Ao),t0=No.length;for(i=0;i<t0;i++){Pe=No[i];var Dt=Pe.pattern;a=null;var Nr=Pe.short;if(Nr!==!1?Ao===Nr&&(o=Dt):Pe.isCustom===!0?(m=Dt.exec(T,N,O,B),m!==null?(o=m[0],m.payload!==void 0&&(a=m.payload)):o=null):(this.updateLastIndex(Dt,N),o=this.match(Dt,e,N)),o!==null){if(u=Pe.longerAlt,u!==void 0){var jn=fe[u],ei=jn.pattern;c=null,jn.isCustom===!0?(m=ei.exec(T,N,O,B),m!==null?(l=m[0],m.payload!==void 0&&(c=m.payload)):l=null):(this.updateLastIndex(ei,N),l=this.match(ei,e,N)),l&&l.length>o.length&&(o=l,a=c,Pe=jn)}break}}if(o!==null){if(f=o.length,p=Pe.group,p!==void 0&&(d=Pe.tokenTypeIdx,h=this.createTokenInstance(o,N,d,Pe.tokenType,U,S,f),this.handlePayload(h,a),p===!1?R=this.addToken(O,R,h):B[p].push(h)),e=this.chopInput(e,f),N=N+f,S=this.computeNewColumn(S,f),K===!0&&Pe.canLineTerminator===!0){var $r=0,ti=void 0,ri=void 0;W.lastIndex=0;do ti=W.test(o),ti===!0&&(ri=W.lastIndex-1,$r++);while(ti===!0);$r!==0&&(U=U+$r,S=f-ri,this.updateTokenEndLineColumnLocation(h,p,ri,$r,U,S,f))}this.handleModes(Pe,$t,rr,h)}else{for(var ni=N,yo=U,Oo=S,yr=!1;!yr&&N<A;)for(E=T.charCodeAt(N),e=this.chopInput(e,1),N++,s=0;s<F;s++){var ii=fe[s],Dt=ii.pattern,Nr=ii.short;if(Nr!==!1?T.charCodeAt(N)===Nr&&(yr=!0):ii.isCustom===!0?yr=Dt.exec(T,N,O,B)!==null:(this.updateLastIndex(Dt,N),yr=Dt.exec(e)!==null),yr===!0)break}v=N-ni,g=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(T,ni,v,yo,Oo),_.push({offset:ni,line:yo,column:Oo,length:v,message:g})}}return this.hasCustom||(O.length=R),{tokens:O,groups:B,errors:_}},t.prototype.handleModes=function(e,r,n,i){if(e.pop===!0){var s=e.push;r(i),s!==void 0&&n.call(this,s)}else e.push!==void 0&&n.call(this,e.push)},t.prototype.chopInput=function(e,r){return e.substring(r)},t.prototype.updateLastIndex=function(e,r){e.lastIndex=r},t.prototype.updateTokenEndLineColumnLocation=function(e,r,n,i,s,l,u){var o,a;r!==void 0&&(o=n===u-1,a=o?-1:0,i===1&&o===!0||(e.endLine=s+a,e.endColumn=l-1+-a))},t.prototype.computeNewColumn=function(e,r){return e+r},t.prototype.createTokenInstance=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return null},t.prototype.createOffsetOnlyToken=function(e,r,n,i){return{image:e,startOffset:r,tokenTypeIdx:n,tokenType:i}},t.prototype.createStartOnlyToken=function(e,r,n,i,s,l){return{image:e,startOffset:r,startLine:s,startColumn:l,tokenTypeIdx:n,tokenType:i}},t.prototype.createFullToken=function(e,r,n,i,s,l,u){return{image:e,startOffset:r,endOffset:r+u-1,startLine:s,endLine:s,startColumn:l,endColumn:l+u-1,tokenTypeIdx:n,tokenType:i}},t.prototype.addToken=function(e,r,n){return 666},t.prototype.addTokenUsingPush=function(e,r,n){return e.push(n),r},t.prototype.addTokenUsingMemberAccess=function(e,r,n){return e[r]=n,r++,r},t.prototype.handlePayload=function(e,r){},t.prototype.handlePayloadNoCustom=function(e,r){},t.prototype.handlePayloadWithCustom=function(e,r){r!==null&&(e.payload=r)},t.prototype.match=function(e,r,n){return null},t.prototype.matchWithTest=function(e,r,n){var i=e.test(r);return i===!0?r.substring(n,e.lastIndex):null},t.prototype.matchWithExec=function(e,r){var n=e.exec(r);return n!==null?n[0]:n},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=ce.timer(r),s=i.time,l=i.value,u=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(n+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,l}else return r()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();Jt.Lexer=O1});var Wt=w(be=>{"use strict";Object.defineProperty(be,"__esModule",{value:!0});be.tokenMatcher=be.createTokenInstance=be.EOF=be.createToken=be.hasTokenLabel=be.tokenName=be.tokenLabel=void 0;var gt=J(),_1=Ur(),Fi=fr();function I1(t){return rc(t)?t.LABEL:t.name}be.tokenLabel=I1;function M1(t){return t.name}be.tokenName=M1;function rc(t){return gt.isString(t.LABEL)&&t.LABEL!==""}be.hasTokenLabel=rc;var C1="parent",nc="categories",ic="label",oc="group",ac="push_mode",sc="pop_mode",uc="longer_alt",cc="line_breaks",lc="start_chars_hint";function fc(t){return w1(t)}be.createToken=fc;function w1(t){var e=t.pattern,r={};if(r.name=t.name,gt.isUndefined(e)||(r.PATTERN=e),gt.has(t,C1))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return gt.has(t,nc)&&(r.CATEGORIES=t[nc]),Fi.augmentTokenTypes([r]),gt.has(t,ic)&&(r.LABEL=t[ic]),gt.has(t,oc)&&(r.GROUP=t[oc]),gt.has(t,sc)&&(r.POP_MODE=t[sc]),gt.has(t,ac)&&(r.PUSH_MODE=t[ac]),gt.has(t,uc)&&(r.LONGER_ALT=t[uc]),gt.has(t,cc)&&(r.LINE_BREAKS=t[cc]),gt.has(t,lc)&&(r.START_CHARS_HINT=t[lc]),r}be.EOF=fc({name:"EOF",pattern:_1.Lexer.NA});Fi.augmentTokenTypes([be.EOF]);function P1(t,e,r,n,i,s,l,u){return{image:e,startOffset:r,endOffset:n,startLine:i,endLine:s,startColumn:l,endColumn:u,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}be.createTokenInstance=P1;function U1(t,e){return Fi.tokenStructuredMatcher(t,e)}be.tokenMatcher=U1});var $e=w(re=>{"use strict";var kt=re&&re.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(re,"__esModule",{value:!0});re.serializeProduction=re.serializeGrammar=re.Terminal=re.Alternation=re.RepetitionWithSeparator=re.Repetition=re.RepetitionMandatoryWithSeparator=re.RepetitionMandatory=re.Option=re.Alternative=re.Rule=re.NonTerminal=re.AbstractProduction=void 0;var ve=J(),L1=Wt(),Nt=function(){function t(e){this._definition=e}return Object.defineProperty(t.prototype,"definition",{get:function(){return this._definition},set:function(e){this._definition=e},enumerable:!1,configurable:!0}),t.prototype.accept=function(e){e.visit(this),ve.forEach(this.definition,function(r){r.accept(e)})},t}();re.AbstractProduction=Nt;var hc=function(t){kt(e,t);function e(r){var n=t.call(this,[])||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this.referencedRule!==void 0?this.referencedRule.definition:[]},set:function(r){},enumerable:!1,configurable:!0}),e.prototype.accept=function(r){r.visit(this)},e}(Nt);re.NonTerminal=hc;var pc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.orgText="",ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.Rule=pc;var dc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.ignoreAmbiguities=!1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.Alternative=dc;var vc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.Option=vc;var gc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.RepetitionMandatory=gc;var Ec=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.RepetitionMandatoryWithSeparator=Ec;var mc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.Repetition=mc;var Rc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return e}(Nt);re.RepetitionWithSeparator=Rc;var Tc=function(t){kt(e,t);function e(r){var n=t.call(this,r.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,ve.assign(n,ve.pick(r,function(i){return i!==void 0})),n}return Object.defineProperty(e.prototype,"definition",{get:function(){return this._definition},set:function(r){this._definition=r},enumerable:!1,configurable:!0}),e}(Nt);re.Alternation=Tc;var Nn=function(){function t(e){this.idx=1,ve.assign(this,ve.pick(e,function(r){return r!==void 0}))}return t.prototype.accept=function(e){e.visit(this)},t}();re.Terminal=Nn;function x1(t){return ve.map(t,xr)}re.serializeGrammar=x1;function xr(t){function e(i){return ve.map(i,xr)}if(t instanceof hc)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof dc)return{type:"Alternative",definition:e(t.definition)};if(t instanceof vc)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof gc)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof Ec)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:xr(new Nn({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Rc)return{type:"RepetitionWithSeparator",idx:t.idx,separator:xr(new Nn({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof mc)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof Tc)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Nn){var r={type:"Terminal",name:t.terminalType.name,label:L1.tokenLabel(t.terminalType),idx:t.idx},n=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(r.pattern=ve.isRegExp(n)?n.source:n),r}else{if(t instanceof pc)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}re.serializeProduction=xr});var On=w(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.RestWalker=void 0;var Bi=J(),et=$e(),k1=function(){function t(){}return t.prototype.walk=function(e,r){var n=this;r===void 0&&(r=[]),Bi.forEach(e.definition,function(i,s){var l=Bi.drop(e.definition,s+1);if(i instanceof et.NonTerminal)n.walkProdRef(i,l,r);else if(i instanceof et.Terminal)n.walkTerminal(i,l,r);else if(i instanceof et.Alternative)n.walkFlat(i,l,r);else if(i instanceof et.Option)n.walkOption(i,l,r);else if(i instanceof et.RepetitionMandatory)n.walkAtLeastOne(i,l,r);else if(i instanceof et.RepetitionMandatoryWithSeparator)n.walkAtLeastOneSep(i,l,r);else if(i instanceof et.RepetitionWithSeparator)n.walkManySep(i,l,r);else if(i instanceof et.Repetition)n.walkMany(i,l,r);else if(i instanceof et.Alternation)n.walkOr(i,l,r);else throw Error("non exhaustive match")})},t.prototype.walkTerminal=function(e,r,n){},t.prototype.walkProdRef=function(e,r,n){},t.prototype.walkFlat=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkOption=function(e,r,n){var i=r.concat(n);this.walk(e,i)},t.prototype.walkAtLeastOne=function(e,r,n){var i=[new et.Option({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkAtLeastOneSep=function(e,r,n){var i=Ac(e,r,n);this.walk(e,i)},t.prototype.walkMany=function(e,r,n){var i=[new et.Option({definition:e.definition})].concat(r,n);this.walk(e,i)},t.prototype.walkManySep=function(e,r,n){var i=Ac(e,r,n);this.walk(e,i)},t.prototype.walkOr=function(e,r,n){var i=this,s=r.concat(n);Bi.forEach(e.definition,function(l){var u=new et.Alternative({definition:[l]});i.walk(u,s)})},t}();yn.RestWalker=k1;function Ac(t,e,r){var n=[new et.Option({definition:[new et.Terminal({terminalType:t.separator})].concat(t.definition)})],i=n.concat(e,r);return i}});var hr=w(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.GAstVisitor=void 0;var yt=$e(),S1=function(){function t(){}return t.prototype.visit=function(e){var r=e;switch(r.constructor){case yt.NonTerminal:return this.visitNonTerminal(r);case yt.Alternative:return this.visitAlternative(r);case yt.Option:return this.visitOption(r);case yt.RepetitionMandatory:return this.visitRepetitionMandatory(r);case yt.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(r);case yt.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(r);case yt.Repetition:return this.visitRepetition(r);case yt.Alternation:return this.visitAlternation(r);case yt.Terminal:return this.visitTerminal(r);case yt.Rule:return this.visitRule(r);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(e){},t.prototype.visitAlternative=function(e){},t.prototype.visitOption=function(e){},t.prototype.visitRepetition=function(e){},t.prototype.visitRepetitionMandatory=function(e){},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){},t.prototype.visitRepetitionWithSeparator=function(e){},t.prototype.visitAlternation=function(e){},t.prototype.visitTerminal=function(e){},t.prototype.visitRule=function(e){},t}();_n.GAstVisitor=S1});var pr=w(qe=>{"use strict";var b1=qe&&qe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(qe,"__esModule",{value:!0});qe.collectMethods=qe.DslMethodsCollectorVisitor=qe.getProductionDslName=qe.isBranchingProd=qe.isOptionalProd=qe.isSequenceProd=void 0;var kr=J(),ge=$e(),F1=hr();function B1(t){return t instanceof ge.Alternative||t instanceof ge.Option||t instanceof ge.Repetition||t instanceof ge.RepetitionMandatory||t instanceof ge.RepetitionMandatoryWithSeparator||t instanceof ge.RepetitionWithSeparator||t instanceof ge.Terminal||t instanceof ge.Rule}qe.isSequenceProd=B1;function Di(t,e){e===void 0&&(e=[]);var r=t instanceof ge.Option||t instanceof ge.Repetition||t instanceof ge.RepetitionWithSeparator;return r?!0:t instanceof ge.Alternation?kr.some(t.definition,function(n){return Di(n,e)}):t instanceof ge.NonTerminal&&kr.contains(e,t)?!1:t instanceof ge.AbstractProduction?(t instanceof ge.NonTerminal&&e.push(t),kr.every(t.definition,function(n){return Di(n,e)})):!1}qe.isOptionalProd=Di;function D1(t){return t instanceof ge.Alternation}qe.isBranchingProd=D1;function q1(t){if(t instanceof ge.NonTerminal)return"SUBRULE";if(t instanceof ge.Option)return"OPTION";if(t instanceof ge.Alternation)return"OR";if(t instanceof ge.RepetitionMandatory)return"AT_LEAST_ONE";if(t instanceof ge.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(t instanceof ge.RepetitionWithSeparator)return"MANY_SEP";if(t instanceof ge.Repetition)return"MANY";if(t instanceof ge.Terminal)return"CONSUME";throw Error("non exhaustive match")}qe.getProductionDslName=q1;var Nc=function(t){b1(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.separator="-",r.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},r}return e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(r){var n=r.terminalType.name+this.separator+"Terminal";kr.has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitNonTerminal=function(r){var n=r.nonTerminalName+this.separator+"Terminal";kr.has(this.dslMethods,n)||(this.dslMethods[n]=[]),this.dslMethods[n].push(r)},e.prototype.visitOption=function(r){this.dslMethods.option.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.dslMethods.repetitionWithSeparator.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.dslMethods.repetitionMandatory.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.dslMethods.repetitionMandatoryWithSeparator.push(r)},e.prototype.visitRepetition=function(r){this.dslMethods.repetition.push(r)},e.prototype.visitAlternation=function(r){this.dslMethods.alternation.push(r)},e}(F1.GAstVisitor);qe.DslMethodsCollectorVisitor=Nc;var In=new Nc;function G1(t){In.reset(),t.accept(In);var e=In.dslMethods;return In.reset(),e}qe.collectMethods=G1});var Gi=w(Ot=>{"use strict";Object.defineProperty(Ot,"__esModule",{value:!0});Ot.firstForTerminal=Ot.firstForBranching=Ot.firstForSequence=Ot.first=void 0;var Mn=J(),yc=$e(),qi=pr();function Cn(t){if(t instanceof yc.NonTerminal)return Cn(t.referencedRule);if(t instanceof yc.Terminal)return Ic(t);if(qi.isSequenceProd(t))return Oc(t);if(qi.isBranchingProd(t))return _c(t);throw Error("non exhaustive match")}Ot.first=Cn;function Oc(t){for(var e=[],r=t.definition,n=0,i=r.length>n,s,l=!0;i&&l;)s=r[n],l=qi.isOptionalProd(s),e=e.concat(Cn(s)),n=n+1,i=r.length>n;return Mn.uniq(e)}Ot.firstForSequence=Oc;function _c(t){var e=Mn.map(t.definition,function(r){return Cn(r)});return Mn.uniq(Mn.flatten(e))}Ot.firstForBranching=_c;function Ic(t){return[t.terminalType]}Ot.firstForTerminal=Ic});var Vi=w(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.IN=void 0;wn.IN="_~IN~_"});var Uc=w(ct=>{"use strict";var V1=ct&&ct.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ct,"__esModule",{value:!0});ct.buildInProdFollowPrefix=ct.buildBetweenProdsFollowPrefix=ct.computeAllProdsFollows=ct.ResyncFollowsWalker=void 0;var W1=On(),H1=Gi(),Mc=J(),Cc=Vi(),Y1=$e(),wc=function(t){V1(e,t);function e(r){var n=t.call(this)||this;return n.topProd=r,n.follows={},n}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(r,n,i){},e.prototype.walkProdRef=function(r,n,i){var s=Pc(r.referencedRule,r.idx)+this.topProd.name,l=n.concat(i),u=new Y1.Alternative({definition:l}),o=H1.first(u);this.follows[s]=o},e}(W1.RestWalker);ct.ResyncFollowsWalker=wc;function z1(t){var e={};return Mc.forEach(t,function(r){var n=new wc(r).startWalking();Mc.assign(e,n)}),e}ct.computeAllProdsFollows=z1;function Pc(t,e){return t.name+e+Cc.IN}ct.buildBetweenProdsFollowPrefix=Pc;function K1(t){var e=t.terminalType.name;return e+t.idx+Cc.IN}ct.buildInProdFollowPrefix=K1});var Sr=w(St=>{"use strict";Object.defineProperty(St,"__esModule",{value:!0});St.defaultGrammarValidatorErrorProvider=St.defaultGrammarResolverErrorProvider=St.defaultParserErrorProvider=void 0;var dr=Wt(),$1=J(),Et=J(),Wi=$e(),Lc=pr();St.defaultParserErrorProvider={buildMismatchTokenMessage:function(t){var e=t.expected,r=t.actual,n=t.previous,i=t.ruleName,s=dr.hasTokenLabel(e),l=s?"--> "+dr.tokenLabel(e)+" <--":"token of type --> "+e.name+" <--",u="Expecting "+l+" but found --> '"+r.image+"' <--";return u},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant,r=t.ruleName;return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,r=t.actual,n=t.previous,i=t.customUserDescription,s=t.ruleName,l="Expecting: ",u=Et.first(r).image,o=`
but found: '`+u+"'";if(i)return l+i+o;var a=Et.reduce(e,function(d,h){return d.concat(h)},[]),c=Et.map(a,function(d){return"["+Et.map(d,function(h){return dr.tokenLabel(h)}).join(", ")+"]"}),f=Et.map(c,function(d,h){return"  "+(h+1)+". "+d}),p=`one of these possible Token sequences:
`+f.join(`
`);return l+p+o},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,r=t.actual,n=t.customUserDescription,i=t.ruleName,s="Expecting: ",l=Et.first(r).image,u=`
but found: '`+l+"'";if(n)return s+n+u;var o=Et.map(e,function(c){return"["+Et.map(c,function(f){return dr.tokenLabel(f)}).join(",")+"]"}),a=`expecting at least one iteration which starts with one of these possible Token sequences::
  `+("<"+o.join(" ,")+">");return s+a+u}};Object.freeze(St.defaultParserErrorProvider);St.defaultGrammarResolverErrorProvider={buildRuleNotFoundError:function(t,e){var r="Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-";return r}};St.defaultGrammarValidatorErrorProvider={buildDuplicateFoundError:function(t,e){function r(c){return c instanceof Wi.Terminal?c.terminalType.name:c instanceof Wi.NonTerminal?c.nonTerminalName:""}var n=t.name,i=Et.first(e),s=i.idx,l=Lc.getProductionDslName(i),u=r(i),o=s>0,a="->"+l+(o?s:"")+"<- "+(u?"with argument: ->"+u+"<-":"")+`
                  appears more than once (`+e.length+" times) in the top level rule: ->"+n+`<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return a=a.replace(/[ \t]+/g," "),a=a.replace(/\s\s+/g,`
`),a},buildNamespaceConflictError:function(t){var e=`Namespace conflict found in grammar.
`+("The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+`>.
`)+`To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`;return e},buildAlternationPrefixAmbiguityError:function(t){var e=Et.map(t.prefixPath,function(i){return dr.tokenLabel(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+`> due to common lookahead prefix
`+("in <OR"+r+"> inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`)+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`;return n},buildAlternationAmbiguityError:function(t){var e=Et.map(t.prefixPath,function(i){return dr.tokenLabel(i)}).join(", "),r=t.alternation.idx===0?"":t.alternation.idx,n="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+r+">"+(" inside <"+t.topLevelRule.name+`> Rule,
`)+("<"+e+`> may appears as a prefix path in all these alternatives.
`);return n=n+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError:function(t){var e=Lc.getProductionDslName(t.repetition);t.repetition.idx!==0&&(e+=t.repetition.idx);var r="The repetition <"+e+"> within Rule <"+t.topLevelRule.name+`> can never consume any tokens.
This could lead to an infinite loop.`;return r},buildTokenNameError:function(t){return"deprecated"},buildEmptyAlternationError:function(t){var e="Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+">"+(" in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
`)+"Only the last alternative may be an empty alternative.";return e},buildTooManyAlternativesError:function(t){var e=`An Alternation cannot have more than 256 alternatives:
`+("<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+`> Rule.
 has `+(t.alternation.definition.length+1)+" alternatives.");return e},buildLeftRecursionError:function(t){var e=t.topLevelRule.name,r=$1.map(t.leftRecursionPath,function(s){return s.name}),n=e+" --> "+r.concat([e]).join(" --> "),i=`Left Recursion found in grammar.
`+("rule: <"+e+`> can be invoked from itself (directly or indirectly)
`)+(`without consuming any Tokens. The grammar path that causes this is: 
 `+n+`
`)+` To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring.`;return i},buildInvalidRuleNameError:function(t){return"deprecated"},buildDuplicateRuleNameError:function(t){var e;t.topLevelRule instanceof Wi.Rule?e=t.topLevelRule.name:e=t.topLevelRule;var r="Duplicate definition, rule: ->"+e+"<- is already defined in the grammar: ->"+t.grammarName+"<-";return r}}});var Sc=w(Ht=>{"use strict";var X1=Ht&&Ht.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ht,"__esModule",{value:!0});Ht.GastRefResolverVisitor=Ht.resolveGrammar=void 0;var Q1=ot(),xc=J(),Z1=hr();function J1(t,e){var r=new kc(t,e);return r.resolveRefs(),r.errors}Ht.resolveGrammar=J1;var kc=function(t){X1(e,t);function e(r,n){var i=t.call(this)||this;return i.nameToTopRule=r,i.errMsgProvider=n,i.errors=[],i}return e.prototype.resolveRefs=function(){var r=this;xc.forEach(xc.values(this.nameToTopRule),function(n){r.currTopLevel=n,n.accept(r)})},e.prototype.visitNonTerminal=function(r){var n=this.nameToTopRule[r.nonTerminalName];if(n)r.referencedRule=n;else{var i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,r);this.errors.push({message:i,type:Q1.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:r.nonTerminalName})}},e}(Z1.GAstVisitor);Ht.GastRefResolverVisitor=kc});var Fr=w(Ne=>{"use strict";var jt=Ne&&Ne.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(Ne,"__esModule",{value:!0});Ne.nextPossibleTokensAfter=Ne.possiblePathsFrom=Ne.NextTerminalAfterAtLeastOneSepWalker=Ne.NextTerminalAfterAtLeastOneWalker=Ne.NextTerminalAfterManySepWalker=Ne.NextTerminalAfterManyWalker=Ne.AbstractNextTerminalAfterProductionWalker=Ne.NextAfterTokenWalker=Ne.AbstractNextPossibleTokensWalker=void 0;var bc=On(),Z=J(),j1=Gi(),X=$e(),Fc=function(t){jt(e,t);function e(r,n){var i=t.call(this)||this;return i.topProd=r,i.path=n,i.possibleTokTypes=[],i.nextProductionName="",i.nextProductionOccurrence=0,i.found=!1,i.isAtEndOfPath=!1,i}return e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Z.cloneArr(this.path.ruleStack).reverse(),this.occurrenceStack=Z.cloneArr(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(r,n){n===void 0&&(n=[]),this.found||t.prototype.walk.call(this,r,n)},e.prototype.walkProdRef=function(r,n,i){if(r.referencedRule.name===this.nextProductionName&&r.idx===this.nextProductionOccurrence){var s=n.concat(i);this.updateExpectedNext(),this.walk(r.referencedRule,s)}},e.prototype.updateExpectedNext=function(){Z.isEmpty(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(bc.RestWalker);Ne.AbstractNextPossibleTokensWalker=Fc;var ev=function(t){jt(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.path=n,i.nextTerminalName="",i.nextTerminalOccurrence=0,i.nextTerminalName=i.path.lastTok.name,i.nextTerminalOccurrence=i.path.lastTokOccurrence,i}return e.prototype.walkTerminal=function(r,n,i){if(this.isAtEndOfPath&&r.terminalType.name===this.nextTerminalName&&r.idx===this.nextTerminalOccurrence&&!this.found){var s=n.concat(i),l=new X.Alternative({definition:s});this.possibleTokTypes=j1.first(l),this.found=!0}},e}(Fc);Ne.NextAfterTokenWalker=ev;var br=function(t){jt(e,t);function e(r,n){var i=t.call(this)||this;return i.topRule=r,i.occurrence=n,i.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},i}return e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(bc.RestWalker);Ne.AbstractNextTerminalAfterProductionWalker=br;var tv=function(t){jt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkMany=function(r,n,i){if(r.idx===this.occurrence){var s=Z.first(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof X.Terminal&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else t.prototype.walkMany.call(this,r,n,i)},e}(br);Ne.NextTerminalAfterManyWalker=tv;var rv=function(t){jt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkManySep=function(r,n,i){if(r.idx===this.occurrence){var s=Z.first(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof X.Terminal&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else t.prototype.walkManySep.call(this,r,n,i)},e}(br);Ne.NextTerminalAfterManySepWalker=rv;var nv=function(t){jt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOne=function(r,n,i){if(r.idx===this.occurrence){var s=Z.first(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof X.Terminal&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else t.prototype.walkAtLeastOne.call(this,r,n,i)},e}(br);Ne.NextTerminalAfterAtLeastOneWalker=nv;var iv=function(t){jt(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.walkAtLeastOneSep=function(r,n,i){if(r.idx===this.occurrence){var s=Z.first(n.concat(i));this.result.isEndOfRule=s===void 0,s instanceof X.Terminal&&(this.result.token=s.terminalType,this.result.occurrence=s.idx)}else t.prototype.walkAtLeastOneSep.call(this,r,n,i)},e}(br);Ne.NextTerminalAfterAtLeastOneSepWalker=iv;function Bc(t,e,r){r===void 0&&(r=[]),r=Z.cloneArr(r);var n=[],i=0;function s(a){return a.concat(Z.drop(t,i+1))}function l(a){var c=Bc(s(a),e,r);return n.concat(c)}for(;r.length<e&&i<t.length;){var u=t[i];if(u instanceof X.Alternative)return l(u.definition);if(u instanceof X.NonTerminal)return l(u.definition);if(u instanceof X.Option)n=l(u.definition);else if(u instanceof X.RepetitionMandatory){var o=u.definition.concat([new X.Repetition({definition:u.definition})]);return l(o)}else if(u instanceof X.RepetitionMandatoryWithSeparator){var o=[new X.Alternative({definition:u.definition}),new X.Repetition({definition:[new X.Terminal({terminalType:u.separator})].concat(u.definition)})];return l(o)}else if(u instanceof X.RepetitionWithSeparator){var o=u.definition.concat([new X.Repetition({definition:[new X.Terminal({terminalType:u.separator})].concat(u.definition)})]);n=l(o)}else if(u instanceof X.Repetition){var o=u.definition.concat([new X.Repetition({definition:u.definition})]);n=l(o)}else{if(u instanceof X.Alternation)return Z.forEach(u.definition,function(a){Z.isEmpty(a.definition)===!1&&(n=l(a.definition))}),n;if(u instanceof X.Terminal)r.push(u.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:Z.drop(t,i)}),n}Ne.possiblePathsFrom=Bc;function ov(t,e,r,n){var i="EXIT_NONE_TERMINAL",s=[i],l="EXIT_ALTERNATIVE",u=!1,o=e.length,a=o-n-1,c=[],f=[];for(f.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Z.isEmpty(f);){var p=f.pop();if(p===l){u&&Z.last(f).idx<=a&&f.pop();continue}var d=p.def,h=p.idx,v=p.ruleStack,E=p.occurrenceStack;if(!Z.isEmpty(d)){var g=d[0];if(g===i){var m={idx:h,def:Z.drop(d),ruleStack:Z.dropRight(v),occurrenceStack:Z.dropRight(E)};f.push(m)}else if(g instanceof X.Terminal)if(h<o-1){var T=h+1,A=e[T];if(r(A,g.terminalType)){var m={idx:T,def:Z.drop(d),ruleStack:v,occurrenceStack:E};f.push(m)}}else if(h===o-1)c.push({nextTokenType:g.terminalType,nextTokenOccurrence:g.idx,ruleStack:v,occurrenceStack:E}),u=!0;else throw Error("non exhaustive match");else if(g instanceof X.NonTerminal){var N=Z.cloneArr(v);N.push(g.nonTerminalName);var R=Z.cloneArr(E);R.push(g.idx);var m={idx:h,def:g.definition.concat(s,Z.drop(d)),ruleStack:N,occurrenceStack:R};f.push(m)}else if(g instanceof X.Option){var y={idx:h,def:Z.drop(d),ruleStack:v,occurrenceStack:E};f.push(y),f.push(l);var O={idx:h,def:g.definition.concat(Z.drop(d)),ruleStack:v,occurrenceStack:E};f.push(O)}else if(g instanceof X.RepetitionMandatory){var _=new X.Repetition({definition:g.definition,idx:g.idx}),U=g.definition.concat([_],Z.drop(d)),m={idx:h,def:U,ruleStack:v,occurrenceStack:E};f.push(m)}else if(g instanceof X.RepetitionMandatoryWithSeparator){var S=new X.Terminal({terminalType:g.separator}),_=new X.Repetition({definition:[S].concat(g.definition),idx:g.idx}),U=g.definition.concat([_],Z.drop(d)),m={idx:h,def:U,ruleStack:v,occurrenceStack:E};f.push(m)}else if(g instanceof X.RepetitionWithSeparator){var y={idx:h,def:Z.drop(d),ruleStack:v,occurrenceStack:E};f.push(y),f.push(l);var S=new X.Terminal({terminalType:g.separator}),B=new X.Repetition({definition:[S].concat(g.definition),idx:g.idx}),U=g.definition.concat([B],Z.drop(d)),O={idx:h,def:U,ruleStack:v,occurrenceStack:E};f.push(O)}else if(g instanceof X.Repetition){var y={idx:h,def:Z.drop(d),ruleStack:v,occurrenceStack:E};f.push(y),f.push(l);var B=new X.Repetition({definition:g.definition,idx:g.idx}),U=g.definition.concat([B],Z.drop(d)),O={idx:h,def:U,ruleStack:v,occurrenceStack:E};f.push(O)}else if(g instanceof X.Alternation)for(var K=g.definition.length-1;K>=0;K--){var W=g.definition[K],F={idx:h,def:W.definition.concat(Z.drop(d)),ruleStack:v,occurrenceStack:E};f.push(F),f.push(l)}else if(g instanceof X.Alternative)f.push({idx:h,def:g.definition.concat(Z.drop(d)),ruleStack:v,occurrenceStack:E});else if(g instanceof X.Rule)f.push(av(g,h,v,E));else throw Error("non exhaustive match")}}return c}Ne.nextPossibleTokensAfter=ov;function av(t,e,r,n){var i=Z.cloneArr(r);i.push(t.name);var s=Z.cloneArr(n);return s.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:s}}});var Br=w(ie=>{"use strict";var Dc=ie&&ie.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ie,"__esModule",{value:!0});ie.areTokenCategoriesNotUsed=ie.isStrictPrefixOfPath=ie.containsPath=ie.getLookaheadPathsForOptionalProd=ie.getLookaheadPathsForOr=ie.lookAheadSequenceFromAlternatives=ie.buildSingleAlternativeLookaheadFunction=ie.buildAlternativesLookAheadFunc=ie.buildLookaheadFuncForOptionalProd=ie.buildLookaheadFuncForOr=ie.getProdType=ie.PROD_TYPE=void 0;var le=J(),qc=Fr(),sv=On(),Pn=fr(),Yt=$e(),uv=hr(),we;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(we=ie.PROD_TYPE||(ie.PROD_TYPE={}));function cv(t){if(t instanceof Yt.Option)return we.OPTION;if(t instanceof Yt.Repetition)return we.REPETITION;if(t instanceof Yt.RepetitionMandatory)return we.REPETITION_MANDATORY;if(t instanceof Yt.RepetitionMandatoryWithSeparator)return we.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof Yt.RepetitionWithSeparator)return we.REPETITION_WITH_SEPARATOR;if(t instanceof Yt.Alternation)return we.ALTERNATION;throw Error("non exhaustive match")}ie.getProdType=cv;function lv(t,e,r,n,i,s){var l=Wc(t,e,r),u=zi(l)?Pn.tokenStructuredMatcherNoCategories:Pn.tokenStructuredMatcher;return s(l,n,u,i)}ie.buildLookaheadFuncForOr=lv;function fv(t,e,r,n,i,s){var l=Hc(t,e,i,r),u=zi(l)?Pn.tokenStructuredMatcherNoCategories:Pn.tokenStructuredMatcher;return s(l[0],u,n)}ie.buildLookaheadFuncForOptionalProd=fv;function hv(t,e,r,n){var i=t.length,s=le.every(t,function(o){return le.every(o,function(a){return a.length===1})});if(e)return function(o){for(var a=le.map(o,function(T){return T.GATE}),c=0;c<i;c++){var f=t[c],p=f.length,d=a[c];if(d!==void 0&&d.call(this)===!1)continue;e:for(var h=0;h<p;h++){for(var v=f[h],E=v.length,g=0;g<E;g++){var m=this.LA(g+1);if(r(m,v[g])===!1)continue e}return c}}};if(s&&!n){var l=le.map(t,function(o){return le.flatten(o)}),u=le.reduce(l,function(o,a,c){return le.forEach(a,function(f){le.has(o,f.tokenTypeIdx)||(o[f.tokenTypeIdx]=c),le.forEach(f.categoryMatches,function(p){le.has(o,p)||(o[p]=c)})}),o},[]);return function(){var o=this.LA(1);return u[o.tokenTypeIdx]}}else return function(){for(var o=0;o<i;o++){var a=t[o],c=a.length;e:for(var f=0;f<c;f++){for(var p=a[f],d=p.length,h=0;h<d;h++){var v=this.LA(h+1);if(r(v,p[h])===!1)continue e}return o}}}}ie.buildAlternativesLookAheadFunc=hv;function pv(t,e,r){var n=le.every(t,function(a){return a.length===1}),i=t.length;if(n&&!r){var s=le.flatten(t);if(s.length===1&&le.isEmpty(s[0].categoryMatches)){var l=s[0],u=l.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===u}}else{var o=le.reduce(s,function(a,c,f){return a[c.tokenTypeIdx]=!0,le.forEach(c.categoryMatches,function(p){a[p]=!0}),a},[]);return function(){var a=this.LA(1);return o[a.tokenTypeIdx]===!0}}}else return function(){e:for(var a=0;a<i;a++){for(var c=t[a],f=c.length,p=0;p<f;p++){var d=this.LA(p+1);if(e(d,c[p])===!1)continue e}return!0}return!1}}ie.buildSingleAlternativeLookaheadFunction=pv;var dv=function(t){Dc(e,t);function e(r,n,i){var s=t.call(this)||this;return s.topProd=r,s.targetOccurrence=n,s.targetProdType=i,s}return e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(r,n,i,s){return r.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(s),!0):!1},e.prototype.walkOption=function(r,n,i){this.checkIsTarget(r,we.OPTION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOne=function(r,n,i){this.checkIsTarget(r,we.REPETITION_MANDATORY,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkAtLeastOneSep=function(r,n,i){this.checkIsTarget(r,we.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkMany=function(r,n,i){this.checkIsTarget(r,we.REPETITION,n,i)||t.prototype.walkOption.call(this,r,n,i)},e.prototype.walkManySep=function(r,n,i){this.checkIsTarget(r,we.REPETITION_WITH_SEPARATOR,n,i)||t.prototype.walkOption.call(this,r,n,i)},e}(sv.RestWalker),Gc=function(t){Dc(e,t);function e(r,n,i){var s=t.call(this)||this;return s.targetOccurrence=r,s.targetProdType=n,s.targetRef=i,s.result=[],s}return e.prototype.checkIsTarget=function(r,n){r.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||r===this.targetRef)&&(this.result=r.definition)},e.prototype.visitOption=function(r){this.checkIsTarget(r,we.OPTION)},e.prototype.visitRepetition=function(r){this.checkIsTarget(r,we.REPETITION)},e.prototype.visitRepetitionMandatory=function(r){this.checkIsTarget(r,we.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.checkIsTarget(r,we.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(r){this.checkIsTarget(r,we.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(r){this.checkIsTarget(r,we.ALTERNATION)},e}(uv.GAstVisitor);function Vc(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=[];return e}function Hi(t){for(var e=[""],r=0;r<t.length;r++){for(var n=t[r],i=[],s=0;s<e.length;s++){var l=e[s];i.push(l+"_"+n.tokenTypeIdx);for(var u=0;u<n.categoryMatches.length;u++){var o="_"+n.categoryMatches[u];i.push(l+o)}}e=i}return e}function vv(t,e,r){for(var n=0;n<t.length;n++)if(n!==r)for(var i=t[n],s=0;s<e.length;s++){var l=e[s];if(i[l]===!0)return!1}return!0}function Yi(t,e){for(var r=le.map(t,function(c){return qc.possiblePathsFrom([c],1)}),n=Vc(r.length),i=le.map(r,function(c){var f={};return le.forEach(c,function(p){var d=Hi(p.partialPath);le.forEach(d,function(h){f[h]=!0})}),f}),s=r,l=1;l<=e;l++){var u=s;s=Vc(u.length);for(var o=function(c){for(var f=u[c],p=0;p<f.length;p++){var d=f[p].partialPath,h=f[p].suffixDef,v=Hi(d),E=vv(i,v,c);if(E||le.isEmpty(h)||d.length===e){var g=n[c];if(Yc(g,d)===!1){g.push(d);for(var m=0;m<v.length;m++){var T=v[m];i[c][T]=!0}}}else{var A=qc.possiblePathsFrom(h,l+1,d);s[c]=s[c].concat(A),le.forEach(A,function(N){var R=Hi(N.partialPath);le.forEach(R,function(y){i[c][y]=!0})})}}},a=0;a<u.length;a++)o(a)}return n}ie.lookAheadSequenceFromAlternatives=Yi;function Wc(t,e,r,n){var i=new Gc(t,we.ALTERNATION,n);return e.accept(i),Yi(i.result,r)}ie.getLookaheadPathsForOr=Wc;function Hc(t,e,r,n){var i=new Gc(t,r);e.accept(i);var s=i.result,l=new dv(e,t,r),u=l.startWalking(),o=new Yt.Alternative({definition:s}),a=new Yt.Alternative({definition:u});return Yi([o,a],n)}ie.getLookaheadPathsForOptionalProd=Hc;function Yc(t,e){e:for(var r=0;r<t.length;r++){var n=t[r];if(n.length===e.length){for(var i=0;i<n.length;i++){var s=e[i],l=n[i],u=s===l||l.categoryMatchesMap[s.tokenTypeIdx]!==void 0;if(u===!1)continue e}return!0}}return!1}ie.containsPath=Yc;function gv(t,e){return t.length<e.length&&le.every(t,function(r,n){var i=e[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}ie.isStrictPrefixOfPath=gv;function zi(t){return le.every(t,function(e){return le.every(e,function(r){return le.every(r,function(n){return le.isEmpty(n.categoryMatches)})})})}ie.areTokenCategoriesNotUsed=zi});var Ji=w(ne=>{"use strict";var Ki=ne&&ne.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(ne,"__esModule",{value:!0});ne.checkPrefixAlternativesAmbiguities=ne.validateSomeNonEmptyLookaheadPath=ne.validateTooManyAlts=ne.RepetionCollector=ne.validateAmbiguousAlternationAlternatives=ne.validateEmptyOrAlternative=ne.getFirstNoneTerminal=ne.validateNoLeftRecursion=ne.validateRuleIsOverridden=ne.validateRuleDoesNotAlreadyExist=ne.OccurrenceValidationCollector=ne.identifyProductionForDuplicates=ne.validateGrammar=void 0;var se=J(),Ee=J(),_t=ot(),$i=pr(),vr=Br(),Ev=Fr(),mt=$e(),Xi=hr();function mv(t,e,r,n,i){var s=se.map(t,function(d){return Rv(d,n)}),l=se.map(t,function(d){return Qi(d,d,n)}),u=[],o=[],a=[];Ee.every(l,Ee.isEmpty)&&(u=Ee.map(t,function(d){return Qc(d,n)}),o=Ee.map(t,function(d){return Zc(d,e,n)}),a=el(t,e,n));var c=Nv(t,r,n),f=Ee.map(t,function(d){return jc(d,n)}),p=Ee.map(t,function(d){return Xc(d,t,i,n)});return se.flatten(s.concat(a,l,u,o,c,f,p))}ne.validateGrammar=mv;function Rv(t,e){var r=new $c;t.accept(r);var n=r.allProductions,i=se.groupBy(n,zc),s=se.pick(i,function(u){return u.length>1}),l=se.map(se.values(s),function(u){var o=se.first(u),a=e.buildDuplicateFoundError(t,u),c=$i.getProductionDslName(o),f={message:a,type:_t.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:c,occurrence:o.idx},p=Kc(o);return p&&(f.parameter=p),f});return l}function zc(t){return $i.getProductionDslName(t)+"_#_"+t.idx+"_#_"+Kc(t)}ne.identifyProductionForDuplicates=zc;function Kc(t){return t instanceof mt.Terminal?t.terminalType.name:t instanceof mt.NonTerminal?t.nonTerminalName:""}var $c=function(t){Ki(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitNonTerminal=function(r){this.allProductions.push(r)},e.prototype.visitOption=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e.prototype.visitAlternation=function(r){this.allProductions.push(r)},e.prototype.visitTerminal=function(r){this.allProductions.push(r)},e}(Xi.GAstVisitor);ne.OccurrenceValidationCollector=$c;function Xc(t,e,r,n){var i=[],s=Ee.reduce(e,function(u,o){return o.name===t.name?u+1:u},0);if(s>1){var l=n.buildDuplicateRuleNameError({topLevelRule:t,grammarName:r});i.push({message:l,type:_t.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}ne.validateRuleDoesNotAlreadyExist=Xc;function Tv(t,e,r){var n=[],i;return se.contains(e,t)||(i="Invalid rule override, rule: ->"+t+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",n.push({message:i,type:_t.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:t})),n}ne.validateRuleIsOverridden=Tv;function Qi(t,e,r,n){n===void 0&&(n=[]);var i=[],s=Dr(e.definition);if(se.isEmpty(s))return[];var l=t.name,u=se.contains(s,t);u&&i.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:n}),type:_t.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:l});var o=se.difference(s,n.concat([t])),a=se.map(o,function(c){var f=se.cloneArr(n);return f.push(c),Qi(t,c,r,f)});return i.concat(se.flatten(a))}ne.validateNoLeftRecursion=Qi;function Dr(t){var e=[];if(se.isEmpty(t))return e;var r=se.first(t);if(r instanceof mt.NonTerminal)e.push(r.referencedRule);else if(r instanceof mt.Alternative||r instanceof mt.Option||r instanceof mt.RepetitionMandatory||r instanceof mt.RepetitionMandatoryWithSeparator||r instanceof mt.RepetitionWithSeparator||r instanceof mt.Repetition)e=e.concat(Dr(r.definition));else if(r instanceof mt.Alternation)e=se.flatten(se.map(r.definition,function(l){return Dr(l.definition)}));else if(!(r instanceof mt.Terminal))throw Error("non exhaustive match");var n=$i.isOptionalProd(r),i=t.length>1;if(n&&i){var s=se.drop(t);return e.concat(Dr(s))}else return e}ne.getFirstNoneTerminal=Dr;var Zi=function(t){Ki(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.alternations=[],r}return e.prototype.visitAlternation=function(r){this.alternations.push(r)},e}(Xi.GAstVisitor);function Qc(t,e){var r=new Zi;t.accept(r);var n=r.alternations,i=se.reduce(n,function(s,l){var u=se.dropRight(l.definition),o=se.map(u,function(a,c){var f=Ev.nextPossibleTokensAfter([a],[],null,1);return se.isEmpty(f)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:l,emptyChoiceIdx:c}),type:_t.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:l.idx,alternative:c+1}:null});return s.concat(se.compact(o))},[]);return i}ne.validateEmptyOrAlternative=Qc;function Zc(t,e,r){var n=new Zi;t.accept(n);var i=n.alternations;i=Ee.reject(i,function(l){return l.ignoreAmbiguities===!0});var s=se.reduce(i,function(l,u){var o=u.idx,a=u.maxLookahead||e,c=vr.getLookaheadPathsForOr(o,t,a,u),f=Av(c,u,t,r),p=tl(c,u,t,r);return l.concat(f,p)},[]);return s}ne.validateAmbiguousAlternationAlternatives=Zc;var Jc=function(t){Ki(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.allProductions=[],r}return e.prototype.visitRepetitionWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatory=function(r){this.allProductions.push(r)},e.prototype.visitRepetitionMandatoryWithSeparator=function(r){this.allProductions.push(r)},e.prototype.visitRepetition=function(r){this.allProductions.push(r)},e}(Xi.GAstVisitor);ne.RepetionCollector=Jc;function jc(t,e){var r=new Zi;t.accept(r);var n=r.alternations,i=se.reduce(n,function(s,l){return l.definition.length>255&&s.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:l}),type:_t.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:t.name,occurrence:l.idx}),s},[]);return i}ne.validateTooManyAlts=jc;function el(t,e,r){var n=[];return Ee.forEach(t,function(i){var s=new Jc;i.accept(s);var l=s.allProductions;Ee.forEach(l,function(u){var o=vr.getProdType(u),a=u.maxLookahead||e,c=u.idx,f=vr.getLookaheadPathsForOptionalProd(c,i,o,a),p=f[0];if(Ee.isEmpty(Ee.flatten(p))){var d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:u});n.push({message:d,type:_t.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}ne.validateSomeNonEmptyLookaheadPath=el;function Av(t,e,r,n){var i=[],s=Ee.reduce(t,function(u,o,a){return e.definition[a].ignoreAmbiguities===!0||Ee.forEach(o,function(c){var f=[a];Ee.forEach(t,function(p,d){a!==d&&vr.containsPath(p,c)&&e.definition[d].ignoreAmbiguities!==!0&&f.push(d)}),f.length>1&&!vr.containsPath(i,c)&&(i.push(c),u.push({alts:f,path:c}))}),u},[]),l=se.map(s,function(u){var o=Ee.map(u.alts,function(c){return c+1}),a=n.buildAlternationAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:o,prefixPath:u.path});return{message:a,type:_t.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:e.idx,alternatives:[u.alts]}});return l}function tl(t,e,r,n){var i=[],s=Ee.reduce(t,function(l,u,o){var a=Ee.map(u,function(c){return{idx:o,path:c}});return l.concat(a)},[]);return Ee.forEach(s,function(l){var u=e.definition[l.idx];if(u.ignoreAmbiguities!==!0){var o=l.idx,a=l.path,c=Ee.findAll(s,function(p){return e.definition[p.idx].ignoreAmbiguities!==!0&&p.idx<o&&vr.isStrictPrefixOfPath(p.path,a)}),f=Ee.map(c,function(p){var d=[p.idx+1,o+1],h=e.idx===0?"":e.idx,v=n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:e,ambiguityIndices:d,prefixPath:p.path});return{message:v,type:_t.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:h,alternatives:d}});i=i.concat(f)}}),i}ne.checkPrefixAlternativesAmbiguities=tl;function Nv(t,e,r){var n=[],i=Ee.map(e,function(s){return s.name});return Ee.forEach(t,function(s){var l=s.name;if(Ee.contains(i,l)){var u=r.buildNamespaceConflictError(s);n.push({message:u,type:_t.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:l})}}),n}});var ji=w(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.assignOccurrenceIndices=zt.validateGrammar=zt.resolveGrammar=void 0;var gr=J(),yv=Sc(),Ov=Ji(),rl=Sr(),_v=pr();function Iv(t){t=gr.defaults(t,{errMsgProvider:rl.defaultGrammarResolverErrorProvider});var e={};return gr.forEach(t.rules,function(r){e[r.name]=r}),yv.resolveGrammar(e,t.errMsgProvider)}zt.resolveGrammar=Iv;function Mv(t){return t=gr.defaults(t,{errMsgProvider:rl.defaultGrammarValidatorErrorProvider}),Ov.validateGrammar(t.rules,t.maxLookahead,t.tokenTypes,t.errMsgProvider,t.grammarName)}zt.validateGrammar=Mv;function Cv(t){gr.forEach(t.rules,function(e){var r=new _v.DslMethodsCollectorVisitor;e.accept(r),gr.forEach(r.dslMethods,function(n){gr.forEach(n,function(i,s){i.idx=s+1})})})}zt.assignOccurrenceIndices=Cv});var Er=w(tt=>{"use strict";var qr=tt&&tt.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(tt,"__esModule",{value:!0});tt.EarlyExitException=tt.NotAllInputParsedException=tt.NoViableAltException=tt.MismatchedTokenException=tt.isRecognitionException=void 0;var wv=J(),nl="MismatchedTokenException",il="NoViableAltException",ol="EarlyExitException",al="NotAllInputParsedException",sl=[nl,il,ol,al];Object.freeze(sl);function Pv(t){return wv.contains(sl,t.name)}tt.isRecognitionException=Pv;var Un=function(t){qr(e,t);function e(r,n){var i=this.constructor,s=t.call(this,r)||this;return s.token=n,s.resyncedTokens=[],Object.setPrototypeOf(s,i.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,s.constructor),s}return e}(Error),Uv=function(t){qr(e,t);function e(r,n,i){var s=t.call(this,r,n)||this;return s.previousToken=i,s.name=nl,s}return e}(Un);tt.MismatchedTokenException=Uv;var Lv=function(t){qr(e,t);function e(r,n,i){var s=t.call(this,r,n)||this;return s.previousToken=i,s.name=il,s}return e}(Un);tt.NoViableAltException=Lv;var xv=function(t){qr(e,t);function e(r,n){var i=t.call(this,r,n)||this;return i.name=al,i}return e}(Un);tt.NotAllInputParsedException=xv;var kv=function(t){qr(e,t);function e(r,n,i){var s=t.call(this,r,n)||this;return s.previousToken=i,s.name=ol,s}return e}(Un);tt.EarlyExitException=kv});var to=w(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});Ge.attemptInRepetitionRecovery=Ge.Recoverable=Ge.InRuleRecoveryException=Ge.IN_RULE_RECOVERY_EXCEPTION=Ge.EOF_FOLLOW_KEY=void 0;var Ln=Wt(),lt=J(),Sv=Er(),bv=Vi(),Fv=ot();Ge.EOF_FOLLOW_KEY={};Ge.IN_RULE_RECOVERY_EXCEPTION="InRuleRecoveryException";function eo(t){this.name=Ge.IN_RULE_RECOVERY_EXCEPTION,this.message=t}Ge.InRuleRecoveryException=eo;eo.prototype=Error.prototype;var Bv=function(){function t(){}return t.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=lt.has(e,"recoveryEnabled")?e.recoveryEnabled:Fv.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=ul)},t.prototype.getTokenToInsert=function(e){var r=Ln.createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r},t.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},t.prototype.tryInRepetitionRecovery=function(e,r,n,i){for(var s=this,l=this.findReSyncTokenType(),u=this.exportLexerState(),o=[],a=!1,c=this.LA(1),f=this.LA(1),p=function(){var d=s.LA(0),h=s.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:s.getCurrRuleFullName()}),v=new Sv.MismatchedTokenException(h,c,s.LA(0));v.resyncedTokens=lt.dropRight(o),s.SAVE_ERROR(v)};!a;)if(this.tokenMatcher(f,i)){p();return}else if(n.call(this)){p(),e.apply(this,r);return}else this.tokenMatcher(f,l)?a=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,o));this.importLexerState(u)},t.prototype.shouldInRepetitionRecoveryBeTried=function(e,r,n){return!(n===!1||e===void 0||r===void 0||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,r)))},t.prototype.getFollowsForInRuleRecovery=function(e,r){var n=this.getCurrentGrammarPath(e,r),i=this.getNextPossibleTokenTypes(n);return i},t.prototype.tryInRuleRecovery=function(e,r){if(this.canRecoverWithSingleTokenInsertion(e,r)){var n=this.getTokenToInsert(e);return n}if(this.canRecoverWithSingleTokenDeletion(e)){var i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new eo("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(e,r){return this.canRecoverWithSingleTokenInsertion(e,r)||this.canRecoverWithSingleTokenDeletion(e)},t.prototype.canRecoverWithSingleTokenInsertion=function(e,r){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||lt.isEmpty(r))return!1;var i=this.LA(1),s=lt.find(r,function(l){return n.tokenMatcher(i,l)})!==void 0;return s},t.prototype.canRecoverWithSingleTokenDeletion=function(e){var r=this.tokenMatcher(this.LA(2),e);return r},t.prototype.isInCurrentRuleReSyncSet=function(e){var r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return lt.contains(n,e)},t.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),r=this.LA(1),n=2;;){var i=r.tokenType;if(lt.contains(e,i))return i;r=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(this.RULE_STACK.length===1)return Ge.EOF_FOLLOW_KEY;var e=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var e=this,r=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return lt.map(r,function(i,s){return s===0?Ge.EOF_FOLLOW_KEY:{ruleName:e.shortRuleNameToFullName(i),idxInCallingRule:n[s],inRule:e.shortRuleNameToFullName(r[s-1])}})},t.prototype.flattenFollowSet=function(){var e=this,r=lt.map(this.buildFullFollowKeyStack(),function(n){return e.getFollowSetFromFollowKey(n)});return lt.flatten(r)},t.prototype.getFollowSetFromFollowKey=function(e){if(e===Ge.EOF_FOLLOW_KEY)return[Ln.EOF];var r=e.ruleName+e.idxInCallingRule+bv.IN+e.inRule;return this.resyncFollows[r]},t.prototype.addToResyncTokens=function(e,r){return this.tokenMatcher(e,Ln.EOF)||r.push(e),r},t.prototype.reSyncTo=function(e){for(var r=[],n=this.LA(1);this.tokenMatcher(n,e)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return lt.dropRight(r)},t.prototype.attemptInRepetitionRecovery=function(e,r,n,i,s,l,u){},t.prototype.getCurrentGrammarPath=function(e,r){var n=this.getHumanReadableRuleStack(),i=lt.cloneArr(this.RULE_OCCURRENCE_STACK),s={ruleStack:n,occurrenceStack:i,lastTok:e,lastTokOccurrence:r};return s},t.prototype.getHumanReadableRuleStack=function(){var e=this;return lt.map(this.RULE_STACK,function(r){return e.shortRuleNameToFullName(r)})},t}();Ge.Recoverable=Bv;function ul(t,e,r,n,i,s,l){var u=this.getKeyForAutomaticLookahead(n,i),o=this.firstAfterRepMap[u];if(o===void 0){var a=this.getCurrRuleFullName(),c=this.getGAstProductions()[a],f=new s(c,i);o=f.startWalking(),this.firstAfterRepMap[u]=o}var p=o.token,d=o.occurrence,h=o.isEndOfRule;this.RULE_STACK.length===1&&h&&p===void 0&&(p=Ln.EOF,d=1),this.shouldInRepetitionRecoveryBeTried(p,d,l)&&this.tryInRepetitionRecovery(t,e,r,p)}Ge.attemptInRepetitionRecovery=ul});var xn=w(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.getKeyForAutomaticLookahead=j.AT_LEAST_ONE_SEP_IDX=j.MANY_SEP_IDX=j.AT_LEAST_ONE_IDX=j.MANY_IDX=j.OPTION_IDX=j.OR_IDX=j.BITS_FOR_ALT_IDX=j.BITS_FOR_RULE_IDX=j.BITS_FOR_OCCURRENCE_IDX=j.BITS_FOR_METHOD_TYPE=void 0;j.BITS_FOR_METHOD_TYPE=4;j.BITS_FOR_OCCURRENCE_IDX=8;j.BITS_FOR_RULE_IDX=12;j.BITS_FOR_ALT_IDX=8;j.OR_IDX=1<<j.BITS_FOR_OCCURRENCE_IDX;j.OPTION_IDX=2<<j.BITS_FOR_OCCURRENCE_IDX;j.MANY_IDX=3<<j.BITS_FOR_OCCURRENCE_IDX;j.AT_LEAST_ONE_IDX=4<<j.BITS_FOR_OCCURRENCE_IDX;j.MANY_SEP_IDX=5<<j.BITS_FOR_OCCURRENCE_IDX;j.AT_LEAST_ONE_SEP_IDX=6<<j.BITS_FOR_OCCURRENCE_IDX;function Dv(t,e,r){return r|e|t}j.getKeyForAutomaticLookahead=Dv;var qR=32-j.BITS_FOR_ALT_IDX});var ll=w(kn=>{"use strict";Object.defineProperty(kn,"__esModule",{value:!0});kn.LooksAhead=void 0;var bt=Br(),Rt=J(),cl=ot(),Ft=xn(),er=pr(),qv=function(){function t(){}return t.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Rt.has(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:cl.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=Rt.has(e,"maxLookahead")?e.maxLookahead:cl.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=Rt.isES2015MapSupported()?new Map:[],Rt.isES2015MapSupported()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(e){var r=this;Rt.forEach(e,function(n){r.TRACE_INIT(n.name+" Rule Lookahead",function(){var i=er.collectMethods(n),s=i.alternation,l=i.repetition,u=i.option,o=i.repetitionMandatory,a=i.repetitionMandatoryWithSeparator,c=i.repetitionWithSeparator;Rt.forEach(s,function(f){var p=f.idx===0?"":f.idx;r.TRACE_INIT(""+er.getProductionDslName(f)+p,function(){var d=bt.buildLookaheadFuncForOr(f.idx,n,f.maxLookahead||r.maxLookahead,f.hasPredicates,r.dynamicTokensEnabled,r.lookAheadBuilderForAlternatives),h=Ft.getKeyForAutomaticLookahead(r.fullRuleNameToShort[n.name],Ft.OR_IDX,f.idx);r.setLaFuncCache(h,d)})}),Rt.forEach(l,function(f){r.computeLookaheadFunc(n,f.idx,Ft.MANY_IDX,bt.PROD_TYPE.REPETITION,f.maxLookahead,er.getProductionDslName(f))}),Rt.forEach(u,function(f){r.computeLookaheadFunc(n,f.idx,Ft.OPTION_IDX,bt.PROD_TYPE.OPTION,f.maxLookahead,er.getProductionDslName(f))}),Rt.forEach(o,function(f){r.computeLookaheadFunc(n,f.idx,Ft.AT_LEAST_ONE_IDX,bt.PROD_TYPE.REPETITION_MANDATORY,f.maxLookahead,er.getProductionDslName(f))}),Rt.forEach(a,function(f){r.computeLookaheadFunc(n,f.idx,Ft.AT_LEAST_ONE_SEP_IDX,bt.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,f.maxLookahead,er.getProductionDslName(f))}),Rt.forEach(c,function(f){r.computeLookaheadFunc(n,f.idx,Ft.MANY_SEP_IDX,bt.PROD_TYPE.REPETITION_WITH_SEPARATOR,f.maxLookahead,er.getProductionDslName(f))})})})},t.prototype.computeLookaheadFunc=function(e,r,n,i,s,l){var u=this;this.TRACE_INIT(""+l+(r===0?"":r),function(){var o=bt.buildLookaheadFuncForOptionalProd(r,e,s||u.maxLookahead,u.dynamicTokensEnabled,i,u.lookAheadBuilderForOptional),a=Ft.getKeyForAutomaticLookahead(u.fullRuleNameToShort[e.name],n,r);u.setLaFuncCache(a,o)})},t.prototype.lookAheadBuilderForOptional=function(e,r,n){return bt.buildSingleAlternativeLookaheadFunction(e,r,n)},t.prototype.lookAheadBuilderForAlternatives=function(e,r,n,i){return bt.buildAlternativesLookAheadFunc(e,r,n,i)},t.prototype.getKeyForAutomaticLookahead=function(e,r){var n=this.getLastExplicitRuleShortName();return Ft.getKeyForAutomaticLookahead(n,e,r)},t.prototype.getLaFuncFromCache=function(e){},t.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},t.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},t.prototype.setLaFuncCache=function(e,r){},t.prototype.setLaFuncCacheUsingMap=function(e,r){this.lookAheadFuncsCache.set(e,r)},t.prototype.setLaFuncUsingObj=function(e,r){this.lookAheadFuncsCache[e]=r},t}();kn.LooksAhead=qv});var fl=w(It=>{"use strict";Object.defineProperty(It,"__esModule",{value:!0});It.addNoneTerminalToCst=It.addTerminalToCst=It.setNodeLocationFull=It.setNodeLocationOnlyOffset=void 0;function Gv(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}It.setNodeLocationOnlyOffset=Gv;function Vv(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}It.setNodeLocationFull=Vv;function Wv(t,e,r){t.children[r]===void 0?t.children[r]=[e]:t.children[r].push(e)}It.addTerminalToCst=Wv;function Hv(t,e,r){t.children[e]===void 0?t.children[e]=[r]:t.children[e].push(r)}It.addNoneTerminalToCst=Hv});var ro=w(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.defineNameProp=Kt.functionName=Kt.classNameFromInstance=void 0;var Yv=J();function zv(t){return pl(t.constructor)}Kt.classNameFromInstance=zv;var hl="name";function pl(t){var e=t.name;return e||"anonymous"}Kt.functionName=pl;function Kv(t,e){var r=Object.getOwnPropertyDescriptor(t,hl);return Yv.isUndefined(r)||r.configurable?(Object.defineProperty(t,hl,{enumerable:!1,configurable:!0,writable:!1,value:e}),!0):!1}Kt.defineNameProp=Kv});var ml=w(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.validateRedundantMethods=Fe.validateMissingCstMethods=Fe.validateVisitor=Fe.CstVisitorDefinitionError=Fe.createBaseVisitorConstructorWithDefaults=Fe.createBaseSemanticVisitorConstructor=Fe.defaultVisit=void 0;var ft=J(),Gr=ro();function dl(t,e){for(var r=ft.keys(t),n=r.length,i=0;i<n;i++)for(var s=r[i],l=t[s],u=l.length,o=0;o<u;o++){var a=l[o];a.tokenTypeIdx===void 0&&this[a.name](a.children,e)}}Fe.defaultVisit=dl;function $v(t,e){var r=function(){};Gr.defineNameProp(r,t+"BaseSemantics");var n={visit:function(i,s){if(ft.isArray(i)&&(i=i[0]),!ft.isUndefined(i))return this[i.name](i.children,s)},validateVisitor:function(){var i=vl(this,e);if(!ft.isEmpty(i)){var s=ft.map(i,function(l){return l.msg});throw Error("Errors Detected in CST Visitor <"+Gr.functionName(this.constructor)+`>:
	`+(""+s.join(`

`).replace(/\n/g,`
	`)))}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=e,r}Fe.createBaseSemanticVisitorConstructor=$v;function Xv(t,e,r){var n=function(){};Gr.defineNameProp(n,t+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return ft.forEach(e,function(s){i[s]=dl}),n.prototype=i,n.prototype.constructor=n,n}Fe.createBaseVisitorConstructorWithDefaults=Xv;var no;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(no=Fe.CstVisitorDefinitionError||(Fe.CstVisitorDefinitionError={}));function vl(t,e){var r=gl(t,e),n=El(t,e);return r.concat(n)}Fe.validateVisitor=vl;function gl(t,e){var r=ft.map(e,function(n){if(!ft.isFunction(t[n]))return{msg:"Missing visitor method: <"+n+"> on "+Gr.functionName(t.constructor)+" CST Visitor.",type:no.MISSING_METHOD,methodName:n}});return ft.compact(r)}Fe.validateMissingCstMethods=gl;var Qv=["constructor","visit","validateVisitor"];function El(t,e){var r=[];for(var n in t)ft.isFunction(t[n])&&!ft.contains(Qv,n)&&!ft.contains(e,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+Gr.functionName(t.constructor)+` CST Visitor
There is no Grammar Rule corresponding to this method's name.
`,type:no.REDUNDANT_METHOD,methodName:n});return r}Fe.validateRedundantMethods=El});var Tl=w(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.TreeBuilder=void 0;var mr=fl(),Ie=J(),Rl=ml(),Zv=ot(),Jv=function(){function t(){}return t.prototype.initTreeBuilder=function(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Ie.has(e,"nodeLocationTracking")?e.nodeLocationTracking:Zv.DEFAULT_PARSER_CONFIG.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Ie.NOOP,this.cstFinallyStateUpdate=Ie.NOOP,this.cstPostTerminal=Ie.NOOP,this.cstPostNonTerminal=Ie.NOOP,this.cstPostRule=Ie.NOOP;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=mr.setNodeLocationFull,this.setNodeLocationFromNode=mr.setNodeLocationFull,this.cstPostRule=Ie.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Ie.NOOP,this.setNodeLocationFromNode=Ie.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=mr.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=mr.setNodeLocationOnlyOffset,this.cstPostRule=Ie.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Ie.NOOP,this.setNodeLocationFromNode=Ie.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Ie.NOOP,this.setNodeLocationFromNode=Ie.NOOP,this.cstPostRule=Ie.NOOP,this.setInitialNodeLocation=Ie.NOOP;else throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"')},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(e){var r=this.LA(1);e.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstInvocationStateUpdate=function(e,r){var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.CST_STACK.pop()},t.prototype.cstPostRuleFull=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(e){var r=this.LA(0),n=e.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(e,r){var n=this.CST_STACK[this.CST_STACK.length-1];mr.addTerminalToCst(n,r,e),this.setNodeLocationFromToken(n.location,r)},t.prototype.cstPostNonTerminal=function(e,r){var n=this.CST_STACK[this.CST_STACK.length-1];mr.addNoneTerminalToCst(n,r,e),this.setNodeLocationFromNode(n.location,e.location)},t.prototype.getBaseCstVisitorConstructor=function(){if(Ie.isUndefined(this.baseCstVisitorConstructor)){var e=Rl.createBaseSemanticVisitorConstructor(this.className,Ie.keys(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Ie.isUndefined(this.baseCstVisitorWithDefaultsConstructor)){var e=Rl.createBaseVisitorConstructorWithDefaults(this.className,Ie.keys(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.getLastExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var e=this.RULE_STACK;return e[e.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},t}();Sn.TreeBuilder=Jv});var Nl=w(bn=>{"use strict";Object.defineProperty(bn,"__esModule",{value:!0});bn.LexerAdapter=void 0;var Al=ot(),jv=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!1,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):Al.END_OF_FILE},t.prototype.LA=function(e){var r=this.currIdx+e;return r<0||this.tokVectorLength<=r?Al.END_OF_FILE:this.tokVector[r]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(e){this.currIdx=e},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}();bn.LexerAdapter=jv});var Ol=w(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.RecognizerApi=void 0;var yl=J(),eg=Er(),io=ot(),tg=Sr(),rg=Ji(),ng=$e(),ig=function(){function t(){}return t.prototype.ACTION=function(e){return e.call(this)},t.prototype.consume=function(e,r,n){return this.consumeInternal(r,e,n)},t.prototype.subrule=function(e,r,n){return this.subruleInternal(r,e,n)},t.prototype.option=function(e,r){return this.optionInternal(r,e)},t.prototype.or=function(e,r){return this.orInternal(r,e)},t.prototype.many=function(e,r){return this.manyInternal(e,r)},t.prototype.atLeastOne=function(e,r){return this.atLeastOneInternal(e,r)},t.prototype.CONSUME=function(e,r){return this.consumeInternal(e,0,r)},t.prototype.CONSUME1=function(e,r){return this.consumeInternal(e,1,r)},t.prototype.CONSUME2=function(e,r){return this.consumeInternal(e,2,r)},t.prototype.CONSUME3=function(e,r){return this.consumeInternal(e,3,r)},t.prototype.CONSUME4=function(e,r){return this.consumeInternal(e,4,r)},t.prototype.CONSUME5=function(e,r){return this.consumeInternal(e,5,r)},t.prototype.CONSUME6=function(e,r){return this.consumeInternal(e,6,r)},t.prototype.CONSUME7=function(e,r){return this.consumeInternal(e,7,r)},t.prototype.CONSUME8=function(e,r){return this.consumeInternal(e,8,r)},t.prototype.CONSUME9=function(e,r){return this.consumeInternal(e,9,r)},t.prototype.SUBRULE=function(e,r){return this.subruleInternal(e,0,r)},t.prototype.SUBRULE1=function(e,r){return this.subruleInternal(e,1,r)},t.prototype.SUBRULE2=function(e,r){return this.subruleInternal(e,2,r)},t.prototype.SUBRULE3=function(e,r){return this.subruleInternal(e,3,r)},t.prototype.SUBRULE4=function(e,r){return this.subruleInternal(e,4,r)},t.prototype.SUBRULE5=function(e,r){return this.subruleInternal(e,5,r)},t.prototype.SUBRULE6=function(e,r){return this.subruleInternal(e,6,r)},t.prototype.SUBRULE7=function(e,r){return this.subruleInternal(e,7,r)},t.prototype.SUBRULE8=function(e,r){return this.subruleInternal(e,8,r)},t.prototype.SUBRULE9=function(e,r){return this.subruleInternal(e,9,r)},t.prototype.OPTION=function(e){return this.optionInternal(e,0)},t.prototype.OPTION1=function(e){return this.optionInternal(e,1)},t.prototype.OPTION2=function(e){return this.optionInternal(e,2)},t.prototype.OPTION3=function(e){return this.optionInternal(e,3)},t.prototype.OPTION4=function(e){return this.optionInternal(e,4)},t.prototype.OPTION5=function(e){return this.optionInternal(e,5)},t.prototype.OPTION6=function(e){return this.optionInternal(e,6)},t.prototype.OPTION7=function(e){return this.optionInternal(e,7)},t.prototype.OPTION8=function(e){return this.optionInternal(e,8)},t.prototype.OPTION9=function(e){return this.optionInternal(e,9)},t.prototype.OR=function(e){return this.orInternal(e,0)},t.prototype.OR1=function(e){return this.orInternal(e,1)},t.prototype.OR2=function(e){return this.orInternal(e,2)},t.prototype.OR3=function(e){return this.orInternal(e,3)},t.prototype.OR4=function(e){return this.orInternal(e,4)},t.prototype.OR5=function(e){return this.orInternal(e,5)},t.prototype.OR6=function(e){return this.orInternal(e,6)},t.prototype.OR7=function(e){return this.orInternal(e,7)},t.prototype.OR8=function(e){return this.orInternal(e,8)},t.prototype.OR9=function(e){return this.orInternal(e,9)},t.prototype.MANY=function(e){this.manyInternal(0,e)},t.prototype.MANY1=function(e){this.manyInternal(1,e)},t.prototype.MANY2=function(e){this.manyInternal(2,e)},t.prototype.MANY3=function(e){this.manyInternal(3,e)},t.prototype.MANY4=function(e){this.manyInternal(4,e)},t.prototype.MANY5=function(e){this.manyInternal(5,e)},t.prototype.MANY6=function(e){this.manyInternal(6,e)},t.prototype.MANY7=function(e){this.manyInternal(7,e)},t.prototype.MANY8=function(e){this.manyInternal(8,e)},t.prototype.MANY9=function(e){this.manyInternal(9,e)},t.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},t.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},t.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},t.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},t.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},t.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},t.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},t.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},t.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},t.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},t.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},t.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},t.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},t.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},t.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},t.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},t.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},t.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},t.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},t.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},t.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},t.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},t.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},t.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},t.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},t.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},t.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},t.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},t.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},t.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},t.prototype.RULE=function(e,r,n){if(n===void 0&&(n=io.DEFAULT_RULE_CONFIG),yl.contains(this.definedRulesNames,e)){var i=tg.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),s={message:i,type:io.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(s)}this.definedRulesNames.push(e);var l=this.defineRule(e,r,n);return this[e]=l,l},t.prototype.OVERRIDE_RULE=function(e,r,n){n===void 0&&(n=io.DEFAULT_RULE_CONFIG);var i=[];i=i.concat(rg.validateRuleIsOverridden(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,i);var s=this.defineRule(e,r,n);return this[e]=s,s},t.prototype.BACKTRACK=function(e,r){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,r),!0}catch(i){if(eg.isRecognitionException(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return ng.serializeGrammar(yl.values(this.gastProductionsCache))},t}();Fn.RecognizerApi=ig});var Cl=w(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.RecognizerEngine=void 0;var Re=J(),at=xn(),Bn=Er(),_l=Br(),Rr=Fr(),Il=ot(),og=to(),Ml=Wt(),Vr=fr(),ag=ro(),sg=function(){function t(){}return t.prototype.initRecognizerEngine=function(e,r){if(this.className=ag.classNameFromInstance(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=Vr.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Re.has(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(Re.isArray(e)){if(Re.isEmpty(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(Re.isArray(e))this.tokensMap=Re.reduce(e,function(l,u){return l[u.name]=u,l},{});else if(Re.has(e,"modes")&&Re.every(Re.flatten(Re.values(e.modes)),Vr.isTokenType)){var n=Re.flatten(Re.values(e.modes)),i=Re.uniq(n);this.tokensMap=Re.reduce(i,function(l,u){return l[u.name]=u,l},{})}else if(Re.isObject(e))this.tokensMap=Re.cloneObj(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=Ml.EOF;var s=Re.every(Re.values(e),function(l){return Re.isEmpty(l.categoryMatches)});this.tokenMatcher=s?Vr.tokenStructuredMatcherNoCategories:Vr.tokenStructuredMatcher,Vr.augmentTokenTypes(Re.values(this.tokensMap))},t.prototype.defineRule=function(e,r,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+`> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);var i=Re.has(n,"resyncEnabled")?n.resyncEnabled:Il.DEFAULT_RULE_CONFIG.resyncEnabled,s=Re.has(n,"recoveryValueFunc")?n.recoveryValueFunc:Il.DEFAULT_RULE_CONFIG.recoveryValueFunc,l=this.ruleShortNameIdx<<at.BITS_FOR_METHOD_TYPE+at.BITS_FOR_OCCURRENCE_IDX;this.ruleShortNameIdx++,this.shortRuleNameToFull[l]=e,this.fullRuleNameToShort[e]=l;function u(c){try{if(this.outputCst===!0){r.apply(this,c);var f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}else return r.apply(this,c)}catch(p){return this.invokeRuleCatch(p,i,s)}finally{this.ruleFinallyStateUpdate()}}var o;o=function(c,f){return c===void 0&&(c=0),this.ruleInvocationStateUpdate(l,e,c),u.call(this,f)};var a="ruleName";return o[a]=e,o.originalGrammarAction=r,o},t.prototype.invokeRuleCatch=function(e,r,n){var i=this.RULE_STACK.length===1,s=r&&!this.isBackTracking()&&this.recoveryEnabled;if(Bn.isRecognitionException(e)){var l=e;if(s){var u=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(u))if(l.resyncedTokens=this.reSyncTo(u),this.outputCst){var o=this.CST_STACK[this.CST_STACK.length-1];return o.recoveredNode=!0,o}else return n();else{if(this.outputCst){var o=this.CST_STACK[this.CST_STACK.length-1];o.recoveredNode=!0,l.partialCstResult=o}throw l}}else{if(i)return this.moveToTerminatedState(),n();throw l}}else throw e},t.prototype.optionInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.OPTION_IDX,r);return this.optionInternalLogic(e,r,n)},t.prototype.optionInternalLogic=function(e,r,n){var i=this,s=this.getLaFuncFromCache(n),l,u;if(e.DEF!==void 0){if(l=e.DEF,u=e.GATE,u!==void 0){var o=s;s=function(){return u.call(i)&&o.call(i)}}}else l=e;if(s.call(this)===!0)return l.call(this)},t.prototype.atLeastOneInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.AT_LEAST_ONE_IDX,e);return this.atLeastOneInternalLogic(e,r,n)},t.prototype.atLeastOneInternalLogic=function(e,r,n){var i=this,s=this.getLaFuncFromCache(n),l,u;if(r.DEF!==void 0){if(l=r.DEF,u=r.GATE,u!==void 0){var o=s;s=function(){return u.call(i)&&o.call(i)}}}else l=r;if(s.call(this)===!0)for(var a=this.doSingleRepetition(l);s.call(this)===!0&&a===!0;)a=this.doSingleRepetition(l);else throw this.raiseEarlyExitException(e,_l.PROD_TYPE.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,r],s,at.AT_LEAST_ONE_IDX,e,Rr.NextTerminalAfterAtLeastOneWalker)},t.prototype.atLeastOneSepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,r,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(e,r,n){var i=this,s=r.DEF,l=r.SEP,u=this.getLaFuncFromCache(n);if(u.call(this)===!0){s.call(this);for(var o=function(){return i.tokenMatcher(i.LA(1),l)};this.tokenMatcher(this.LA(1),l)===!0;)this.CONSUME(l),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,l,o,s,Rr.NextTerminalAfterAtLeastOneSepWalker],o,at.AT_LEAST_ONE_SEP_IDX,e,Rr.NextTerminalAfterAtLeastOneSepWalker)}else throw this.raiseEarlyExitException(e,_l.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)},t.prototype.manyInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.MANY_IDX,e);return this.manyInternalLogic(e,r,n)},t.prototype.manyInternalLogic=function(e,r,n){var i=this,s=this.getLaFuncFromCache(n),l,u;if(r.DEF!==void 0){if(l=r.DEF,u=r.GATE,u!==void 0){var o=s;s=function(){return u.call(i)&&o.call(i)}}}else l=r;for(var a=!0;s.call(this)===!0&&a===!0;)a=this.doSingleRepetition(l);this.attemptInRepetitionRecovery(this.manyInternal,[e,r],s,at.MANY_IDX,e,Rr.NextTerminalAfterManyWalker,a)},t.prototype.manySepFirstInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,r,n)},t.prototype.manySepFirstInternalLogic=function(e,r,n){var i=this,s=r.DEF,l=r.SEP,u=this.getLaFuncFromCache(n);if(u.call(this)===!0){s.call(this);for(var o=function(){return i.tokenMatcher(i.LA(1),l)};this.tokenMatcher(this.LA(1),l)===!0;)this.CONSUME(l),s.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,l,o,s,Rr.NextTerminalAfterManySepWalker],o,at.MANY_SEP_IDX,e,Rr.NextTerminalAfterManySepWalker)}},t.prototype.repetitionSepSecondInternal=function(e,r,n,i,s){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,r,n,i,s],n,at.AT_LEAST_ONE_SEP_IDX,e,s)},t.prototype.doSingleRepetition=function(e){var r=this.getLexerPosition();e.call(this);var n=this.getLexerPosition();return n>r},t.prototype.orInternal=function(e,r){var n=this.getKeyForAutomaticLookahead(at.OR_IDX,r),i=Re.isArray(e)?e:e.DEF,s=this.getLaFuncFromCache(n),l=s.call(this,i);if(l!==void 0){var u=i[l];return u.ALT.call(this)}this.raiseNoAltException(r,e.ERR_MSG)},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){var e=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Bn.NotAllInputParsedException(r,e))}},t.prototype.subruleInternal=function(e,r,n){var i;try{var s=n!==void 0?n.ARGS:void 0;return i=e.call(this,r,s),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:e.ruleName),i}catch(l){this.subruleInternalError(l,n,e.ruleName)}},t.prototype.subruleInternalError=function(e,r,n){throw Bn.isRecognitionException(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete e.partialCstResult),e},t.prototype.consumeInternal=function(e,r,n){var i;try{var s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,n)}catch(l){i=this.consumeInternalRecovery(e,r,l)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:e.name,i),i},t.prototype.consumeInternalError=function(e,r,n){var i,s=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:r,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Bn.MismatchedTokenException(i,r,s))},t.prototype.consumeInternalRecovery=function(e,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){var i=this.getFollowsForInRuleRecovery(e,r);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===og.IN_RULE_RECOVERY_EXCEPTION?n:s}}else throw n},t.prototype.saveRecogState=function(){var e=this.errors,r=Re.cloneArr(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}},t.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(e,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(r,e)},t.prototype.isBackTracking=function(){return this.isBackTrackingStack.length!==0},t.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},t.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Ml.EOF)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}();Dn.RecognizerEngine=sg});var Pl=w(qn=>{"use strict";Object.defineProperty(qn,"__esModule",{value:!0});qn.ErrorHandler=void 0;var oo=Er(),ao=J(),wl=Br(),ug=ot(),cg=function(){function t(){}return t.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=ao.has(e,"errorMessageProvider")?e.errorMessageProvider:ug.DEFAULT_PARSER_CONFIG.errorMessageProvider},t.prototype.SAVE_ERROR=function(e){if(oo.isRecognitionException(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:ao.cloneArr(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return ao.cloneArr(this._errors)},set:function(e){this._errors=e},enumerable:!1,configurable:!0}),t.prototype.raiseEarlyExitException=function(e,r,n){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],l=wl.getLookaheadPathsForOptionalProd(e,s,r,this.maxLookahead),u=l[0],o=[],a=1;a<=this.maxLookahead;a++)o.push(this.LA(a));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:u,actual:o,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new oo.EarlyExitException(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(e,r){for(var n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],s=wl.getLookaheadPathsForOr(e,i,this.maxLookahead),l=[],u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));var o=this.LA(0),a=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:l,previous:o,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new oo.NoViableAltException(a,this.LA(1),o))},t}();qn.ErrorHandler=cg});var xl=w(Gn=>{"use strict";Object.defineProperty(Gn,"__esModule",{value:!0});Gn.ContentAssist=void 0;var Ul=Fr(),Ll=J(),lg=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(e,r){var n=this.gastProductionsCache[e];if(Ll.isUndefined(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Ul.nextPossibleTokensAfter([n],r,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(e){var r=Ll.first(e.ruleStack),n=this.getGAstProductions(),i=n[r],s=new Ul.NextAfterTokenWalker(i,e).startWalking();return s},t}();Gn.ContentAssist=lg});var Gl=w(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.GastRecorder=void 0;var rt=J(),Mt=$e(),fg=Ur(),kl=fr(),Sl=Wt(),hg=ot(),pg=xn(),Vn={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Vn);var bl=!0,Fl=Math.pow(2,pg.BITS_FOR_OCCURRENCE_IDX)-1,Bl=Sl.createToken({name:"RECORDING_PHASE_TOKEN",pattern:fg.Lexer.NA});kl.augmentTokenTypes([Bl]);var Dl=Sl.createTokenInstance(Bl,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Dl);var dg={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},vg=function(){function t(){}return t.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var r=function(i){var s=i>0?i:"";e["CONSUME"+s]=function(l,u){return this.consumeInternalRecord(l,i,u)},e["SUBRULE"+s]=function(l,u){return this.subruleInternalRecord(l,i,u)},e["OPTION"+s]=function(l){return this.optionInternalRecord(l,i)},e["OR"+s]=function(l){return this.orInternalRecord(l,i)},e["MANY"+s]=function(l){this.manyInternalRecord(i,l)},e["MANY_SEP"+s]=function(l){this.manySepFirstInternalRecord(i,l)},e["AT_LEAST_ONE"+s]=function(l){this.atLeastOneInternalRecord(i,l)},e["AT_LEAST_ONE_SEP"+s]=function(l){this.atLeastOneSepFirstInternalRecord(i,l)}},n=0;n<10;n++)r(n);e.consume=function(i,s,l){return this.consumeInternalRecord(s,i,l)},e.subrule=function(i,s,l){return this.subruleInternalRecord(s,i,l)},e.option=function(i,s){return this.optionInternalRecord(s,i)},e.or=function(i,s){return this.orInternalRecord(s,i)},e.many=function(i,s){this.manyInternalRecord(i,s)},e.atLeastOne=function(i,s){this.atLeastOneInternalRecord(i,s)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},t.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var r=0;r<10;r++){var n=r>0?r:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},t.prototype.ACTION_RECORD=function(e){},t.prototype.BACKTRACK_RECORD=function(e,r){return function(){return!0}},t.prototype.LA_RECORD=function(e){return hg.END_OF_FILE},t.prototype.topLevelRuleRecord=function(e,r){try{var n=new Mt.Rule({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch(s){throw i}throw i}},t.prototype.optionInternalRecord=function(e,r){return Wr.call(this,Mt.Option,e,r)},t.prototype.atLeastOneInternalRecord=function(e,r){Wr.call(this,Mt.RepetitionMandatory,r,e)},t.prototype.atLeastOneSepFirstInternalRecord=function(e,r){Wr.call(this,Mt.RepetitionMandatoryWithSeparator,r,e,bl)},t.prototype.manyInternalRecord=function(e,r){Wr.call(this,Mt.Repetition,r,e)},t.prototype.manySepFirstInternalRecord=function(e,r){Wr.call(this,Mt.RepetitionWithSeparator,r,e,bl)},t.prototype.orInternalRecord=function(e,r){return gg.call(this,e,r)},t.prototype.subruleInternalRecord=function(e,r,n){if(Wn(r),!e||rt.has(e,"ruleName")===!1){var i=new Error("<SUBRULE"+ql(r)+"> argument is invalid"+(" expecting a Parser method reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=rt.peek(this.recordingProdStack),l=e.ruleName,u=new Mt.NonTerminal({idx:r,nonTerminalName:l,referencedRule:void 0});return s.definition.push(u),this.outputCst?dg:Vn},t.prototype.consumeInternalRecord=function(e,r,n){if(Wn(r),!kl.hasShortKeyProperty(e)){var i=new Error("<CONSUME"+ql(r)+"> argument is invalid"+(" expecting a TokenType reference but got: <"+JSON.stringify(e)+">")+(`
 inside top level rule: <`+this.recordingProdStack[0].name+">"));throw i.KNOWN_RECORDER_ERROR=!0,i}var s=rt.peek(this.recordingProdStack),l=new Mt.Terminal({idx:r,terminalType:e});return s.definition.push(l),Dl},t}();Hn.GastRecorder=vg;function Wr(t,e,r,n){n===void 0&&(n=!1),Wn(r);var i=rt.peek(this.recordingProdStack),s=rt.isFunction(e)?e:e.DEF,l=new t({definition:[],idx:r});return n&&(l.separator=e.SEP),rt.has(e,"MAX_LOOKAHEAD")&&(l.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(l),s.call(this),i.definition.push(l),this.recordingProdStack.pop(),Vn}function gg(t,e){var r=this;Wn(e);var n=rt.peek(this.recordingProdStack),i=rt.isArray(t)===!1,s=i===!1?t:t.DEF,l=new Mt.Alternation({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});rt.has(t,"MAX_LOOKAHEAD")&&(l.maxLookahead=t.MAX_LOOKAHEAD);var u=rt.some(s,function(o){return rt.isFunction(o.GATE)});return l.hasPredicates=u,n.definition.push(l),rt.forEach(s,function(o){var a=new Mt.Alternative({definition:[]});l.definition.push(a),rt.has(o,"IGNORE_AMBIGUITIES")?a.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:rt.has(o,"GATE")&&(a.ignoreAmbiguities=!0),r.recordingProdStack.push(a),o.ALT.call(r),r.recordingProdStack.pop()}),Vn}function ql(t){return t===0?"":""+t}function Wn(t){if(t<0||t>Fl){var e=new Error("Invalid DSL Method idx value: <"+t+`>
	`+("Idx value must be a none negative value smaller than "+(Fl+1)));throw e.KNOWN_RECORDER_ERROR=!0,e}}});var Wl=w(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.PerformanceTracer=void 0;var Vl=J(),Eg=ot(),mg=function(){function t(){}return t.prototype.initPerformanceTracer=function(e){if(Vl.has(e,"traceInitPerf")){var r=e.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=Eg.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(e,r){if(this.traceInitPerf===!0){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--> <"+e+">");var i=Vl.timer(r),s=i.time,l=i.value,u=s>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&u(n+"<-- <"+e+"> time: "+s+"ms"),this.traceInitIndent--,l}else return r()},t}();Yn.PerformanceTracer=mg});var ot=w(pe=>{"use strict";var Hl=pe&&pe.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(pe,"__esModule",{value:!0});pe.EmbeddedActionsParser=pe.CstParser=pe.Parser=pe.EMPTY_ALT=pe.ParserDefinitionErrorType=pe.DEFAULT_RULE_CONFIG=pe.DEFAULT_PARSER_CONFIG=pe.END_OF_FILE=void 0;var Ve=J(),Rg=Uc(),Yl=Wt(),zl=Sr(),Kl=ji(),Tg=to(),Ag=ll(),Ng=Tl(),yg=Nl(),Og=Ol(),_g=Cl(),Ig=Pl(),Mg=xl(),Cg=Gl(),wg=Wl();pe.END_OF_FILE=Yl.createTokenInstance(Yl.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(pe.END_OF_FILE);pe.DEFAULT_PARSER_CONFIG=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:zl.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1});pe.DEFAULT_RULE_CONFIG=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});var Pg;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS"})(Pg=pe.ParserDefinitionErrorType||(pe.ParserDefinitionErrorType={}));function Ug(t){return t===void 0&&(t=void 0),function(){return t}}pe.EMPTY_ALT=Ug;var zn=function(){function t(e,r){this.definitionErrors=[],this.selfAnalysisDone=!1;var n=this;if(n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(e,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),Ve.has(r,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Ve.has(r,"skipValidations")?r.skipValidations:pe.DEFAULT_PARSER_CONFIG.skipValidations}return t.performSelfAnalysis=function(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",function(){var r;e.selfAnalysisDone=!0;var n=e.className;e.TRACE_INIT("toFastProps",function(){Ve.toFastProperties(e)}),e.TRACE_INIT("Grammar Recording",function(){try{e.enableRecording(),Ve.forEach(e.definedRulesNames,function(s){var l=e[s],u=l.originalGrammarAction,o=void 0;e.TRACE_INIT(s+" Rule",function(){o=e.topLevelRuleRecord(s,u)}),e.gastProductionsCache[s]=o})}finally{e.disableRecording()}});var i=[];if(e.TRACE_INIT("Grammar Resolving",function(){i=Kl.resolveGrammar({rules:Ve.values(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)}),e.TRACE_INIT("Grammar Validations",function(){if(Ve.isEmpty(i)&&e.skipValidations===!1){var s=Kl.validateGrammar({rules:Ve.values(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Ve.values(e.tokensMap),errMsgProvider:zl.defaultGrammarValidatorErrorProvider,grammarName:n});e.definitionErrors.push.apply(e.definitionErrors,s)}}),Ve.isEmpty(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",function(){var s=Rg.computeAllProdsFollows(Ve.values(e.gastProductionsCache));e.resyncFollows=s}),e.TRACE_INIT("ComputeLookaheadFunctions",function(){e.preComputeLookaheadFunctions(Ve.values(e.gastProductionsCache))})),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!Ve.isEmpty(e.definitionErrors))throw r=Ve.map(e.definitionErrors,function(s){return s.message}),new Error(`Parser Definition Errors detected:
 `+r.join(`
-------------------------------
`))})},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();pe.Parser=zn;Ve.applyMixins(zn,[Tg.Recoverable,Ag.LooksAhead,Ng.TreeBuilder,yg.LexerAdapter,_g.RecognizerEngine,Og.RecognizerApi,Ig.ErrorHandler,Mg.ContentAssist,Cg.GastRecorder,wg.PerformanceTracer]);var Lg=function(t){Hl(e,t);function e(r,n){n===void 0&&(n=pe.DEFAULT_PARSER_CONFIG);var i=this,s=Ve.cloneObj(n);return s.outputCst=!0,i=t.call(this,r,s)||this,i}return e}(zn);pe.CstParser=Lg;var xg=function(t){Hl(e,t);function e(r,n){n===void 0&&(n=pe.DEFAULT_PARSER_CONFIG);var i=this,s=Ve.cloneObj(n);return s.outputCst=!1,i=t.call(this,r,s)||this,i}return e}(zn);pe.EmbeddedActionsParser=xg});var Xl=w(Kn=>{"use strict";Object.defineProperty(Kn,"__esModule",{value:!0});Kn.createSyntaxDiagramsCode=void 0;var $l=Ii();function kg(t,e){var r=e===void 0?{}:e,n=r.resourceBase,i=n===void 0?"https://unpkg.com/chevrotain@"+$l.VERSION+"/diagrams/":n,s=r.css,l=s===void 0?"https://unpkg.com/chevrotain@"+$l.VERSION+"/diagrams/diagrams.css":s,u=`
<!-- This is a generated file -->
<!DOCTYPE html>
<meta charset="utf-8">
<style>
  body {
    background-color: hsl(30, 20%, 95%)
  }
</style>

`,o=`
<link rel='stylesheet' href='`+l+`'>
`,a=`
<script src='`+i+`vendor/railroad-diagrams.js'><\/script>
<script src='`+i+`src/diagrams_builder.js'><\/script>
<script src='`+i+`src/diagrams_behavior.js'><\/script>
<script src='`+i+`src/main.js'><\/script>
`,c=`
<div id="diagrams" align="center"></div>    
`,f=`
<script>
    window.serializedGrammar = `+JSON.stringify(t,null,"  ")+`;
<\/script>
`,p=`
<script>
    var diagramsDiv = document.getElementById("diagrams");
    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);
<\/script>
`;return u+o+a+c+f+p}Kn.createSyntaxDiagramsCode=kg});var nf=w(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.genSingleAlt=Me.genAlternation=Me.genNonTerminal=Me.genTerminal=Me.genRule=Me.genAllRules=Me.genClass=Me.genWrapperFunction=Me.genUmdModule=void 0;var so=J(),Bt=$e(),xe=`
`;function Sg(t){return`
(function (root, factory) {
    if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['chevrotain'], factory);
    } else if (typeof module === 'object' && module.exports) {
        // Node. Does not work with strict CommonJS, but
        // only CommonJS-like environments that support module.exports,
        // like Node.
        module.exports = factory(require('chevrotain'));
    } else {
        // Browser globals (root is window)
        root.returnExports = factory(root.b);
    }
}(typeof self !== 'undefined' ? self : this, function (chevrotain) {

`+uo(t)+`
    
return {
    `+t.name+": "+t.name+` 
}
}));
`}Me.genUmdModule=Sg;function bg(t){return`    
`+uo(t)+`
return new `+t.name+`(tokenVocabulary, config)    
`}Me.genWrapperFunction=bg;function uo(t){var e=`
function `+t.name+`(tokenVocabulary, config) {
    // invoke super constructor
    // No support for embedded actions currently, so we can 'hardcode'
    // The use of CstParser.
    chevrotain.CstParser.call(this, tokenVocabulary, config)

    const $ = this

    `+Ql(t.rules)+`

    // very important to call this after all the rules have been defined.
    // otherwise the parser may not work correctly as it will lack information
    // derived during the self analysis phase.
    this.performSelfAnalysis(this)
}

// inheritance as implemented in javascript in the previous decade... :(
`+t.name+`.prototype = Object.create(chevrotain.CstParser.prototype)
`+t.name+".prototype.constructor = "+t.name+`    
    `;return e}Me.genClass=uo;function Ql(t){var e=so.map(t,function(r){return Zl(r,1)});return e.join(`
`)}Me.genAllRules=Ql;function Zl(t,e){var r=Xe(e,'$.RULE("'+t.name+'", function() {')+xe;return r+=$n(t.definition,e+1),r+=Xe(e+1,"})")+xe,r}Me.genRule=Zl;function Jl(t,e){var r=t.terminalType.name;return Xe(e,"$.CONSUME"+t.idx+"(this.tokensMap."+r+")"+xe)}Me.genTerminal=Jl;function jl(t,e){return Xe(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")"+xe)}Me.genNonTerminal=jl;function ef(t,e){var r=Xe(e,"$.OR"+t.idx+"([")+xe,n=so.map(t.definition,function(i){return tf(i,e+1)});return r+=n.join(","+xe),r+=xe+Xe(e,"])"+xe),r}Me.genAlternation=ef;function tf(t,e){var r=Xe(e,"{")+xe;return r+=Xe(e+1,"ALT: function() {")+xe,r+=$n(t.definition,e+1),r+=Xe(e+1,"}")+xe,r+=Xe(e,"}"),r}Me.genSingleAlt=tf;function Fg(t,e){if(t instanceof Bt.NonTerminal)return jl(t,e);if(t instanceof Bt.Option)return Hr("OPTION",t,e);if(t instanceof Bt.RepetitionMandatory)return Hr("AT_LEAST_ONE",t,e);if(t instanceof Bt.RepetitionMandatoryWithSeparator)return Hr("AT_LEAST_ONE_SEP",t,e);if(t instanceof Bt.RepetitionWithSeparator)return Hr("MANY_SEP",t,e);if(t instanceof Bt.Repetition)return Hr("MANY",t,e);if(t instanceof Bt.Alternation)return ef(t,e);if(t instanceof Bt.Terminal)return Jl(t,e);if(t instanceof Bt.Alternative)return $n(t.definition,e);throw Error("non exhaustive match")}function Hr(t,e,r){var n=Xe(r,"$."+(t+e.idx)+"(");return e.separator?(n+="{"+xe,n+=Xe(r+1,"SEP: this.tokensMap."+e.separator.name)+","+xe,n+="DEF: "+rf(e.definition,r+2)+xe,n+=Xe(r,"}")+xe):n+=rf(e.definition,r+1),n+=Xe(r,")")+xe,n}function rf(t,e){var r="function() {"+xe;return r+=$n(t,e),r+=Xe(e,"}")+xe,r}function $n(t,e){var r="";return so.forEach(t,function(n){r+=Fg(n,e+1)}),r}function Xe(t,e){var r=Array(t*4+1).join(" ");return r+e}});var af=w(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.generateParserModule=Tr.generateParserFactory=void 0;var of=nf();function Bg(t){var e=of.genWrapperFunction({name:t.name,rules:t.rules}),r=new Function("tokenVocabulary","config","chevrotain",e);return function(n){return r(t.tokenVocabulary,n,Yr())}}Tr.generateParserFactory=Bg;function Dg(t){return of.genUmdModule({name:t.name,rules:t.rules})}Tr.generateParserModule=Dg});var Yr=w(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.Parser=P.generateParserModule=P.generateParserFactory=P.createSyntaxDiagramsCode=P.clearCache=P.validateGrammar=P.resolveGrammar=P.assignOccurrenceIndices=P.GAstVisitor=P.serializeProduction=P.serializeGrammar=P.Terminal=P.Rule=P.RepetitionWithSeparator=P.RepetitionMandatoryWithSeparator=P.RepetitionMandatory=P.Repetition=P.Option=P.NonTerminal=P.Alternative=P.Alternation=P.defaultLexerErrorProvider=P.NoViableAltException=P.NotAllInputParsedException=P.MismatchedTokenException=P.isRecognitionException=P.EarlyExitException=P.defaultParserErrorProvider=P.defaultGrammarValidatorErrorProvider=P.defaultGrammarResolverErrorProvider=P.tokenName=P.tokenMatcher=P.tokenLabel=P.EOF=P.createTokenInstance=P.createToken=P.LexerDefinitionErrorType=P.Lexer=P.EMPTY_ALT=P.ParserDefinitionErrorType=P.EmbeddedActionsParser=P.CstParser=P.VERSION=void 0;var qg=Ii();Object.defineProperty(P,"VERSION",{enumerable:!0,get:function(){return qg.VERSION}});var Xn=ot();Object.defineProperty(P,"CstParser",{enumerable:!0,get:function(){return Xn.CstParser}});Object.defineProperty(P,"EmbeddedActionsParser",{enumerable:!0,get:function(){return Xn.EmbeddedActionsParser}});Object.defineProperty(P,"ParserDefinitionErrorType",{enumerable:!0,get:function(){return Xn.ParserDefinitionErrorType}});Object.defineProperty(P,"EMPTY_ALT",{enumerable:!0,get:function(){return Xn.EMPTY_ALT}});var sf=Ur();Object.defineProperty(P,"Lexer",{enumerable:!0,get:function(){return sf.Lexer}});Object.defineProperty(P,"LexerDefinitionErrorType",{enumerable:!0,get:function(){return sf.LexerDefinitionErrorType}});var Ar=Wt();Object.defineProperty(P,"createToken",{enumerable:!0,get:function(){return Ar.createToken}});Object.defineProperty(P,"createTokenInstance",{enumerable:!0,get:function(){return Ar.createTokenInstance}});Object.defineProperty(P,"EOF",{enumerable:!0,get:function(){return Ar.EOF}});Object.defineProperty(P,"tokenLabel",{enumerable:!0,get:function(){return Ar.tokenLabel}});Object.defineProperty(P,"tokenMatcher",{enumerable:!0,get:function(){return Ar.tokenMatcher}});Object.defineProperty(P,"tokenName",{enumerable:!0,get:function(){return Ar.tokenName}});var co=Sr();Object.defineProperty(P,"defaultGrammarResolverErrorProvider",{enumerable:!0,get:function(){return co.defaultGrammarResolverErrorProvider}});Object.defineProperty(P,"defaultGrammarValidatorErrorProvider",{enumerable:!0,get:function(){return co.defaultGrammarValidatorErrorProvider}});Object.defineProperty(P,"defaultParserErrorProvider",{enumerable:!0,get:function(){return co.defaultParserErrorProvider}});var zr=Er();Object.defineProperty(P,"EarlyExitException",{enumerable:!0,get:function(){return zr.EarlyExitException}});Object.defineProperty(P,"isRecognitionException",{enumerable:!0,get:function(){return zr.isRecognitionException}});Object.defineProperty(P,"MismatchedTokenException",{enumerable:!0,get:function(){return zr.MismatchedTokenException}});Object.defineProperty(P,"NotAllInputParsedException",{enumerable:!0,get:function(){return zr.NotAllInputParsedException}});Object.defineProperty(P,"NoViableAltException",{enumerable:!0,get:function(){return zr.NoViableAltException}});var Gg=bi();Object.defineProperty(P,"defaultLexerErrorProvider",{enumerable:!0,get:function(){return Gg.defaultLexerErrorProvider}});var Ct=$e();Object.defineProperty(P,"Alternation",{enumerable:!0,get:function(){return Ct.Alternation}});Object.defineProperty(P,"Alternative",{enumerable:!0,get:function(){return Ct.Alternative}});Object.defineProperty(P,"NonTerminal",{enumerable:!0,get:function(){return Ct.NonTerminal}});Object.defineProperty(P,"Option",{enumerable:!0,get:function(){return Ct.Option}});Object.defineProperty(P,"Repetition",{enumerable:!0,get:function(){return Ct.Repetition}});Object.defineProperty(P,"RepetitionMandatory",{enumerable:!0,get:function(){return Ct.RepetitionMandatory}});Object.defineProperty(P,"RepetitionMandatoryWithSeparator",{enumerable:!0,get:function(){return Ct.RepetitionMandatoryWithSeparator}});Object.defineProperty(P,"RepetitionWithSeparator",{enumerable:!0,get:function(){return Ct.RepetitionWithSeparator}});Object.defineProperty(P,"Rule",{enumerable:!0,get:function(){return Ct.Rule}});Object.defineProperty(P,"Terminal",{enumerable:!0,get:function(){return Ct.Terminal}});var uf=$e();Object.defineProperty(P,"serializeGrammar",{enumerable:!0,get:function(){return uf.serializeGrammar}});Object.defineProperty(P,"serializeProduction",{enumerable:!0,get:function(){return uf.serializeProduction}});var Vg=hr();Object.defineProperty(P,"GAstVisitor",{enumerable:!0,get:function(){return Vg.GAstVisitor}});var lo=ji();Object.defineProperty(P,"assignOccurrenceIndices",{enumerable:!0,get:function(){return lo.assignOccurrenceIndices}});Object.defineProperty(P,"resolveGrammar",{enumerable:!0,get:function(){return lo.resolveGrammar}});Object.defineProperty(P,"validateGrammar",{enumerable:!0,get:function(){return lo.validateGrammar}});function Wg(){console.warn(`The clearCache function was 'soft' removed from the Chevrotain API.
	 It performs no action other than printing this message.
	 Please avoid using it as it will be completely removed in the future`)}P.clearCache=Wg;var Hg=Xl();Object.defineProperty(P,"createSyntaxDiagramsCode",{enumerable:!0,get:function(){return Hg.createSyntaxDiagramsCode}});var cf=af();Object.defineProperty(P,"generateParserFactory",{enumerable:!0,get:function(){return cf.generateParserFactory}});Object.defineProperty(P,"generateParserModule",{enumerable:!0,get:function(){return cf.generateParserModule}});var Yg=function(){function t(){throw new Error(`The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.	
See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0`)}return t}();P.Parser=Yg});var Qn=w((a2,df)=>{var{createToken:$,Lexer:lf}=Yr(),zg=Oe(),ff={},Kg=$({name:"WhiteSpace",pattern:/\s+/,group:lf.SKIPPED}),$g=$({name:"String",pattern:/"(""|[^"])*"/}),Xg=$({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),Qg=$({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),Zg=$({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),Jg=$({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),jg=$({name:"RefError",pattern:/#REF!/}),fo=$({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),eE=$({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),tE=$({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:fo}),rE=$({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),nE=$({name:"Boolean",pattern:/TRUE|FALSE/i}),iE=$({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:fo}),oE=$({name:"At",pattern:/@/}),aE=$({name:"Comma",pattern:/,/}),sE=$({name:"Colon",pattern:/:/}),uE=$({name:"Semicolon",pattern:/;/}),cE=$({name:"OpenParen",pattern:/\(/}),lE=$({name:"CloseParen",pattern:/\)/}),fE=$({name:"OpenSquareParen",pattern:/\[/}),hE=$({name:"CloseSquareParen",pattern:/]/}),o2=$({name:"exclamationMark",pattern:/!/}),pE=$({name:"OpenCurlyParen",pattern:/{/}),dE=$({name:"CloseCurlyParen",pattern:/}/}),vE=$({name:"QuoteS",pattern:/'/}),hf=$({name:"MulOp",pattern:/\*/}),gE=$({name:"PlusOp",pattern:/\+/}),EE=$({name:"DivOp",pattern:/\//}),mE=$({name:"MinOp",pattern:/-/}),RE=$({name:"ConcatOp",pattern:/&/}),TE=$({name:"ExOp",pattern:/\^/}),AE=$({name:"PercentOp",pattern:/%/}),NE=$({name:"GtOp",pattern:/>/}),yE=$({name:"EqOp",pattern:/=/}),OE=$({name:"LtOp",pattern:/</}),_E=$({name:"NeqOp",pattern:/<>/}),IE=$({name:"GteOp",pattern:/>=/}),ME=$({name:"LteOp",pattern:/<=/}),pf=[Kg,$g,Qg,Xg,Zg,Jg,jg,eE,tE,nE,iE,fo,rE,oE,aE,sE,uE,cE,lE,fE,hE,pE,dE,vE,hf,gE,EE,mE,RE,TE,hf,AE,_E,IE,ME,NE,yE,OE],CE=new lf(pf,{ensureOptimizations:!0});pf.forEach(t=>{ff[t.name]=t});df.exports={tokenVocabulary:ff,lex:function(t){let e=CE.tokenize(t);if(e.errors.length>0){let r=e.errors[0],n=r.line,i=r.column,s=`
`+t.split(`
`)[n-1]+`
`;throw s+=Array(i-1).fill(" ").join("")+`^
`,r.message=s+`Error at position ${n}:${i}
`+r.message,r.errorLocation={line:n,column:i},zg.ERROR(r.message,r)}return e}}});var vo=w((c2,yf)=>{var vf=Qn(),{EmbeddedActionsParser:wE}=Yr(),PE=vf.tokenVocabulary,{String:gf,SheetQuoted:UE,ExcelRefFunction:s2,ExcelConditionalRefFunction:u2,Function:LE,FormulaErrorT:Ef,RefError:mf,Cell:xE,Sheet:kE,Name:SE,Number:Rf,Boolean:Tf,Column:bE,Comma:Zn,Colon:FE,Semicolon:BE,OpenParen:DE,CloseParen:Af,OpenCurlyParen:qE,CloseCurlyParen:GE,MulOp:VE,PlusOp:ho,DivOp:WE,MinOp:po,ConcatOp:HE,ExOp:YE,PercentOp:zE,NeqOp:KE,GteOp:$E,LteOp:XE,GtOp:QE,EqOp:ZE,LtOp:JE}=vf.tokenVocabulary,Nf=class extends wE{constructor(e,r){super(PE,{outputCst:!1,maxLookahead:1,skipValidations:!0});this.utils=r,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];let n=this;n.RULE("formulaWithBinaryOp",()=>{let i=[],s=[n.SUBRULE(n.formulaWithPercentOp)];return n.MANY(()=>{i.push(n.OR(n.c1||(n.c1=[{ALT:()=>n.CONSUME(QE).image},{ALT:()=>n.CONSUME(ZE).image},{ALT:()=>n.CONSUME(JE).image},{ALT:()=>n.CONSUME(KE).image},{ALT:()=>n.CONSUME($E).image},{ALT:()=>n.CONSUME(XE).image},{ALT:()=>n.CONSUME(HE).image},{ALT:()=>n.CONSUME(ho).image},{ALT:()=>n.CONSUME(po).image},{ALT:()=>n.CONSUME(VE).image},{ALT:()=>n.CONSUME(WE).image},{ALT:()=>n.CONSUME(YE).image}]))),s.push(n.SUBRULE2(n.formulaWithPercentOp))}),n.ACTION(()=>{for(let l of this.binaryOperatorsPrecedence)for(let u=0,o=i.length;u<o;u++){let a=i[u];!l.includes(a)||(i.splice(u,1),s.splice(u,2,this.utils.applyInfix(s[u],a,s[u+1])),u--,o--)}}),s[0]}),n.RULE("plusMinusOp",()=>n.OR([{ALT:()=>n.CONSUME(ho).image},{ALT:()=>n.CONSUME(po).image}])),n.RULE("formulaWithPercentOp",()=>{let i=n.SUBRULE(n.formulaWithUnaryOp);return n.OPTION(()=>{let s=n.CONSUME(zE).image;i=n.ACTION(()=>this.utils.applyPostfix(i,s))}),i}),n.RULE("formulaWithUnaryOp",()=>{let i=[];n.MANY(()=>{let l=n.OR([{ALT:()=>n.CONSUME(ho).image},{ALT:()=>n.CONSUME(po).image}]);i.push(l)});let s=n.SUBRULE(n.formulaWithIntersect);return i.length>0?n.ACTION(()=>this.utils.applyPrefix(i,s)):s}),n.RULE("formulaWithIntersect",()=>{let i=n.SUBRULE(n.formulaWithRange),s=[i];return n.MANY({GATE:()=>{let l=n.LA(0);return n.LA(1).startOffset>l.endOffset+1},DEF:()=>{s.push(n.SUBRULE3(n.formulaWithRange))}}),s.length>1?n.ACTION(()=>n.ACTION(()=>this.utils.applyIntersect(s))):i}),n.RULE("formulaWithRange",()=>{let i=n.SUBRULE(n.formula),s=[i];return n.MANY(()=>{n.CONSUME(FE),s.push(n.SUBRULE2(n.formula))}),s.length>1?n.ACTION(()=>n.ACTION(()=>this.utils.applyRange(s))):i}),n.RULE("formula",()=>n.OR9([{ALT:()=>n.SUBRULE(n.referenceWithoutInfix)},{ALT:()=>n.SUBRULE(n.paren)},{ALT:()=>n.SUBRULE(n.constant)},{ALT:()=>n.SUBRULE(n.functionCall)},{ALT:()=>n.SUBRULE(n.constantArray)}])),n.RULE("paren",()=>{n.CONSUME(DE);let i,s=[];return s.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY(()=>{n.CONSUME(Zn),s.push(n.SUBRULE2(n.formulaWithBinaryOp))}),s.length>1?i=n.ACTION(()=>this.utils.applyUnion(s)):i=s[0],n.CONSUME(Af),i}),n.RULE("constantArray",()=>{let i=[[]],s=0;return n.CONSUME(qE),i[s].push(n.SUBRULE(n.constantForArray)),n.MANY(()=>{let l=n.OR([{ALT:()=>n.CONSUME(Zn).image},{ALT:()=>n.CONSUME(BE).image}]),u=n.SUBRULE2(n.constantForArray);l===","||(s++,i[s]=[]),i[s].push(u)}),n.CONSUME(GE),n.ACTION(()=>this.utils.toArray(i))}),n.RULE("constantForArray",()=>n.OR([{ALT:()=>{let i=n.OPTION(()=>n.SUBRULE(n.plusMinusOp)),s=n.CONSUME(Rf).image,l=n.ACTION(()=>this.utils.toNumber(s));return i?n.ACTION(()=>this.utils.applyPrefix([i],l)):l}},{ALT:()=>{let i=n.CONSUME(gf).image;return n.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{let i=n.CONSUME(Tf).image;return n.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{let i=n.CONSUME(Ef).image;return n.ACTION(()=>this.utils.toError(i))}},{ALT:()=>{let i=n.CONSUME(mf).image;return n.ACTION(()=>this.utils.toError(i))}}])),n.RULE("constant",()=>n.OR([{ALT:()=>{let i=n.CONSUME(Rf).image;return n.ACTION(()=>this.utils.toNumber(i))}},{ALT:()=>{let i=n.CONSUME(gf).image;return n.ACTION(()=>this.utils.toString(i))}},{ALT:()=>{let i=n.CONSUME(Tf).image;return n.ACTION(()=>this.utils.toBoolean(i))}},{ALT:()=>{let i=n.CONSUME(Ef).image;return n.ACTION(()=>this.utils.toError(i))}}])),n.RULE("functionCall",()=>{let i=n.CONSUME(LE).image.slice(0,-1),s=n.SUBRULE(n.arguments);return n.CONSUME(Af),n.ACTION(()=>e.callFunction(i,s))}),n.RULE("arguments",()=>{n.MANY2(()=>{n.CONSUME2(Zn)});let i=[];return n.OPTION(()=>{i.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY(()=>{n.CONSUME1(Zn),i.push(null),n.OPTION3(()=>{i.pop(),i.push(n.SUBRULE2(n.formulaWithBinaryOp))})})}),i}),n.RULE("referenceWithoutInfix",()=>n.OR([{ALT:()=>n.SUBRULE(n.referenceItem)},{ALT:()=>{let i=n.SUBRULE(n.prefixName),s=n.SUBRULE2(n.formulaWithRange);return n.ACTION(()=>{if(this.utils.isFormulaError(s))return s;s.ref.sheet=i}),s}}])),n.RULE("referenceItem",()=>n.OR([{ALT:()=>{let i=n.CONSUME(xE).image;return n.ACTION(()=>this.utils.parseCellAddress(i))}},{ALT:()=>{let i=n.CONSUME(SE).image;return n.ACTION(()=>e.getVariable(i))}},{ALT:()=>{let i=n.CONSUME(bE).image;return n.ACTION(()=>this.utils.parseCol(i))}},{ALT:()=>{let i=n.CONSUME(mf).image;return n.ACTION(()=>this.utils.toError(i))}}])),n.RULE("prefixName",()=>n.OR([{ALT:()=>n.CONSUME(kE).image.slice(0,-1)},{ALT:()=>n.CONSUME(UE).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}};yf.exports={Parser:Nf}});var mo=w((l2,Mf)=>{var Kr=Oe(),{Address:jE}=Ce(),{Prefix:em,Postfix:tm,Infix:go,Operators:Eo}=Pr(),rm=Ir(),Of=1048576,_f=16384,{NotAllInputParsedException:nm}=Yr(),If=class{constructor(e){this.context=e}columnNameToNumber(e){return jE.columnNameToNumber(e)}parseCellAddress(e){let r=e.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:r[0],col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseRow(e){let r=+e;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+e}}}parseCol(e){return{ref:{col:this.columnNameToNumber(e),row:void 0}}}parseColRange(e,r){return e=this.columnNameToNumber(e),r=this.columnNameToNumber(r),{ref:{from:{col:Math.min(e,r),row:null},to:{col:Math.max(e,r),row:null}}}}parseRowRange(e,r){return{ref:{from:{col:null,row:Math.min(e,r)},to:{col:null,row:Math.max(e,r)}}}}_applyPrefix(e,r,n){return this.isFormulaError(r)?r:em.unaryOp(e,r,n)}async applyPrefixAsync(e,r){let{val:n,isArray:i}=this.extractRefValue(await r);return this._applyPrefix(e,n,i)}applyPrefix(e,r){if(this.context.async)return this.applyPrefixAsync(e,r);{let{val:n,isArray:i}=this.extractRefValue(r);return this._applyPrefix(e,n,i)}}_applyPostfix(e,r,n){return this.isFormulaError(e)?e:tm.percentOp(e,n,r)}async applyPostfixAsync(e,r){let{val:n,isArray:i}=this.extractRefValue(await e);return this._applyPostfix(n,i,r)}applyPostfix(e,r){if(this.context.async)return this.applyPostfixAsync(e,r);{let{val:n,isArray:i}=this.extractRefValue(e);return this._applyPostfix(n,i,r)}}_applyInfix(e,r,n){let i=e.val,s=e.isArray,l=n.val,u=n.isArray;if(this.isFormulaError(i))return i;if(this.isFormulaError(l))return l;if(Eo.compareOp.includes(r))return go.compareOp(i,r,l,s,u);if(Eo.concatOp.includes(r))return go.concatOp(i,r,l,s,u);if(Eo.mathOp.includes(r))return go.mathOp(i,r,l,s,u);throw new Error(`Unrecognized infix: ${r}`)}async applyInfixAsync(e,r,n){let i=this.extractRefValue(await e),s=this.extractRefValue(await n);return this._applyInfix(i,r,s)}applyInfix(e,r,n){if(this.context.async)return this.applyInfixAsync(e,r,n);{let i=this.extractRefValue(e),s=this.extractRefValue(n);return this._applyInfix(i,r,s)}}applyIntersect(e){if(this.isFormulaError(e[0]))return e[0];if(!e[0].ref)throw Error(`Expecting a reference, but got ${e[0]}.`);let r,n,i,s,l,u,o=e.shift().ref;if(l=o.sheet,o.from)r=Math.max(o.from.row,o.to.row),i=Math.min(o.from.row,o.to.row),n=Math.max(o.from.col,o.to.col),s=Math.min(o.from.col,o.to.col);else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");r=i=o.row,n=s=o.col}let a;return e.forEach(c=>{if(this.isFormulaError(c))return c;if(c=c.ref,!c)throw Error(`Expecting a reference, but got ${c}.`);if(c.from){let f=Math.max(c.from.row,c.to.row),p=Math.min(c.from.row,c.to.row),d=Math.max(c.from.col,c.to.col),h=Math.min(c.from.col,c.to.col);(p>r||f<i||h>n||d<s||l!==c.sheet)&&(a=Kr.NULL),r=Math.min(r,f),i=Math.max(i,p),n=Math.min(n,d),s=Math.max(s,h)}else{if(c.row===void 0||c.col===void 0)throw Error("Cannot intersect the whole row or column.");(c.row>r||c.row<i||c.col>n||c.col<s||l!==c.sheet)&&(a=Kr.NULL),r=i=c.row,n=s=c.col}}),a||(r===i&&n===s?u={ref:{sheet:l,row:r,col:n}}:u={ref:{sheet:l,from:{row:i,col:s},to:{row:r,col:n}}},u.ref.sheet||delete u.ref.sheet,u)}applyUnion(e){let r=new rm;for(let n=0;n<e.length;n++){if(this.isFormulaError(e[n]))return e[n];r.add(this.extractRefValue(e[n]).val,e[n])}return r}applyRange(e){let r,n=-1,i=-1,s=Of+1,l=_f+1;return e.forEach(u=>{if(this.isFormulaError(u))return u;typeof u=="number"&&(u=this.parseRow(u)),u=u.ref,u.row===void 0&&(s=1,n=Of),u.col===void 0&&(l=1,i=_f),u.row>n&&(n=u.row),u.row<s&&(s=u.row),u.col>i&&(i=u.col),u.col<l&&(l=u.col)}),n===s&&i===l?r={ref:{row:n,col:i}}:r={ref:{from:{row:s,col:l},to:{row:n,col:i}}},r}extractRefValue(e){let r=e,n=!1;return Array.isArray(r)&&(n=!0),e.ref?{val:this.context.retrieveRef(e),isArray:n}:{val:r,isArray:n}}toArray(e){return e}toNumber(e){return Number(e)}toString(e){return e.substring(1,e.length-1).replace(/""/g,'"')}toBoolean(e){return e==="TRUE"}toError(e){return new Kr(e.toUpperCase())}isFormulaError(e){return e instanceof Kr}static formatChevrotainError(e,r){let n,i,s="";return e instanceof nm?(n=e.token.startLine,i=e.token.startColumn):(n=e.previousToken.startLine,i=e.previousToken.startColumn+1),s+=`
`+r.split(`
`)[n-1]+`
`,s+=Array(i-1).fill(" ").join("")+`^
`,s+=`Error at position ${n}:${i}
`+e.message,e.errorLocation={line:n,column:i},Kr.ERROR(s,e)}};Mf.exports=If});var Df=w((f2,Bf)=>{var im=di(),Cf=Ei(),wf=Qs(),Pf=Js(),Uf=iu(),Lf=su(),xf=cu(),kf=gu(),Sf=Tu(),om=_u(),st=Oe(),{FormulaHelpers:tr}=Ce(),{Parser:am,allTokens:sm}=vo(),bf=Qn(),Ro=mo(),Ff=class{constructor(e,r=!1){this.logs=[],this.isTest=r,this.utils=new Ro(this),e=Object.assign({functions:{},functionsNeedContext:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},e),this.onVariable=e.onVariable,this.functions=Object.assign({},Sf,kf,xf,Lf,Uf,Pf,im,Cf,wf,om,e.functions,e.functionsNeedContext),this.onRange=e.onRange,this.onCell=e.onCell,this.funsNullAs0=Object.keys(Cf).concat(Object.keys(wf)).concat(Object.keys(Pf)).concat(Object.keys(Uf)).concat(Object.keys(Lf)).concat(Object.keys(kf)).concat(Object.keys(Sf)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF","IF"],this.funsNeedContext=[...Object.keys(e.functionsNeedContext),...this.funsNeedContextAndNoDataRetrieve,"INDEX","OFFSET","INDIRECT","IF","CHOOSE","WEBSERVICE"],this.funsPreserveRef=Object.keys(xf),this.parser=new am(this,this.utils)}static get allTokens(){return sm}getCell(e){return e.sheet==null&&(e.sheet=this.position?this.position.sheet:void 0),this.onCell(e)}getRange(e){return e.sheet==null&&(e.sheet=this.position?this.position.sheet:void 0),this.onRange(e)}getVariable(e){let r={ref:this.onVariable(e,this.position.sheet,this.position)};return r.ref==null?st.NAME:r}retrieveRef(e){return tr.isRangeRef(e)?this.getRange(e.ref):tr.isCellRef(e)?this.getCell(e.ref):e}_callFunction(e,r){e.indexOf("_xlfn.")===0&&(e=e.slice(6)),e=e.toUpperCase();let n=this.funsNullAs0.includes(e)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(e)||(r=r.map(i=>{if(i===null)return{value:n,isArray:!1,omitted:!0};let s=this.utils.extractRefValue(i);return this.funsPreserveRef.includes(e)?{value:s.val,isArray:s.isArray,ref:i.ref}:{value:s.val,isArray:s.isArray,isRangeRef:!!tr.isRangeRef(i),isCellRef:!!tr.isCellRef(i)}})),this.functions[e]){let i;try{!this.funsNeedContextAndNoDataRetrieve.includes(e)&&!this.funsNeedContext.includes(e)?i=this.functions[e](...r):i=this.functions[e](this,...r)}catch(s){if(s instanceof st)return s;throw s}if(i===void 0){if(this.isTest)return this.logs.includes(e)||this.logs.push(e),{value:0,ref:{}};throw st.NOT_IMPLEMENTED(e)}return i}else{if(this.isTest)return this.logs.includes(e)||this.logs.push(e),{value:0,ref:{}};throw st.NOT_IMPLEMENTED(e)}}async callFunctionAsync(e,r){let n=[];for(let s of r)n.push(await s);let i=await this._callFunction(e,n);return tr.checkFunctionResult(i)}callFunction(e,r){if(this.async)return this.callFunctionAsync(e,r);{let n=this._callFunction(e,r);return tr.checkFunctionResult(n)}}supportedFunctions(){let e=[];return Object.keys(this.functions).forEach(n=>{try{if(this.functions[n](0,0,0,0,0,0,0,0,0,0,0)===void 0)return;e.push(n)}catch(i){i instanceof Error&&e.push(n)}}),e.sort()}checkFormulaResult(e,r=!1){let n=typeof e;if(n==="number"){if(isNaN(e))return st.VALUE;if(!isFinite(e))return st.NUM;e+=0}else if(n==="object"){if(e instanceof st)return e;if(r){if(e.ref&&(e=this.retrieveRef(e)),typeof e=="object"&&!Array.isArray(e)&&e!=null)return st.VALUE}else if(e.ref&&e.ref.row&&!e.ref.from)e=this.retrieveRef(e);else if(e.ref&&e.ref.from&&e.ref.from.col===e.ref.to.col)e=this.retrieveRef({ref:{row:e.ref.from.row,col:e.ref.from.col}});else if(Array.isArray(e))e=e[0][0];else return st.VALUE}return e}parse(e,r,n=!1){if(e.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!1;let i=bf.lex(e);this.parser.input=i.tokens;let s;try{if(s=this.parser.formulaWithBinaryOp(),s=this.checkFormulaResult(s,n),s instanceof st)return s}catch(l){throw st.ERROR(l.message,l)}if(this.parser.errors.length>0){let l=this.parser.errors[0];throw Ro.formatChevrotainError(l,e)}return s}async parseAsync(e,r,n=!1){if(e.length===0)throw Error("Input must not be empty.");this.position=r,this.async=!0;let i=bf.lex(e);this.parser.input=i.tokens;let s;try{if(s=await this.parser.formulaWithBinaryOp(),s=this.checkFormulaResult(s,n),s instanceof st)return s}catch(l){throw st.ERROR(l.message,l)}if(this.parser.errors.length>0){let l=this.parser.errors[0];throw Ro.formatChevrotainError(l,e)}return s}};Bf.exports={FormulaParser:Ff,FormulaHelpers:tr}});var Hf=w((m2,Wf)=>{var Jn=Oe(),{FormulaHelpers:h2,Types:p2,Address:um}=Ce(),{Prefix:d2,Postfix:v2,Infix:g2,Operators:E2}=Pr(),cm=Ir(),qf=1048576,Gf=16384,Vf=class{constructor(e){this.context=e}columnNameToNumber(e){return um.columnNameToNumber(e)}parseCellAddress(e){let r=e.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{col:this.columnNameToNumber(r[2]),row:+r[4]}}}parseRow(e){let r=+e;if(!Number.isInteger(r))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+e}}}parseCol(e){return{ref:{col:this.columnNameToNumber(e),row:void 0}}}applyPrefix(e,r){return this.extractRefValue(r),0}applyPostfix(e,r){return this.extractRefValue(e),0}applyInfix(e,r,n){return this.extractRefValue(e),this.extractRefValue(n),0}applyIntersect(e){if(this.isFormulaError(e[0]))return e[0];if(!e[0].ref)throw Error(`Expecting a reference, but got ${e[0]}.`);let r,n,i,s,l,u,o=e.shift().ref;if(l=o.sheet,o.from)r=Math.max(o.from.row,o.to.row),i=Math.min(o.from.row,o.to.row),n=Math.max(o.from.col,o.to.col),s=Math.min(o.from.col,o.to.col);else{if(o.row===void 0||o.col===void 0)throw Error("Cannot intersect the whole row or column.");r=i=o.row,n=s=o.col}let a;return e.forEach(c=>{if(this.isFormulaError(c))return c;if(c=c.ref,!c)throw Error(`Expecting a reference, but got ${c}.`);if(c.from){let f=Math.max(c.from.row,c.to.row),p=Math.min(c.from.row,c.to.row),d=Math.max(c.from.col,c.to.col),h=Math.min(c.from.col,c.to.col);(p>r||f<i||h>n||d<s||l!==c.sheet)&&(a=Jn.NULL),r=Math.min(r,f),i=Math.max(i,p),n=Math.min(n,d),s=Math.max(s,h)}else{if(c.row===void 0||c.col===void 0)throw Error("Cannot intersect the whole row or column.");(c.row>r||c.row<i||c.col>n||c.col<s||l!==c.sheet)&&(a=Jn.NULL),r=i=c.row,n=s=c.col}}),a||(r===i&&n===s?u={ref:{sheet:l,row:r,col:n}}:u={ref:{sheet:l,from:{row:i,col:s},to:{row:r,col:n}}},u.ref.sheet||delete u.ref.sheet,u)}applyUnion(e){let r=new cm;for(let n=0;n<e.length;n++){if(this.isFormulaError(e[n]))return e[n];r.add(this.extractRefValue(e[n]).val,e[n])}return r}applyRange(e){let r,n=-1,i=-1,s=qf+1,l=Gf+1;return e.forEach(u=>{if(this.isFormulaError(u))return u;typeof u=="number"&&(u=this.parseRow(u)),u=u.ref,u.row===void 0&&(s=1,n=qf),u.col===void 0&&(l=1,i=Gf),u.row>n&&(n=u.row),u.row<s&&(s=u.row),u.col>i&&(i=u.col),u.col<l&&(l=u.col)}),n===s&&i===l?r={ref:{row:n,col:i}}:r={ref:{from:{row:s,col:l},to:{row:n,col:i}}},r}extractRefValue(e){let r=Array.isArray(e);return e.ref?{val:this.context.retrieveRef(e),isArray:r}:{val:e,isArray:r}}toArray(e){return e}toNumber(e){return Number(e)}toString(e){return e.substring(1,e.length-1).replace(/""/g,'"')}toBoolean(e){return e==="TRUE"}toError(e){return new Jn(e.toUpperCase())}isFormulaError(e){return e instanceof Jn}};Wf.exports=Vf});var Xf=w((R2,$f)=>{var Yf=Oe(),{FormulaHelpers:To}=Ce(),{Parser:lm}=vo(),fm=Qn(),zf=Hf(),{formatChevrotainError:hm}=mo(),Kf=class{constructor(e){this.data=[],this.utils=new zf(this),e=Object.assign({onVariable:()=>null},e),this.utils=new zf(this),this.onVariable=e.onVariable,this.functions={},this.parser=new lm(this,this.utils)}getCell(e){return e.row!=null&&(e.sheet==null&&(e.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row<=e.row&&n.to.row>=e.row&&n.from.col<=e.col&&n.to.col>=e.col||n.row===e.row&&n.col===e.col&&n.sheet===e.sheet)===-1&&this.data.push(e)),0}getRange(e){return e.from.row!=null&&(e.sheet==null&&(e.sheet=this.position?this.position.sheet:void 0),this.data.findIndex(n=>n.from&&n.from.row===e.from.row&&n.from.col===e.from.col&&n.to.row===e.to.row&&n.to.col===e.to.col)===-1&&this.data.push(e)),[[0]]}getVariable(e){let r={ref:this.onVariable(e,this.position.sheet)};return r.ref==null?Yf.NAME:(To.isCellRef(r)?this.getCell(r.ref):this.getRange(r.ref),0)}retrieveRef(e){return To.isRangeRef(e)?this.getRange(e.ref):To.isCellRef(e)?this.getCell(e.ref):e}callFunction(e,r){return r.forEach(n=>{n!=null&&this.retrieveRef(n)}),{value:0,ref:{}}}checkFormulaResult(e){this.retrieveRef(e)}parse(e,r,n=!1){if(e.length===0)throw Error("Input must not be empty.");this.data=[],this.position=r;let i=fm.lex(e);this.parser.input=i.tokens;try{let s=this.parser.formulaWithBinaryOp();this.checkFormulaResult(s)}catch(s){if(!n)throw Yf.ERROR(s.message,s)}if(this.parser.errors.length>0&&!n){let s=this.parser.errors[0];throw hm(s,e)}return this.data}};$f.exports={DepParser:Kf}});var Jf=w((T2,Zf)=>{var{FormulaParser:Qf}=Df(),{DepParser:pm}=Xf(),dm=hi(),vm=Oe();Object.assign(Qf,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:dm,DepParser:pm,FormulaError:vm,...Ce()});Zf.exports=Qf});var Dp=wo(cs());var Mp=`
        <svg
          width="48"
          height="48"
          viewBox="0 0 26 27"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M0 14.85L14.3 0V7.29C14.3 11.4653 11.0406 14.85 7.02 14.85H0Z"
            fill="currentColor"
          />
          <path
            d="M11.7 19.71C11.7 15.5347 14.9594 12.15 18.98 12.15H26L11.7 27V19.71Z"
            fill="currentColor"
          />
        </svg>
    `,Cp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
</svg>
    `,wp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48"
          height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
</svg>
`,ls=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z" />
</svg>
`,Pp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
</svg>
`,Up=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
`,Lp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
`,xp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
</svg>
`,kp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z" />
</svg>
`,Sp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
</svg>
`,bp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
</svg>
`,Fp=`
<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14" />
</svg>
`,Bp={Glide:Mp,"Machine Learning":bp,General:ls,Array:Pp,Number:wp,Encoding:Fp,Text:Sp,"Data & APIs":kp,Image:Up,Fun:Lp,"Date & Time":xp,Code:Cp};function fs({icon:t,category:e}){var r;return(r=t!=null?t:Bp[e])!=null?r:ls}function hs(t){return Co(oi({},t),{json:JSON.stringify(qp(t),null,2)})}function qp(t){let{name:e,category:r,released:n,description:i,author:s,result:l,params:u,about:o,video:a}=t,c=fs(t);return{name:e,category:r,released:n,description:i,author:s,result:l,about:o,icon:c,video:a,params:Object.entries(u).map(([f,p])=>oi({name:f},p))}}var jf=wo(Jf());function e0(t){try{if(typeof t=="string"){let e=JSON.parse(t);if(typeof e=="number")return e}return t}catch(e){return t}}var gm=(t,...e)=>{let r=e.map(s=>[s.value]),n=new jf.default({onCell:({_:s,row:l,col:u})=>e0(r[l-1][u-1]),onRange:s=>{let l=[];for(let u=s.from.row;u<=s.to.row;u++){let o=[];if(r[u-1])for(let a=s.from.col;a<=s.to.col;a++)o.push(e0(r[u-1][a-1]));l.push(o)}return l}});if((t==null?void 0:t.value)===void 0)return;let i={row:1,col:1,sheet:0};try{return n.parse(t.value,i)}catch(s){}},N2=hs({name:"Excel Formula",category:"Code",released:"direct",description:"Run Excel formulas",about:"Uses [lesterlyu.github.io/fast-formula-parser](lesterlyu.github.io/fast-formula-parser) to evaluate Excel formulas.",author:"Chris Ozgo <chris.ozgo@heyglide.com>",params:{formula:{displayName:"Formula",type:"string"},A1:{displayName:"A1",type:"primitive"},A2:{displayName:"A2",type:"primitive"},A3:{displayName:"A3",type:"primitive"},A4:{displayName:"A4",type:"primitive"},A5:{displayName:"A5",type:"primitive"}},result:{type:"primitive"},example:{formula:"SUM(A1, A2)",A1:1,A2:2},run:gm,icon:`<svg width="41" height="44" viewBox="0 0 41 44" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M30.802 1.61791C32.2704 0.484412 34.0962 -0.0858159 35.9487 0.0104718H40.6196L38.3202 4.0615H35.9127C35.2336 4.01682 34.5631 4.23344 34.0385 4.66699C33.518 5.22337 33.1787 5.92466 33.0654 6.67808L26.4122 37.7528C26.067 39.5449 25.1304 41.1693 23.7524 42.366C22.2845 43.5066 20.4547 44.0799 18.5985 43.9807H15.5089L15.5078 43.9861H10.4044L14.849 21.527C14.9408 21.1299 14.9868 20.7236 14.9859 20.316C15.0128 19.9308 14.9594 19.5442 14.8292 19.1806C14.6989 18.817 14.4945 18.4845 14.229 18.204C13.5913 17.6788 12.7751 17.4205 11.9512 17.4832C10.7477 17.4322 9.56904 17.8362 8.64988 18.6149C7.69907 19.5239 7.07776 20.7234 6.88386 22.0244L5.13947 31.0059H0L4.87276 6.57716H10.0122L8.36155 14.9099C9.90333 13.6526 11.8438 12.9879 13.8326 13.0357C15.5452 12.9446 17.2282 13.509 18.5396 14.6143C19.135 15.1912 19.5991 15.8897 19.9001 16.6622C20.2011 17.4347 20.3321 18.263 20.284 19.0906C20.2821 19.8008 20.2048 20.5088 20.0533 21.2027L16.3186 39.9224H18.6417C18.9779 39.9484 19.316 39.9076 19.6364 39.8024C19.9567 39.6973 20.2532 39.5298 20.5087 39.3097C21.0365 38.7613 21.3772 38.0598 21.4818 37.3059L28.135 6.23117C28.4858 4.43947 29.4244 2.81601 30.802 1.61791Z" fill="currentColor"/>
        </svg>`,tests:[{params:{formula:"A1 + A2",A1:1,A2:2},expectedResult:3},{params:{formula:"SUM(A1:A3)",A1:1,A2:2,A3:3},expectedResult:6},{params:{formula:"AVERAGE(1, A1)",A1:3},expectedResult:2},{params:{formula:"SUM(A1, A2)",A1:4,A2:"4"},expectedResult:8},{params:{formula:"SUM(A1, A2, 5)",A1:"5",A2:"10"},expectedResult:20}]});export{N2 as default};
//# sourceMappingURL=function.js.map
